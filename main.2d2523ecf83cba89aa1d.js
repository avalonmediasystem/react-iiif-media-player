!function(e){function t(t){for(var r,o,s=t[0],u=t[1],c=t[2],f=0,p=[];f<s.length;f++)o=s[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var u=n[s];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;i.push([86,1]),n()}({10:function(e,t,n){"use strict";var r=n(2),a=n(20);function i(e){var t=function(){var e=a.b.getState().externalConfig.fetch,t={};e&&e.options&&Object.assign(t,e.options);return t}();return fetch(e,t).then(function(e){if(e.ok)return e.json();throw new Error("Network request was not ok")}).then(function(e){return e}).catch(function(e){return console.log("Problem with the fetch operation",e),{error:"Network failure fetching the manifest"}})}function o(e){return{type:r.c,payload:e}}function s(e){return{type:r.d,payload:e}}function u(e){return{type:r.e,payload:e}}function c(e){return{type:r.f,payload:e}}function l(e){return function(t){return t(function(e){return{type:r.b,payload:e}}(e)),i(e).then(function(e){return e.error?t((n=e.error,{type:r.a,payload:n})):t(o(e));var n})}}n.d(t,"a",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return l})},2:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return u});var r="MEJS_PLAYER_INITIALIZED",a="NAV_ITEM_CLICK",i="FETCH_MANIFEST_REQUEST",o="FETCH_MANIFEST_SUCCESS",s="FETCH_MANIFEST_FAILURE",u="UPDATE_EXTERNAL_CONFIG"},20:function(e,t,n){"use strict";var r=n(0),a=n.n(r),i=n(6),o=n(12),s=n(44),u=n(2),c={error:!1,loading:!1},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.b:return Object.assign({},e,{error:!1,loading:!0,manifest:null,url:t.payload});case u.c:return Object.assign({},e,{error:!1,loading:!1,manifest:t.payload});case u.a:return Object.assign({},e,{error:t.payload,loading:!1,manifest:null,url:null});default:return e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.e:return Object.assign({},e,{clickedUrl:t.payload});default:return e}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.d:return t.payload;default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.f:return Object.assign({},e,t.payload);default:return e}},h=Object(o.c)({externalConfig:d,getManifest:l,nav:f,player:p}),m=n(4),y=n.n(m),v=n(5),g=n.n(v),b=n(7),E=n.n(b),j=n(8),O=n.n(j),k=n(9),w=n.n(k),S=n(25),C=n.n(S),M=n(45),T=n.n(M),I=n(46),_=n(1),N=n.n(_),P=function(e){return a.a.createElement("p",null,"ERROR: ",e.message)};P.propTypes={message:N.a.string.isRequired};var R=P,U=n(16),A=n.n(U),x=function(e){function t(){var e,n;y()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return n=E()(this,(e=O()(t)).call.apply(e,[this].concat(a))),T()(C()(n),"state",{manifestUrl:n.props.manifestUrl,manifest:n.props.manifest,ready:!1,sources:[],error:null}),n}return w()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.state.manifest,t=[];try{t=A.a.create(e).getSequences()[0].getCanvases()[0].getContent()[0].getBody()}catch(e){}this.prepSources(e,t)}},{key:"getSources",value:function(e){return e.map(function(e){return{src:e.id,type:"audio/mp4"}})}},{key:"prepSources",value:function(e,t){if(0!==t.length){var n=this.getSources(t);this.setState({ready:!0,sources:n})}else this.setState({error:"No media choice items found in manifest"})}},{key:"render",value:function(){var e=this.state,t=e.manifest,n=e.ready,r=e.sources,i=e.error;return n?a.a.createElement(I.a,{id:"avln-mediaelement-component",mediaType:"video",preload:"auto",controls:!0,width:t.width||480,height:t.height||360,poster:"",crossorigin:"anonymous",sources:JSON.stringify(r),options:JSON.stringify({})}):i?a.a.createElement(R,{message:i}):null}}]),t}(r.Component);x.propTypes={manifest:N.a.object};var L=x,F=n(24),D=n.n(F),J=function(){return X.getState().getManifest.manifest};var q=n(10),B=function(e){var t,n=e.item,r=function(e){var t=[];try{t=A.a.create(J()).getRangeById(e).getCanvasIds()}catch(e){console.log("error fetching range canvases",e)}return t}(n.id),i=n.items&&n.items.length>0&&0===r.length?a.a.createElement(G,{items:n.items}):null,o=function(t){t.stopPropagation(),t.preventDefault(),e.navItemClick(t.target.href)};return a.a.createElement("li",{"data-testid":"list-item"},(t=function(e){if(e&&"object"===D()(e)){if(e.hasOwnProperty("en"))return e.en.length>0?e.en[0]:"";if(e.hasOwnProperty("none"))return e.none.length>0?e.none[0]:""}else if("string"==typeof e)return e;return"Label could not be parsed"}(n.label),r.length>0?r.map(function(e){return a.a.createElement("a",{key:e,href:e,onClick:o},t)}):t),i)};B.propTypes={item:N.a.object.isRequired};var H=Object(i.b)(null,function(e){return{navItemClick:function(t){return e(q.c(t))}}})(B),z=function(e){return a.a.createElement("ul",{"data-testid":"list"},e.items.map(function(e){var t=function(e){var t=A.a.create(J()).getRangeById(e.id).getBehavior();return t&&"no-nav"===t.value?null:e}(e);return t?a.a.createElement(H,{key:t.id,item:t}):null}))};z.propTypes={items:N.a.array.isRequired};var G=z,K=function(e){function t(e){var n;return y()(this,t),(n=E()(this,O()(t).call(this,e))).manifest=n.props.manifest,n}return w()(t,e),g()(t,[{key:"componentDidUpdate",value:function(e){this.props.clickedUrl&&this.handleItemClick(this.props.clickedUrl)}},{key:"handleItemClick",value:function(e){var t=this.props.player,n=function(e){if(void 0===e);else{var t=e.split("#t=")[1];if(void 0!==t){var n=t.split(",");return{start:n[0],stop:n[1]}}}}(e);n?(t.paused||t.pause(),t.setCurrentTime(n.start),t.play()):console.error("Error retrieving time fragment object from Canvas url in StructuredNav.js")}},{key:"render",value:function(){return this.manifest.structures?a.a.createElement(G,{items:this.manifest.structures}):a.a.createElement("p",null,"There are no structures in the manifest.")}}]),t}(r.Component);K.propTypes={manifest:N.a.object.isRequired};var Q=Object(i.b)(function(e){return{clickedUrl:e.nav.clickedUrl,player:e.player}})(K),V=function(e){function t(){return y()(this,t),E()(this,O()(t).apply(this,arguments))}return w()(t,e),g()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.iiifManifest,n=e.iiifManifestUrl;if(t)return this.props.fetchManifestSuccess(t);this.props.updateExternalConfig(this.props.config),this.props.getRemoteManifest(n)}},{key:"render",value:function(){var e=this.props.getManifest,t=e.manifest,n=e.error;return t?a.a.createElement("section",null,a.a.createElement(L,{manifest:t}),a.a.createElement(Q,{manifest:t})):n?a.a.createElement(R,{message:n}):a.a.createElement("p",null,"...Loading")}}]),t}(r.Component),W=Object(i.b)(function(e){return{getManifest:e.getManifest}},function(e){return{fetchManifestSuccess:function(t){return e(q.a(t))},getRemoteManifest:function(t){return e(q.b(t))},updateExternalConfig:function(t){return e(q.e(t))}}})(V);n.d(t,"b",function(){return X});var X=Object(o.d)(h,Object(o.a)(s.a));t.a=function(e){return a.a.createElement(i.a,{store:X},a.a.createElement(W,e))}},46:function(e,t,n){"use strict";(function(e){var r=n(4),a=n.n(r),i=n(5),o=n.n(i),s=n(7),u=n.n(s),c=n(8),l=n.n(c),f=n(9),p=n.n(f),d=n(0),h=n.n(d),m=n(6),y=n(10),v=n(47),g=n.n(v),b=(n(57),n(1)),E=n.n(b),j=(n(60),function(t){function n(e){var t;return a()(this,n),(t=u()(this,l()(n).call(this,e))).state={},t}return p()(n,t),o()(n,[{key:"success",value:function(e,t,n){console.log("Loaded successfully"),this.props.playerInitialized(n)}},{key:"error",value:function(e){console.log("Error loading")}},{key:"componentDidMount",value:function(){var t=this,n=e.MediaElementPlayer;if(n){var r=Object.assign({},JSON.parse(this.props.options),{pluginPath:"./static/media/",success:function(e,n,r){return t.success(e,n,r)},error:function(e,n){return t.error(e,n)}});window.Hls=g.a,this.setState({player:new n(this.props.id,r)})}}},{key:"componentWillUnmount",value:function(){this.state.player&&(this.state.player.remove(),this.setState({player:null}))}},{key:"render",value:function(){for(var e=this.props,t=JSON.parse(e.sources),n=[],r=0,a=t.length;r<a;r++){var i=t[r];n.push('<source src="'.concat(i.src,'" type="').concat(i.type,'">'))}var o="".concat(n.join("\n"),"\n\t\t\t\t").concat([].join("\n")),s="video"===e.mediaType?'<video data-testid="video-element" id="'.concat(e.id,'" width="').concat(e.width,'" height="').concat(e.height,'"').concat(e.poster?" poster=".concat(e.poster):"","\n\t\t\t\t\t").concat(e.controls?" controls":"").concat(e.preload?' preload="'.concat(e.preload,'"'):"",">\n\t\t\t\t\t").concat(o,"\n\t\t\t\t</video>"):'<audio data-testid="audio-element" id="'.concat(e.id,'" width="').concat(e.width,'" controls>\n\t\t\t\t\t').concat(o,"\n\t\t\t\t</audio>");return h.a.createElement("div",{dangerouslySetInnerHTML:{__html:s}})}}]),n}(d.Component));j.propTypes={id:E.a.string,mediaType:E.a.string,preload:E.a.string,width:E.a.number,height:E.a.number,poster:E.a.string,sources:E.a.string,options:E.a.string};t.a=Object(m.b)(null,function(e){return{playerInitialized:function(t){return e(y.d(t))}}})(j)}).call(this,n(3))},70:function(e,t){},72:function(e,t){},86:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(42),o=n(20).a,s={config:{fetch:{options:{credentials:"omit"}}},iiifManifestUrl:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/mahler-symphony-3.json"};Object(i.render)(a.a.createElement(o,s),document.getElementById("root"))}});
//# sourceMappingURL=main.2d2523ecf83cba89aa1d.js.map