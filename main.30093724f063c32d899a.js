!function(e){function n(n){for(var a,o,s=n[0],d=n[1],c=n[2],u=0,p=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(e[a]=d[a]);for(l&&l(n);p.length;)p.shift()();return r.push.apply(r,c||[]),t()}function t(){for(var e,n=0;n<r.length;n++){for(var t=r[n],a=!0,s=1;s<t.length;s++){var d=t[s];0!==i[d]&&(a=!1)}a&&(r.splice(n--,1),e=o(o.s=t[0]))}return e}var a={},i={0:0},r=[];function o(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=a,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)o.d(t,a,function(n){return e[n]}.bind(null,a));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="";var s=window.webpackJsonp=window.webpackJsonp||[],d=s.push.bind(s);s.push=n,s=s.slice();for(var c=0;c<s.length;c++)n(s[c]);var l=d;r.push([89,1]),t()}({17:function(e,n,t){"use strict";var a=t(0),i=t.n(a),r=t(5),o=t(13),s=t(47),d=t(2),c=t(4),l=t(20),u=t.n(l),p={error:!1,loading:!1},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d.b:return Object.assign({},e,{error:!1,loading:!0,manifest:null,url:n.payload});case d.c:return Object.assign({},e,{error:!1,loading:!1,manifest:n.payload,parsedManifest:u.a.create(n.payload),canvases:Object(c.a)(n.payload)});case d.a:return Object.assign({},e,{error:n.payload,loading:!1,manifest:null,url:null});default:return e}},f={reload:!1,canvasIndex:0},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d.f:return Object.assign({},e,{clickedUrl:n.payload});case d.e:return Object.assign({},e,{reload:!0,canvasIndex:n.payload});default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d.d:return n.payload;default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case d.g:return Object.assign({},e,n.payload);default:return e}},g=Object(o.c)({externalConfig:v,getManifest:h,nav:m,player:y}),b=t(7),_=t.n(b),C=t(8),T=t.n(C),E=t(9),I=t.n(E),x=t(10),k=t.n(x),j=t(11),O=t.n(j),M=t(26),S=t.n(M),w=t(48),R=t.n(w),A=t(49),N=t(1),P=t.n(N),U=function(e){return i.a.createElement("p",null,"ERROR: ",e.message)};U.propTypes={message:P.a.string.isRequired};var D=U,L=function(e){function n(){var e,t;_()(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return t=I()(this,(e=k()(n)).call.apply(e,[this].concat(i))),R()(S()(t),"state",{manifest:t.props.manifest,ready:!1,sources:[],mediaType:null,canvasIndex:t.props.canvasIndex,error:null}),t}return O()(n,e),T()(n,[{key:"render",value:function(){var e=this.state,n=e.manifest,t=e.ready,a=e.sources,r=e.mediaType,o=e.canvasIndex,s=e.error;return t?i.a.createElement("div",{"data-testid":"mediaelement-".concat(o)},i.a.createElement(A.a,{key:"mediaelement-".concat(o),id:"avln-mediaelement-component",mediaType:r,preload:"auto",controls:!0,width:n.width||480,height:n.height||360,poster:"",crossorigin:"anonymous",sources:JSON.stringify(a),options:JSON.stringify({})})):s?i.a.createElement(D,{message:s}):null}}],[{key:"getDerivedStateFromProps",value:function(e){var n=e.manifest,t=e.canvasIndex,a=Object(c.g)(n,t),i=a.sources,r=a.mediaType,o=a.error;return{sources:i,mediaType:r,canvasIndex:t,ready:!o,error:o}}}]),n}(a.Component);L.propTypes={manifest:P.a.object};var F=Object(r.b)(function(e){return{reload:e.nav.reload,canvasIndex:e.nav.canvasIndex}})(L),H=t(6),J=function(e){var n,t=e.item,a=Object(c.d)(t.id),r=t.items&&t.items.length>0&&0===a.length?i.a.createElement(K,{items:t.items}):null,o=function(n){n.stopPropagation(),n.preventDefault(),e.navItemClick(n.target.href)};return i.a.createElement("li",{"data-testid":"list-item"},(n=Object(c.e)(t.label),a.length>0?a.map(function(e){return i.a.createElement("a",{key:e,href:e,onClick:o},n)}):n),r)};J.propTypes={item:P.a.object.isRequired};var q=Object(r.b)(null,function(e){return{navItemClick:function(n){return e(H.c(n))}}})(J),B=function(e){return i.a.createElement("ul",{"data-testid":"list"},e.items.map(function(e){var n=Object(c.b)(e);return n?i.a.createElement(q,{key:n.id,item:n}):null}))};B.propTypes={items:P.a.array.isRequired};var K=B,V=function(e){function n(e){var t;return _()(this,n),(t=I()(this,k()(n).call(this,e))).manifest=t.props.manifest,t.state={startTime:null},t}return O()(n,e),T()(n,[{key:"componentDidUpdate",value:function(e){var n=this.props,t=n.clickedUrl,a=n.player;t!=e.clickedUrl&&this.handleItemClick(t);var i=this.state.startTime;i&&a.setCurrentTime(i)}},{key:"handleItemClick",value:function(e){var n=this.props,t=n.player,a=n.canvases,i=a.find(function(n){return Object(c.c)(e)===n.canvasId}),r=a.indexOf(i),o=null;i&&(o=i.canvasSources),o.includes(t.getSrc())||this.props.swapMediaElement(r);var s=Object(c.f)(e);s?this.setState({startTime:s.start}):console.error("Error retrieving time fragment object from Canvas url in StructuredNav.js")}},{key:"render",value:function(){return this.manifest.structures?i.a.createElement("div",{"data-testid":"structured-nav"},i.a.createElement(K,{items:this.manifest.structures})):i.a.createElement("p",null,"There are no structures in the manifest.")}}]),n}(a.Component);V.propTypes={manifest:P.a.object.isRequired};var z={swapMediaElement:H.e},G=Object(r.b)(function(e){return{clickedUrl:e.nav.clickedUrl,player:e.player,canvases:e.getManifest.canvases}},z)(V),W=(t(87),function(e){function n(){return _()(this,n),I()(this,k()(n).apply(this,arguments))}return O()(n,e),T()(n,[{key:"componentDidMount",value:function(){var e=this.props,n=e.iiifManifest,t=e.iiifManifestUrl;if(n)return this.props.fetchManifestSuccess(n);this.props.updateExternalConfig(this.props.config),this.props.getRemoteManifest(t)}},{key:"render",value:function(){var e=this.props.getManifest,n=e.manifest,t=e.error;return n?i.a.createElement("section",{className:"iiif-player"},i.a.createElement("div",{className:"container"},i.a.createElement(F,{manifest:n}),i.a.createElement(G,{manifest:n}))):t?i.a.createElement(D,{message:t}):i.a.createElement("p",null,"...Loading")}}]),n}(a.Component)),Q=Object(r.b)(function(e){return{getManifest:e.getManifest}},function(e){return{fetchManifestSuccess:function(n){return e(H.a(n))},getRemoteManifest:function(n){return e(H.b(n))},updateExternalConfig:function(n){return e(H.f(n))}}})(W);t.d(n,"b",function(){return X});var X=Object(o.d)(g,Object(o.a)(s.a));n.a=function(e){return i.a.createElement(r.a,{store:X},i.a.createElement(Q,e))}},2:function(e,n,t){"use strict";t.d(n,"d",function(){return a}),t.d(n,"f",function(){return i}),t.d(n,"e",function(){return r}),t.d(n,"b",function(){return o}),t.d(n,"c",function(){return s}),t.d(n,"a",function(){return d}),t.d(n,"g",function(){return c});var a="MEJS_PLAYER_INITIALIZED",i="NAV_ITEM_CLICK",r="MEJS_SWAP",o="FETCH_MANIFEST_REQUEST",s="FETCH_MANIFEST_SUCCESS",d="FETCH_MANIFEST_FAILURE",c="UPDATE_EXTERNAL_CONFIG"},4:function(e,n,t){"use strict";var a=t(25),i=t.n(a),r=t(20),o=t.n(r),s=t(17),d=function(){return s.b.getState().getManifest.parsedManifest};function c(e){return o.a.create(e).getSequences()[0].getCanvases().map(function(e){var n=e.getContent()[0].getBody().map(function(e){return e.id});return{canvasId:e.id,canvasSources:n}})}function l(e){var n=d().getRangeById(e.id).getBehavior();return n&&"no-nav"===n.value?null:e}function u(e){var n=[];try{n=d().getRangeById(e).getCanvasIds()}catch(e){console.log("error fetching range canvases",e)}return n}function p(e,n){var t=[];try{t=o.a.create(e).getSequences()[0].getCanvases()[n].getContent()[0].getBody()}catch(e){}if(0===t.length)return{error:"No media sources found"};var a=t.map(function(e){return{src:e.id,format:e.getFormat().value}}),i=t.map(function(e){return e.getType().value}),r=i.filter(function(e,n){return i.indexOf(e)===n});return{sources:a,mediaType:1===r.length?r[0]:"video",error:null}}function h(e){if(e&&"object"===i()(e)){if(e.hasOwnProperty("en"))return e.en.length>0?e.en[0]:"";if(e.hasOwnProperty("none"))return e.none.length>0?e.none[0]:""}else if("string"==typeof e)return e;return"Label could not be parsed"}function f(e){if(void 0===e);else{var n=e.split("#t=")[1];if(void 0!==n){var t=n.split(",");return{start:t[0],stop:t[1]}}}}function m(e){if(void 0!==e)return e.split("#t=")[0]}function y(e){return d().getSequences()[0].getCanvases().map(function(e){return e.id}).length-1>e}t.d(n,"a",function(){return c}),t.d(n,"b",function(){return l}),t.d(n,"d",function(){return u}),t.d(n,"g",function(){return p}),t.d(n,"e",function(){return h}),t.d(n,"f",function(){return f}),t.d(n,"c",function(){return m}),t.d(n,"h",function(){return y})},49:function(e,n,t){"use strict";(function(e){var a=t(7),i=t.n(a),r=t(8),o=t.n(r),s=t(9),d=t.n(s),c=t(10),l=t.n(c),u=t(11),p=t.n(u),h=t(0),f=t.n(h),m=t(5),y=t(6),v=t(50),g=t.n(v),b=(t(80),t(1)),_=t.n(b),C=t(4),T=(t(82),function(n){function t(e){var n;return i()(this,t),(n=d()(this,l()(t).call(this,e))).state={},n}return p()(t,n),o()(t,[{key:"success",value:function(e,n,t){var a=this;console.log("Loaded successfully"),this.props.playerInitialized(t),e.addEventListener("ended",function(e){e&&a.handleEnded()})}},{key:"error",value:function(e){console.log("Error loading")}},{key:"handleEnded",value:function(){Object(C.h)(this.props.canvasIndex)&&this.props.swapMediaElement(this.props.canvasIndex+1)}},{key:"componentDidMount",value:function(){var n=this,t=e.MediaElementPlayer;if(t){var a=Object.assign({},JSON.parse(this.props.options),{pluginPath:"./static/media/",success:function(e,t,a){return n.success(e,t,a)},error:function(e,t){return n.error(e,t)}});window.Hls=g.a,this.setState({player:new t(this.props.id,a)})}}},{key:"componentWillUnmount",value:function(){this.state.player&&(this.state.player.remove(),this.setState({player:null}))}},{key:"render",value:function(){for(var e=this.props,n=JSON.parse(e.sources),t=[],a=0,i=n.length;a<i;a++){var r=n[a];t.push('<source src="'.concat(r.src,'" type="').concat(r.format,'">'))}var o="".concat(t.join("\n"),"\n\t\t\t\t").concat([].join("\n")),s="video"===e.mediaType?'<video data-testid="video-element" id="'.concat(e.id,'" width="').concat(e.width,'" height="').concat(e.height,'"').concat(e.poster?" poster=".concat(e.poster):"","\n\t\t\t\t\t  ").concat(e.controls?" controls":"").concat(e.preload?' preload="'.concat(e.preload,'"'):"",">\n\t\t\t\t\t").concat(o,"\n\t\t\t\t</video>"):'<audio data-testid="audio-element" id="'.concat(e.id,'" width="').concat(e.width,'" ').concat(e.controls?" controls":"").concat(e.preload?' preload="'.concat(e.preload,'"'):"",">\n\t\t\t\t\t").concat(o,"\n\t\t\t\t</audio>");return f.a.createElement("div",{dangerouslySetInnerHTML:{__html:s}})}}]),t}(h.Component));T.propTypes={id:_.a.string,mediaType:_.a.string,preload:_.a.string,width:_.a.number,height:_.a.number,poster:_.a.string,sources:_.a.string,options:_.a.string};var E={playerInitialized:function(e){return y.d(e)},swapMediaElement:y.e};n.a=Object(m.b)(function(e){return{player:e.player,canvasIndex:e.nav.canvasIndex}},E)(T)}).call(this,t(3))},6:function(e,n,t){"use strict";var a=t(2),i=t(17);function r(e){var n=function(){var e=i.b.getState().externalConfig.fetch,n={};e&&e.options&&Object.assign(n,e.options);return n}();return fetch(e,n).then(function(e){if(e.ok)return e.json();throw new Error("Network request was not ok")}).then(function(e){return e}).catch(function(e){return console.log("Problem with the fetch operation",e),{error:"Network failure fetching the manifest"}})}function o(e){return{type:a.c,payload:e}}function s(e){return{type:a.d,payload:e}}function d(e){return{type:a.f,payload:e}}function c(e){return{type:a.g,payload:e}}function l(e){return{type:a.e,payload:e}}function u(e){return function(n){return n(function(e){return{type:a.b,payload:e}}(e)),r(e).then(function(e){return e.error?n((t=e.error,{type:a.a,payload:t})):n(o(e));var t})}}t.d(n,"a",function(){return o}),t.d(n,"d",function(){return s}),t.d(n,"c",function(){return d}),t.d(n,"f",function(){return c}),t.d(n,"e",function(){return l}),t.d(n,"b",function(){return u})},62:function(e,n){},64:function(e,n){},87:function(e,n,t){var a=t(88);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};t(44)(a,i);a.locals&&(e.exports=a.locals)},88:function(e,n,t){(e.exports=t(43)(!1)).push([e.i,".iiif-player > .container {\n  padding-top: 15px;\n}\n",""])},89:function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(45),o=t(17).a,s={config:{fetch:{options:{credentials:"omit"}}},iiifManifest:{"@context":"http://iiif.io/api/presentation/3/context.json",id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/mahler-symphony-3.json",type:"Manifest",label:{en:["Symphony no. 3 - Mahler, Gustav, 1860-1911"]},description:"Published by the Indiana University School of Music. Recorded Jan. 17-18, 1995, in the Musical Arts Center, Bloomington, Ind. Compact disc",items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1",type:"Canvas",duration:1985,items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/annopage/1",type:"AnnotationPage",items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/annopage/1/1",type:"Annotation",motivation:"painting",target:"https://dlib.indiana.edu/iiif_av/canvas/1",body:[{type:"Choice",choiceHint:"user",items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/CD1/high/320Kbps.mp4",type:"Audio",format:"audio/mp4; codec..xxxxx",label:{en:["High"]}},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/CD1/medium/128Kbps.mp4",type:"Audio",format:"audio/mp4; codec..xxxxx",label:{en:["Medium"]}}]}]}]}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2",type:"Canvas",duration:3829,items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/annopage/2",type:"AnnotationPage",items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/annopage/2/2",type:"Annotation",motivation:"painting",target:"https://dlib.indiana.edu/iiif_av/canvas/2",body:[{type:"Choice",choiceHint:"user",items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/CD2/high/320Kbps.mp4",type:"Audio",format:"audio/mp4; codec..xxxxx",label:{en:["High"]}},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/CD2/medium/128Kbps.mp4",type:"Audio",format:"audio/mp4; codec..xxxxx",label:{en:["Medium"]}}]}]}]}]}],structures:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/0",type:"Range",behavior:"top",label:{en:["Symphony no. 3 - Mahler, Gustav"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1",type:"Range",label:{en:["CD1 - Mahler, Symphony No.3"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-1",type:"Range",label:{en:["Track 1. I. Kraftig"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=0,374",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-2",type:"Range",label:{en:["Track 2. Langsam. Schwer"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=374,525",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-3",type:"Range",label:{en:["Track 3. Tempo I"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=525,711",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-4",type:"Range",label:{en:["Track 4. Schwungvoll"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=711,1188",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-5",type:"Range",label:{en:["Track 5. Immer dasselbe Tempo"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=1188,1406",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-6",type:"Range",label:{en:["Track 6. Wie zu Anfang"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=1406,1693",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/1-7",type:"Range",label:{en:["Track 7. Tempo I"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/1#t=01693,1985",type:"Canvas"}]}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2",type:"Range",label:{en:["CD2 - Mahler, Symphony No.3 (cont.)"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-1",type:"Range",label:{en:["Track 1. II. Tempo di Menuetto"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=0,566",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-2",type:"Range",label:{en:["Track 2. III. Comodo"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=566,1183",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-3",type:"Range",label:{en:["Track 3. Tempo I"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=1183,1635",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-4",type:"Range",label:{en:["Track 4. IV. Misterioso"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=1635,2204",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-5",type:"Range",label:{en:["Track 5. V. Lustig im Tempo"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=2204,2475",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-6",type:"Range",label:{en:["Track 6. VI. Langsam"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=2475,3047",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-7",type:"Range",label:{en:["Track 7. Nicht mehr so breit"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=3047,3287",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-8",type:"Range",label:{en:["Track 8. Tempo I"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=3287,3451",type:"Canvas"}]},{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/range/2-9",type:"Range",label:{en:["Track 9. Tempo I"]},items:[{id:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/canvas/2#t=3451,3829",type:"Canvas"}]}]}]}]},iiifManifestUrl:"https://dlib.indiana.edu/iiif_av/mahler-symphony-3/mahler-symphony-3.json"};Object(r.render)(i.a.createElement(o,s),document.getElementById("root"))}});
//# sourceMappingURL=main.30093724f063c32d899a.js.map