{"version":3,"sources":["webpack:///./node_modules/iiif-explorer/dist/esm-es5/iiif-explorer_17-ios.entry.js","webpack:///./node_modules/iiif-explorer/dist/esm-es5/theme-215399f6.js","webpack:///./node_modules/iiif-explorer/dist/esm-es5/helpers-b7c9db54.js","webpack:///./node_modules/iiif-explorer/dist/esm-es5/index-6b565e81.js","webpack:///./node_modules/iiif-explorer/dist/esm-es5/spinner-configs-11ca13d6.js"],"names":["StorageType","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","this","n","v","op","TypeError","call","pop","length","push","__spreadArrays","s","i","il","arguments","r","Array","k","a","j","jl","Clipboard","supportsCopy","document","queryCommandSupported","copy","text","convertBrToNewLine","textArea","createElement","hideButKeepEnabled","appendChild","focus","select","execCommand","removeChild","style","position","top","left","width","height","padding","border","outline","boxShadow","background","replace","JSONLDResource","jsonld","__jsonld","context","getProperty","id","prototype","name","prop","unwrapExports","x","__esModule","Object","hasOwnProperty","createCommonjsModule","fn","module","exports","distCommonjs","defineProperty","AnnotationMotivation","Behavior","ExternalResourceType","IIIFResourceType","MediaType","RenderingFormat","ServiceProfile","ViewingDirection","ViewingHint","extendStatics","ManifestType","distCommonjs_2","distCommonjs_4","distCommonjs_7","distCommonjs_8","distCommonjs_9","__extends","d","b","setPrototypeOf","__proto__","p","__","constructor","create","ManifestResource","_super","options","_this","getIIIFResourceType","Utils","normaliseType","getLabel","LanguageMap","parse","locale","getDefaultLabel","getValue","getMetadata","_metadata","metadata","item","metadataItem","LabelValuePair","getRendering","format","renderings","getRenderings","rendering","getFormat","isArray","Rendering","getService","profile","getServices","getThumbnail","thumbnail","Thumbnail","isAnnotation","ANNOTATION","isCanvas","CANVAS","isCollection","COLLECTION","isManifest","MANIFEST","isRange","RANGE","isSequence","SEQUENCE","__extends$1","Resource","toLowerCase","getResources","resources","annotation","Annotation","getType","type","getWidth","getHeight","getMaxWidth","getMaxHeight","__extends$2","IIIFResource","index","isLoaded","defaultOptions","defaultLabel","resource","pessimisticAccessControl","assign","getAttribution","attribution","getDescription","description","getLogo","logo","getLicense","getLocalisedValue","getNavDate","Date","getRelated","getSeeAlso","getTrackingLabel","service","TRACKING_EXTENSIONS","getDefaultTree","defaultTree","TreeNode","data","getRequiredStatement","requiredStatement","_requiredStatement","load","that","options_1","navDate","loadManifest","parentLabel","parsed","Deserialiser","__extends$3","getBody","bodies","items","i_1","c","AnnotationBody","getMotivation","motivation","getOn","getTarget","getResource","__extends$4","getMediaType","__extends$5","AnnotationList","map","catch","__extends$6","AnnotationPage","getItems","__extends$7","Canvas","getCanonicalImageUri","w","size","quality","externalResource","indexOf","images","getImages","services","getImageQuality","getProfile","endsWith","substr","join","getMaxDimensions","maxDimensions","filter","Size","maxWidth","maxHeight","getContent","content","annotationPage","annotations","getDuration","getIndex","getOtherContent","otherContent","otherPromises","typeA","typeB","annotationList","all","__extends$8","Collection","_collections","_manifests","__collection","getCollections","m","getManifests","getCollectionByIndex","collectionIndex","collection","collections","Error","getManifestByIndex","manifestIndex","manifest","manifests","getTotalCollections","getTotalManifests","getTotalItems","getViewingDirection","LEFT_TO_RIGHT","TreeNodeType","_parseManifests","_parseCollections","generateTreeNodeIds","parentCollection","tree","addNode","Duration","start","end","getLength","defaultLocale","setLabel","getInexactLocale","setValue","Language","__extends$9","language","tc","keys","forEach","key","languageCollection","__extends$a","Manifest","_allRanges","_topRanges","structures","topRanges","_getTopRanges","range","_parseRanges","String","getPosterCanvas","posterCanvas","getBehavior","behavior","getTopRanges","getTree","json","viewingHint","TOP","ranges","_getRangeById","path","parentRange","Range","members","canvases","id_1","console","warn","getAllRanges","_loop_1","topRange","this_1","reducer","acc","add","nextRanges","getRanges","reduce","subRanges","from","Set","concat","getRangeById","getRangeByPath","getSequences","mediaSequences","sequences","sequence","Sequence","getSequenceByIndex","sequenceIndex","getTotalSequences","getManifestType","UI_EXTENSIONS","EMPTY","isMultiSequence","isPagingEnabled","getViewingHint","PAGED","StatusCode","__extends$b","_ranges","getCanvasIds","canvas","temporal","getTemporalComponent","Number","childRanges","duration","undefined","treeRoot","treeNode","node","_parseTreeNode","spansTime","time","childRange","NO_NAV","childNode","__extends$c","__extends$d","_thumbnails","getCanvases","elements","getCanvasById","getTotalCanvases","getCanvasByIndex","canvasId","normaliseUrl","canvasIndex","getCanvasIndexById","getCanvasIndexByLabel","foliated","trim","isNaN","parseInt","toString","match","labelPart1","labelPart2","doublePageRegExp","exec","RegExp","test","getLastCanvasLabel","alphanumeric","getLastPageIndex","getNextPageIndex","pagingEnabled","indices","getPagedIndices","viewingDirection","RIGHT_TO_LEFT","isFirstCanvas","isLastCanvas","reverse","getPrevPageIndex","getStartCanvasIndex","startCanvas","getStartCanvas","getThumbs","thumbs","totalCanvases","thumb","Thumb","getThumbnails","isCanvasIndexOutOfRange","isMultiCanvas","isTotalCanvasesEven","JSON","parseJson","getTime","parseCollection","parseManifest","parseCollections","parseManifests","parseItems","parseItem","state_1","__extends$e","Service","getConfirmLabel","getFailureDescription","getFailureHeader","getHeader","getServiceLabel","getInfoUri","infoUri","heightRatio","Math","floor","uri","__extends$f","nodes","parentNode","distCommonjs$1","CONTINUE","SWITCHING_PROTOCOLS","PROCESSING","OK","CREATED","ACCEPTED","NON_AUTHORITATIVE_INFORMATION","NO_CONTENT","RESET_CONTENT","PARTIAL_CONTENT","MULTI_STATUS","MULTIPLE_CHOICES","MOVED_PERMANENTLY","MOVED_TEMPORARILY","SEE_OTHER","NOT_MODIFIED","USE_PROXY","TEMPORARY_REDIRECT","BAD_REQUEST","UNAUTHORIZED","PAYMENT_REQUIRED","FORBIDDEN","NOT_FOUND","METHOD_NOT_ALLOWED","NOT_ACCEPTABLE","PROXY_AUTHENTICATION_REQUIRED","REQUEST_TIME_OUT","CONFLICT","GONE","LENGTH_REQUIRED","PRECONDITION_FAILED","REQUEST_ENTITY_TOO_LARGE","REQUEST_URI_TOO_LARGE","UNSUPPORTED_MEDIA_TYPE","REQUESTED_RANGE_NOT_SATISFIABLE","EXPECTATION_FAILED","IM_A_TEAPOT","UNPROCESSABLE_ENTITY","LOCKED","FAILED_DEPENDENCY","UNORDERED_COLLECTION","UPGRADE_REQUIRED","PRECONDITION_REQUIRED","TOO_MANY_REQUESTS","REQUEST_HEADER_FIELDS_TOO_LARGE","INTERNAL_SERVER_ERROR","NOT_IMPLEMENTED","BAD_GATEWAY","SERVICE_UNAVAILABLE","GATEWAY_TIME_OUT","HTTP_VERSION_NOT_SUPPORTED","VARIANT_ALSO_NEGOTIATES","INSUFFICIENT_STORAGE","BANDWIDTH_LIMIT_EXCEEDED","NOT_EXTENDED","NETWORK_AUTHENTICATION_REQUIRED","distCommonjs_4$1","distCommonjs_14","distCommonjs_20","CACHED_MAP","unfetch$1","freeze","XMLHttpRequest","o","u","ok","status","statusText","url","responseURL","responseText","blob","Blob","response","clone","headers","entries","get","has","l","open","method","onload","getAllResponseHeaders","onerror","withCredentials","credentials","setRequestHeader","send","require$$0","window","fetch","default","split","IMAGE_0_COMPLIANCE_LEVEL_1","IMAGE_0_COMPLIANCE_LEVEL_2","IMAGE_1_COMPLIANCE_LEVEL_1","IMAGE_1_COMPLIANCE_LEVEL_2","IMAGE_0_CONFORMANCE_LEVEL_1","IMAGE_0_CONFORMANCE_LEVEL_2","IMAGE_1_CONFORMANCE_LEVEL_1","IMAGE_1_CONFORMANCE_LEVEL_2","IMAGE_1_LEVEL_1","IMAGE_1_PROFILE_LEVEL_1","IMAGE_1_LEVEL_2","IMAGE_1_PROFILE_LEVEL_2","value_1","normalisedUrlsMatch","url1","url2","isImageProfile","IMAGE_0_COMPLIANCE_LEVEL_0","IMAGE_1_COMPLIANCE_LEVEL_0","IMAGE_0_CONFORMANCE_LEVEL_0","IMAGE_1_LEVEL_0","IMAGE_1_PROFILE_LEVEL_0","IMAGE_2_LEVEL_0","IMAGE_2_PROFILE_LEVEL_0","IMAGE_2_LEVEL_1","IMAGE_2_PROFILE_LEVEL_1","IMAGE_2_LEVEL_2","IMAGE_2_PROFILE_LEVEL_2","isLevel0ImageProfile","IMAGE_1_CONFORMANCE_LEVEL_0","isLevel1ImageProfile","isLevel2ImageProfile","checkStatus","error","loadExternalResourcesAuth1","openContentProviderInteraction","openTokenService","getStoredAccessToken","userInteractedWithContentProvider","getContentProviderInteraction","handleMovedTemporarily","showOutOfOptionsMessages","promises","loadExternalResourceAuth1","storedAccessToken","_a","getData","doAuthChain","createAuthorizationFailedError","externalService","kioskService","clickThroughService","loginService","serviceToTry","lastAttempted","kioskInteraction","contentProviderInteraction","isAccessControlled","isResponseHandled","attemptResourceWithToken","authService","tokenService","tokenMessage","AUTH_1_TOKEN","accessToken","loadExternalResourcesAuth09","tokenStorageStrategy","clickThrough","restricted","login","getAccessToken","storeAccessToken","handleResourceResponse","loadExternalResourceAuth09","token","message","createInternalServerError","authorize","createError","AUTHORIZATION_FAILED","createRestrictedError","RESTRICTED","showAuthInteraction","getResourceById","parentResource","traverseAndFind","object","target","img","IIIFExplorer","class_1","hostRef","_items","copyEnabled","pageLoadThreshold","pageSize","pagingLimitKey","pagingStartKey","searchEnabled","upLevelEnabled","_parentCollections","_currentPage","selectCollection","selectManifest","componentWillLoad","_b","_loadCollection","_loadPage","event","_currentCollectionId","complete","_upLevel","slice","_selectedItem","_sortCollectionsFirst","aType","bType","aLabel","bLabel","enumerable","configurable","_pageUrl","limit","URL","baseURI","origin","pathname","search","_normaliseCollectionId","params","URLSearchParams","delete","collectionId","page","nextCollectionId","_loading","_pagingEnabled","sort","_searchInput","el","querySelector","children","query","requestAnimationFrame","shouldShow","textContent","display","render","_this_1","class","lines","src","slot","enabled","isOpen","_copyEnabled","selected","threshold","onIonInfinite","placeholder","onIonInput","breadcrumbSelected","detail","onUpLevel","itemSelected","emit","IIIFExplorerBreadcrumb","selectBreadcrumb","upLevel","onClick","title","noselect","_e","IIIFExplorerItem","class_2","popoverFadeTimeout","selectItem","folder","file","ev","popover","parentElement","classList","remove","setTimeout","Button","inItem","inListHeader","inToolbar","buttonType","disabled","routerDirection","strong","handleClick","href","form","closest","preventDefault","fakeButton","click","onFocus","ionFocus","onBlur","ionBlur","fill","hasIconOnly","mode","_c","rel","color","expand","shape","finalSize","TagType","attrs","download","part","rippleType","Content","class_3","isScrolling","lastScroll","queued","cTop","cBottom","scrollTop","scrollLeft","startX","startY","startTime","currentX","currentY","velocityX","velocityY","deltaX","deltaY","currentTime","fullscreen","scrollX","scrollY","scrollEvents","ionScrollStart","ionScroll","ionScrollEnd","disconnectedCallback","onScrollEnd","componentDidLoad","resize","stopPropagation","shouldForceOverscroll","forceOverscroll","readDimensions","bind","forceUpdate","getPageElement","max","offsetTop","bottom","offsetHeight","onScroll","timeStamp","now","shouldStart","onScrollStart","ts","updateScrollDetail","scrollEl","getScrollElement","scrollToTop","scrollToPoint","scrollToBottom","scrollHeight","clientHeight","scrollByPoint","promise","fromY","fromX","linearTime","min","easedT","pow","watchDog","clearInterval","setInterval","transitionShadow","getBoolean","ref","tabs","host","getParentElement","timestamp","prevX","prevY","prevT","timeDelta","Footer","translucent","role","cloneElement","tagName","getCachedEl","clonedEl","setProperty","createHeaderIndex","headerEl","toolbars","querySelectorAll","toolbar","ionTitleEl","shadowRoot","innerTitleEl","ionButtonsEl","setToolbarBackgroundOpacity","opacity","removeProperty","handleToolbarIntersection","mainHeaderIndex","scrollHeaderIndex","isIntersecting","scale","intersectionRatio","handleToolbarBorderIntersection","intersection","intersectionRect","intersectionArea","rootArea","rootBounds","isPageHidden","leftDiff","abs","boundingClientRect","rightDiff","right","setHeaderActive","headerIndex","active","scaleLargeTitles","transition","ionTitle","titleDiv","transformOrigin","transform","Header","class_4","collapsibleHeaderInitialized","checkCollapsibleHeader","componentDidUpdate","componentDidUnload","destroyCollapsibleHeader","hasCollapse","canCollapse","pageEl","contentEl","collapse","setupCollapsibleHeader","intersectionObserver","disconnect","contentScrollCallback","removeEventListener","collapsibleMainHeader","toolbarIntersection","find","header","IntersectionObserver","root","observe","handleContentScroll","addEventListener","getNamedUrl","iconName","Map","win","Ionicons","getIconMap","getName","icon","ios","md","toLower","isSrc","isStr","getSrc","str","val","isValid","elm","nodeType","nodeName","attributes","childNodes","ioniconContent","requests","getSvgContent","req","set","rsp","svgContent","div","innerHTML","svgElm","firstElementChild","svgClass","getAttribute","setAttribute","validateContent","Icon","isVisible","getIonMode","lazy","connectedCallback","waitUntilVisible","loadIcon","io","rootMargin","cb","io_1","url_1","getUrl","ariaLabel","flipRtl","createColorClasses","ownerDocument","dir","documentElement","InfiniteScroll","class_5","thrPx","thrPc","didFire","isBusy","isLoading","canStart","infiniteHeight","ionInfinite","thresholdChanged","lastIndexOf","parseFloat","disabledChanged","enableScrollEvents","prev_1","newScrollTop","shouldListen","InfiniteScrollContent","loadingSpinner","loadingText","Item","itemStyles","multipleInputs","button","detailIcon","itemStyle","updatedStyles","newStyles","childStyles","hasStyleChange","itemKey","covers","inputs","clickables","isClickable","hasCover","canActivate","clickable","showDetail","Label","noAnimate","ionStyle","emitStyle","positionChanged","List","class_6","inset","closeSlidingItems","closeOpened","RippleEffect","class_7","addRipple","rect","getBoundingClientRect","hypotenuse","sqrt","maxDim","maxRadius","unbounded","PADDING","initialSize","INITIAL_ORIGIN_SCALE","finalScale","posX","posY","styleX","styleY","moveX","moveY","removeRipple","ripple","Searchbar","class_8","isCancelVisible","shouldAlignLeft","focused","animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","debounce","showCancelButton","spellcheck","onClearInput","ionClear","ionInput","onCancelSearchbar","ionCancel","nativeInput","blur","onInput","input","positionElements","ionChange","debounceChanged","valueChanged","inputEl","showCancelButtonChanged","setFocus","getInputElement","prevAlignLeft","positionPlaceholder","positionCancelButton","isRTL","iconEl","removeAttribute","doc","tempSpan_1","innerText","textWidth","offsetWidth","inputLeft","iconLeft","paddingRight","marginRight","paddingLeft","marginLeft","cancelButton","shouldShowCancel","shouldShowCancelButton","cancelStyle","offset","hasValue","clearIcon","searchIcon","tabIndex","onMouseDown","onTouchStart","inputMode","inputmode","autoComplete","autoCorrect","spellCheck","Spinner","paused","spinnerName","spinner","dur","svgs","circles","buildCircle","buildLine","elmDuration","animationDuration","total","viewBox","cx","cy","y1","y2","Toolbar","childrenStyles","buttons","firstButtons","buttonsReversed","lastButtons","childrenStyle","childKey","newValue","hostContext","selector","getClassMap","classes","getClassList","SCHEME","openURL","direction","router","raf","h","__zone_symbol__requestAnimationFrame","hasShadowDom","attachShadow","findItemLabel","componentEl","itemEl","renderHiddenInput","always","container","clamp","assert","actual","reason","pointerCoord","changedTouches","touch","clientX","clientY","pageX","pageY","isEndSide","side","debounceEvent","wait","original","_original","func","timer","args","_i","clearTimeout","sanitizeDOMString","untrustedString","documentFragment_1","createDocumentFragment","workingDiv","blockedTags","blockedTag","getElementsToRemove","elementIndex","element","childElements","getElementChildren","childIndex","sanitizeElement","dfChildren","fragmentDiv","getInnerDiv","err","attribute","attributeName","allowedAttributes","includes","attributeValue","SPINNERS","animationDelay","angle","PI","sin","cos"],"mappings":"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","file":"27.fa3977d7dbb5e9bc92dc.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nimport { r as registerInstance, c as createEvent, h, d as getElement, e as getIonMode$1, H as Host, i as isPlatform, f as readTask, j as config, w as writeTask, k as getAssetPath } from './core-0428d3c8.js';\r\nimport { h as hasShadowDom, c as clamp, d as debounceEvent, r as raf } from './helpers-b7c9db54.js';\r\nimport { o as openURL, c as createColorClasses$1, h as hostContext } from './theme-215399f6.js';\r\nimport { s as sanitizeDOMString } from './index-6b565e81.js';\r\nimport { S as SPINNERS } from './spinner-configs-11ca13d6.js';\r\nvar Clipboard = /** @class */ (function () {\r\n    function Clipboard() {\r\n    }\r\n    Clipboard.supportsCopy = function () {\r\n        return document.queryCommandSupported && document.queryCommandSupported('copy');\r\n    };\r\n    Clipboard.copy = function (text) {\r\n        text = Clipboard.convertBrToNewLine(text);\r\n        var textArea = document.createElement(\"textarea\");\r\n        textArea.value = text;\r\n        Clipboard.hideButKeepEnabled(textArea);\r\n        document.body.appendChild(textArea);\r\n        textArea.focus();\r\n        textArea.select();\r\n        document.execCommand('copy');\r\n        document.body.removeChild(textArea);\r\n    };\r\n    Clipboard.hideButKeepEnabled = function (textArea) {\r\n        // Place in top-left corner of screen regardless of scroll position.\r\n        textArea.style.position = 'fixed';\r\n        textArea.style.top = '0';\r\n        textArea.style.left = '0';\r\n        // Ensure it has a small width and height. Setting to 1px / 1em\r\n        // doesn't work as this gives a negative w/h on some browsers.\r\n        textArea.style.width = '2em';\r\n        textArea.style.height = '2em';\r\n        // We don't need padding, reducing the size if it does flash render.\r\n        textArea.style.padding = '0';\r\n        // Clean up any borders.\r\n        textArea.style.border = 'none';\r\n        textArea.style.outline = 'none';\r\n        textArea.style.boxShadow = 'none';\r\n        // Avoid flash of white box if rendered for any reason.\r\n        textArea.style.background = 'transparent';\r\n    };\r\n    Clipboard.convertBrToNewLine = function (text) {\r\n        var brRegex = /<br\\s*[\\/]?>/gi;\r\n        text = text.replace(brRegex, \"\\n\");\r\n        return text;\r\n    };\r\n    return Clipboard;\r\n}());\r\nvar StorageType;\r\n(function (StorageType) {\r\n    StorageType[\"MEMORY\"] = \"memory\";\r\n    StorageType[\"SESSION\"] = \"session\";\r\n    StorageType[\"LOCAL\"] = \"local\";\r\n})(StorageType || (StorageType = {}));\r\nvar JSONLDResource = /** @class */ (function () {\r\n    function JSONLDResource(jsonld) {\r\n        this.__jsonld = jsonld;\r\n        this.context = this.getProperty(\"context\");\r\n        this.id = this.getProperty(\"id\");\r\n    }\r\n    JSONLDResource.prototype.getProperty = function (name) {\r\n        var prop = null;\r\n        if (this.__jsonld) {\r\n            prop = this.__jsonld[name];\r\n            if (!prop) {\r\n                // property may have a prepended '@'\r\n                prop = this.__jsonld[\"@\" + name];\r\n            }\r\n        }\r\n        return prop;\r\n    };\r\n    return JSONLDResource;\r\n}());\r\nfunction unwrapExports(x) {\r\n    return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\r\n}\r\nfunction createCommonjsModule(fn, module) {\r\n    return module = { exports: {} }, fn(module, module.exports), module.exports;\r\n}\r\nfunction getCjsExportFromNamespace(n) {\r\n    return n && n['default'] || n;\r\n}\r\nvar distCommonjs = createCommonjsModule(function (module, exports) {\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    var AnnotationMotivation;\r\n    (function (AnnotationMotivation) {\r\n        AnnotationMotivation[\"BOOKMARKING\"] = \"oa:bookmarking\";\r\n        AnnotationMotivation[\"CLASSIFYING\"] = \"oa:classifying\";\r\n        AnnotationMotivation[\"COMMENTING\"] = \"oa:commenting\";\r\n        AnnotationMotivation[\"DESCRIBING\"] = \"oa:describing\";\r\n        AnnotationMotivation[\"EDITING\"] = \"oa:editing\";\r\n        AnnotationMotivation[\"HIGHLIGHTING\"] = \"oa:highlighting\";\r\n        AnnotationMotivation[\"IDENTIFYING\"] = \"oa:identifying\";\r\n        AnnotationMotivation[\"LINKING\"] = \"oa:linking\";\r\n        AnnotationMotivation[\"MODERATING\"] = \"oa:moderating\";\r\n        AnnotationMotivation[\"PAINTING\"] = \"sc:painting\";\r\n        AnnotationMotivation[\"QUESTIONING\"] = \"oa:questioning\";\r\n        AnnotationMotivation[\"REPLYING\"] = \"oa:replying\";\r\n        AnnotationMotivation[\"TAGGING\"] = \"oa:tagging\";\r\n        AnnotationMotivation[\"TRANSCRIBING\"] = \"oad:transcribing\";\r\n    })(AnnotationMotivation = exports.AnnotationMotivation || (exports.AnnotationMotivation = {}));\r\n    var Behavior;\r\n    (function (Behavior) {\r\n        Behavior[\"AUTO_ADVANCE\"] = \"auto-advance\";\r\n        Behavior[\"CONTINUOUS\"] = \"continuous\";\r\n        Behavior[\"FACING_PAGES\"] = \"facing-pages\";\r\n        Behavior[\"HIDDEN\"] = \"hidden\";\r\n        Behavior[\"INDIVIDUALS\"] = \"individuals\";\r\n        Behavior[\"MULTI_PART\"] = \"multi-part\";\r\n        Behavior[\"NO_NAV\"] = \"no-nav\";\r\n        Behavior[\"NON_PAGED\"] = \"non-paged\";\r\n        Behavior[\"PAGED\"] = \"paged\";\r\n        Behavior[\"REPEAT\"] = \"repeat\";\r\n        Behavior[\"SEQUENCE\"] = \"sequence\";\r\n        Behavior[\"THUMBNAIL_NAV\"] = \"thumbnail-nav\";\r\n        Behavior[\"TOGETHER\"] = \"together\";\r\n        Behavior[\"UNORDERED\"] = \"unordered\";\r\n    })(Behavior = exports.Behavior || (exports.Behavior = {}));\r\n    var ExternalResourceType;\r\n    (function (ExternalResourceType) {\r\n        ExternalResourceType[\"CANVAS\"] = \"canvas\";\r\n        ExternalResourceType[\"CHOICE\"] = \"choice\";\r\n        ExternalResourceType[\"CONTENT_AS_TEXT\"] = \"contentastext\";\r\n        ExternalResourceType[\"DATASET\"] = \"dataset\";\r\n        ExternalResourceType[\"DOCUMENT\"] = \"document\";\r\n        ExternalResourceType[\"IMAGE\"] = \"image\";\r\n        ExternalResourceType[\"MODEL\"] = \"model\";\r\n        ExternalResourceType[\"MOVING_IMAGE\"] = \"movingimage\";\r\n        ExternalResourceType[\"PDF\"] = \"pdf\";\r\n        ExternalResourceType[\"PHYSICAL_OBJECT\"] = \"physicalobject\";\r\n        ExternalResourceType[\"SOUND\"] = \"sound\";\r\n        ExternalResourceType[\"TEXT\"] = \"text\";\r\n        ExternalResourceType[\"TEXTUALBODY\"] = \"textualbody\";\r\n        ExternalResourceType[\"VIDEO\"] = \"video\";\r\n    })(ExternalResourceType = exports.ExternalResourceType || (exports.ExternalResourceType = {}));\r\n    var IIIFResourceType;\r\n    (function (IIIFResourceType) {\r\n        IIIFResourceType[\"ANNOTATION\"] = \"annotation\";\r\n        IIIFResourceType[\"CANVAS\"] = \"canvas\";\r\n        IIIFResourceType[\"COLLECTION\"] = \"collection\";\r\n        IIIFResourceType[\"MANIFEST\"] = \"manifest\";\r\n        IIIFResourceType[\"RANGE\"] = \"range\";\r\n        IIIFResourceType[\"SEQUENCE\"] = \"sequence\";\r\n    })(IIIFResourceType = exports.IIIFResourceType || (exports.IIIFResourceType = {}));\r\n    var MediaType;\r\n    (function (MediaType) {\r\n        MediaType[\"AUDIO_MP4\"] = \"audio/mp4\";\r\n        MediaType[\"CORTO\"] = \"application/corto\";\r\n        MediaType[\"DRACO\"] = \"application/draco\";\r\n        MediaType[\"EPUB\"] = \"application/epub+zip\";\r\n        MediaType[\"GLB\"] = \"model/gltf-binary\";\r\n        MediaType[\"GLTF\"] = \"model/gltf+json\";\r\n        MediaType[\"JPG\"] = \"image/jpeg\";\r\n        MediaType[\"M3U8\"] = \"application/vnd.apple.mpegurl\";\r\n        MediaType[\"MP3\"] = \"audio/mp3\";\r\n        MediaType[\"MPEG_DASH\"] = \"application/dash+xml\";\r\n        MediaType[\"OBJ\"] = \"text/plain\";\r\n        MediaType[\"OPF\"] = \"application/oebps-package+xml\";\r\n        MediaType[\"PDF\"] = \"application/pdf\";\r\n        MediaType[\"PLY\"] = \"application/ply\";\r\n        MediaType[\"THREEJS\"] = \"application/vnd.threejs+json\";\r\n        MediaType[\"USDZ\"] = \"model/vnd.usd+zip\";\r\n        MediaType[\"VIDEO_MP4\"] = \"video/mp4\";\r\n        MediaType[\"WEBM\"] = \"video/webm\";\r\n    })(MediaType = exports.MediaType || (exports.MediaType = {}));\r\n    var RenderingFormat;\r\n    (function (RenderingFormat) {\r\n        RenderingFormat[\"DOC\"] = \"application/msword\";\r\n        RenderingFormat[\"DOCX\"] = \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\";\r\n        RenderingFormat[\"PDF\"] = \"application/pdf\";\r\n    })(RenderingFormat = exports.RenderingFormat || (exports.RenderingFormat = {}));\r\n    var ServiceProfile;\r\n    (function (ServiceProfile) {\r\n        // image api\r\n        ServiceProfile[\"IMAGE_0_COMPLIANCE_LEVEL_0\"] = \"http://library.stanford.edu/iiif/image-api/compliance.html#level0\";\r\n        ServiceProfile[\"IMAGE_0_COMPLIANCE_LEVEL_1\"] = \"http://library.stanford.edu/iiif/image-api/compliance.html#level1\";\r\n        ServiceProfile[\"IMAGE_0_COMPLIANCE_LEVEL_2\"] = \"http://library.stanford.edu/iiif/image-api/compliance.html#level2\";\r\n        ServiceProfile[\"IMAGE_0_CONFORMANCE_LEVEL_0\"] = \"http://library.stanford.edu/iiif/image-api/conformance.html#level0\";\r\n        ServiceProfile[\"IMAGE_0_CONFORMANCE_LEVEL_1\"] = \"http://library.stanford.edu/iiif/image-api/conformance.html#level1\";\r\n        ServiceProfile[\"IMAGE_0_CONFORMANCE_LEVEL_2\"] = \"http://library.stanford.edu/iiif/image-api/conformance.html#level2\";\r\n        ServiceProfile[\"IMAGE_1_COMPLIANCE_LEVEL_0\"] = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0\";\r\n        ServiceProfile[\"IMAGE_1_COMPLIANCE_LEVEL_1\"] = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1\";\r\n        ServiceProfile[\"IMAGE_1_COMPLIANCE_LEVEL_2\"] = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2\";\r\n        ServiceProfile[\"IMAGE_1_CONFORMANCE_LEVEL_0\"] = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0\";\r\n        ServiceProfile[\"IMAGE_1_CONFORMANCE_LEVEL_1\"] = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1\";\r\n        ServiceProfile[\"IMAGE_1_CONFORMANCE_LEVEL_2\"] = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2\";\r\n        ServiceProfile[\"IMAGE_1_LEVEL_0\"] = \"http://iiif.io/api/image/1/level0.json\";\r\n        ServiceProfile[\"IMAGE_1_PROFILE_LEVEL_0\"] = \"http://iiif.io/api/image/1/profiles/level0.json\";\r\n        ServiceProfile[\"IMAGE_1_LEVEL_1\"] = \"http://iiif.io/api/image/1/level1.json\";\r\n        ServiceProfile[\"IMAGE_1_PROFILE_LEVEL_1\"] = \"http://iiif.io/api/image/1/profiles/level1.json\";\r\n        ServiceProfile[\"IMAGE_1_LEVEL_2\"] = \"http://iiif.io/api/image/1/level2.json\";\r\n        ServiceProfile[\"IMAGE_1_PROFILE_LEVEL_2\"] = \"http://iiif.io/api/image/1/profiles/level2.json\";\r\n        ServiceProfile[\"IMAGE_2_LEVEL_0\"] = \"http://iiif.io/api/image/2/level0.json\";\r\n        ServiceProfile[\"IMAGE_2_PROFILE_LEVEL_0\"] = \"http://iiif.io/api/image/2/profiles/level0.json\";\r\n        ServiceProfile[\"IMAGE_2_LEVEL_1\"] = \"http://iiif.io/api/image/2/level1.json\";\r\n        ServiceProfile[\"IMAGE_2_PROFILE_LEVEL_1\"] = \"http://iiif.io/api/image/2/profiles/level1.json\";\r\n        ServiceProfile[\"IMAGE_2_LEVEL_2\"] = \"http://iiif.io/api/image/2/level2.json\";\r\n        ServiceProfile[\"IMAGE_2_PROFILE_LEVEL_2\"] = \"http://iiif.io/api/image/2/profiles/level2.json\";\r\n        // auth api\r\n        ServiceProfile[\"AUTH_0_CLICK_THROUGH\"] = \"http://iiif.io/api/auth/0/login/clickthrough\";\r\n        ServiceProfile[\"AUTH_0_LOGIN\"] = \"http://iiif.io/api/auth/0/login\";\r\n        ServiceProfile[\"AUTH_0_LOGOUT\"] = \"http://iiif.io/api/auth/0/logout\";\r\n        ServiceProfile[\"AUTH_0_RESTRICTED\"] = \"http://iiif.io/api/auth/0/login/restricted\";\r\n        ServiceProfile[\"AUTH_0_TOKEN\"] = \"http://iiif.io/api/auth/0/token\";\r\n        ServiceProfile[\"AUTH_1_CLICK_THROUGH\"] = \"http://iiif.io/api/auth/1/clickthrough\";\r\n        ServiceProfile[\"AUTH_1_EXTERNAL\"] = \"http://iiif.io/api/auth/1/external\";\r\n        ServiceProfile[\"AUTH_1_KIOSK\"] = \"http://iiif.io/api/auth/1/kiosk\";\r\n        ServiceProfile[\"AUTH_1_LOGIN\"] = \"http://iiif.io/api/auth/1/login\";\r\n        ServiceProfile[\"AUTH_1_LOGOUT\"] = \"http://iiif.io/api/auth/1/logout\";\r\n        ServiceProfile[\"AUTH_1_PROBE\"] = \"http://iiif.io/api/auth/1/probe\";\r\n        ServiceProfile[\"AUTH_1_TOKEN\"] = \"http://iiif.io/api/auth/1/token\";\r\n        // search api\r\n        ServiceProfile[\"SEARCH_0\"] = \"http://iiif.io/api/search/0/search\";\r\n        ServiceProfile[\"SEARCH_0_AUTO_COMPLETE\"] = \"http://iiif.io/api/search/0/autocomplete\";\r\n        ServiceProfile[\"SEARCH_1\"] = \"http://iiif.io/api/search/1/search\";\r\n        ServiceProfile[\"SEARCH_1_AUTO_COMPLETE\"] = \"http://iiif.io/api/search/1/autocomplete\";\r\n        // extensions\r\n        ServiceProfile[\"TRACKING_EXTENSIONS\"] = \"http://universalviewer.io/tracking-extensions-profile\";\r\n        ServiceProfile[\"UI_EXTENSIONS\"] = \"http://universalviewer.io/ui-extensions-profile\";\r\n        ServiceProfile[\"PRINT_EXTENSIONS\"] = \"http://universalviewer.io/print-extensions-profile\";\r\n        ServiceProfile[\"SHARE_EXTENSIONS\"] = \"http://universalviewer.io/share-extensions-profile\";\r\n        // other\r\n        ServiceProfile[\"OTHER_MANIFESTATIONS\"] = \"http://iiif.io/api/otherManifestations.json\";\r\n        ServiceProfile[\"IXIF\"] = \"http://wellcomelibrary.org/ld/ixif/0/alpha.json\";\r\n    })(ServiceProfile = exports.ServiceProfile || (exports.ServiceProfile = {}));\r\n    var ViewingDirection;\r\n    (function (ViewingDirection) {\r\n        ViewingDirection[\"BOTTOM_TO_TOP\"] = \"bottom-to-top\";\r\n        ViewingDirection[\"LEFT_TO_RIGHT\"] = \"left-to-right\";\r\n        ViewingDirection[\"RIGHT_TO_LEFT\"] = \"right-to-left\";\r\n        ViewingDirection[\"TOP_TO_BOTTOM\"] = \"top-to-bottom\";\r\n    })(ViewingDirection = exports.ViewingDirection || (exports.ViewingDirection = {}));\r\n    var ViewingHint;\r\n    (function (ViewingHint) {\r\n        ViewingHint[\"CONTINUOUS\"] = \"continuous\";\r\n        ViewingHint[\"INDIVIDUALS\"] = \"individuals\";\r\n        ViewingHint[\"NON_PAGED\"] = \"non-paged\";\r\n        ViewingHint[\"PAGED\"] = \"paged\";\r\n        ViewingHint[\"TOP\"] = \"top\";\r\n    })(ViewingHint = exports.ViewingHint || (exports.ViewingHint = {}));\r\n});\r\nunwrapExports(distCommonjs);\r\nvar distCommonjs_2 = distCommonjs.Behavior;\r\nvar distCommonjs_4 = distCommonjs.IIIFResourceType;\r\nvar distCommonjs_7 = distCommonjs.ServiceProfile;\r\nvar distCommonjs_8 = distCommonjs.ViewingDirection;\r\nvar distCommonjs_9 = distCommonjs.ViewingHint;\r\nvar __extends = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar ManifestResource = /** @class */ (function (_super) {\r\n    __extends(ManifestResource, _super);\r\n    function ManifestResource(jsonld, options) {\r\n        var _this = _super.call(this, jsonld) || this;\r\n        _this.options = options;\r\n        return _this;\r\n    }\r\n    ManifestResource.prototype.getIIIFResourceType = function () {\r\n        return Utils.normaliseType(this.getProperty(\"type\"));\r\n    };\r\n    ManifestResource.prototype.getLabel = function () {\r\n        var label = this.getProperty(\"label\");\r\n        if (label) {\r\n            return LanguageMap.parse(label, this.options.locale);\r\n        }\r\n        return [];\r\n    };\r\n    ManifestResource.prototype.getDefaultLabel = function () {\r\n        return LanguageMap.getValue(this.getLabel());\r\n    };\r\n    ManifestResource.prototype.getMetadata = function () {\r\n        var _metadata = this.getProperty(\"metadata\");\r\n        var metadata = [];\r\n        if (!_metadata)\r\n            return metadata;\r\n        for (var i = 0; i < _metadata.length; i++) {\r\n            var item = _metadata[i];\r\n            var metadataItem = new LabelValuePair(this.options.locale);\r\n            metadataItem.parse(item);\r\n            metadata.push(metadataItem);\r\n        }\r\n        return metadata;\r\n    };\r\n    ManifestResource.prototype.getRendering = function (format) {\r\n        var renderings = this.getRenderings();\r\n        for (var i = 0; i < renderings.length; i++) {\r\n            var rendering = renderings[i];\r\n            if (rendering.getFormat() === format) {\r\n                return rendering;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    ManifestResource.prototype.getRenderings = function () {\r\n        var rendering;\r\n        // if passing a manifesto-parsed object, use the __jsonld.rendering property,\r\n        // otherwise look for a rendering property\r\n        if (this.__jsonld) {\r\n            rendering = this.__jsonld.rendering;\r\n        }\r\n        else {\r\n            rendering = this.rendering;\r\n        }\r\n        var renderings = [];\r\n        if (!rendering)\r\n            return renderings;\r\n        // coerce to array\r\n        if (!Array.isArray(rendering)) {\r\n            rendering = [rendering];\r\n        }\r\n        for (var i = 0; i < rendering.length; i++) {\r\n            var r = rendering[i];\r\n            renderings.push(new Rendering(r, this.options));\r\n        }\r\n        return renderings;\r\n    };\r\n    ManifestResource.prototype.getService = function (profile) {\r\n        return Utils.getService(this, profile);\r\n    };\r\n    ManifestResource.prototype.getServices = function () {\r\n        return Utils.getServices(this);\r\n    };\r\n    ManifestResource.prototype.getThumbnail = function () {\r\n        var thumbnail = this.getProperty(\"thumbnail\");\r\n        if (Array.isArray(thumbnail)) {\r\n            thumbnail = thumbnail[0];\r\n        }\r\n        if (thumbnail) {\r\n            return new Thumbnail(thumbnail, this.options);\r\n        }\r\n        return null;\r\n    };\r\n    ManifestResource.prototype.isAnnotation = function () {\r\n        return this.getIIIFResourceType() === distCommonjs_4.ANNOTATION;\r\n    };\r\n    ManifestResource.prototype.isCanvas = function () {\r\n        return this.getIIIFResourceType() === distCommonjs_4.CANVAS;\r\n    };\r\n    ManifestResource.prototype.isCollection = function () {\r\n        return this.getIIIFResourceType() === distCommonjs_4.COLLECTION;\r\n    };\r\n    ManifestResource.prototype.isManifest = function () {\r\n        return this.getIIIFResourceType() === distCommonjs_4.MANIFEST;\r\n    };\r\n    ManifestResource.prototype.isRange = function () {\r\n        return this.getIIIFResourceType() === distCommonjs_4.RANGE;\r\n    };\r\n    ManifestResource.prototype.isSequence = function () {\r\n        return this.getIIIFResourceType() === distCommonjs_4.SEQUENCE;\r\n    };\r\n    return ManifestResource;\r\n}(JSONLDResource));\r\nvar __extends$1 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Resource = /** @class */ (function (_super) {\r\n    __extends$1(Resource, _super);\r\n    function Resource(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    Resource.prototype.getFormat = function () {\r\n        var format = this.getProperty(\"format\");\r\n        if (format) {\r\n            return format.toLowerCase();\r\n        }\r\n        return null;\r\n    };\r\n    Resource.prototype.getResources = function () {\r\n        var resources = [];\r\n        if (!this.__jsonld.resources)\r\n            return resources;\r\n        for (var i = 0; i < this.__jsonld.resources.length; i++) {\r\n            var a = this.__jsonld.resources[i];\r\n            var annotation = new Annotation(a, this.options);\r\n            resources.push(annotation);\r\n        }\r\n        return resources;\r\n    };\r\n    Resource.prototype.getType = function () {\r\n        var type = this.getProperty(\"type\");\r\n        if (type) {\r\n            return Utils.normaliseType(type);\r\n        }\r\n        return null;\r\n    };\r\n    Resource.prototype.getWidth = function () {\r\n        return this.getProperty(\"width\");\r\n    };\r\n    Resource.prototype.getHeight = function () {\r\n        return this.getProperty(\"height\");\r\n    };\r\n    Resource.prototype.getMaxWidth = function () {\r\n        return this.getProperty(\"maxWidth\");\r\n    };\r\n    Resource.prototype.getMaxHeight = function () {\r\n        var maxHeight = this.getProperty(\"maxHeight\");\r\n        // if a maxHeight hasn't been specified, default to maxWidth.\r\n        // maxWidth in essence becomes maxEdge\r\n        if (!maxHeight) {\r\n            return this.getMaxWidth();\r\n        }\r\n        return null;\r\n    };\r\n    return Resource;\r\n}(ManifestResource));\r\nvar __extends$2 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar IIIFResource = /** @class */ (function (_super) {\r\n    __extends$2(IIIFResource, _super);\r\n    function IIIFResource(jsonld, options) {\r\n        var _this = _super.call(this, jsonld, options) || this;\r\n        _this.index = -1;\r\n        _this.isLoaded = false;\r\n        var defaultOptions = {\r\n            defaultLabel: \"-\",\r\n            locale: \"en-GB\",\r\n            resource: _this,\r\n            pessimisticAccessControl: false\r\n        };\r\n        _this.options = Object.assign(defaultOptions, options);\r\n        return _this;\r\n    }\r\n    IIIFResource.prototype.getAttribution = function () {\r\n        //console.warn('getAttribution will be deprecated, use getRequiredStatement instead.');\r\n        var attribution = this.getProperty(\"attribution\");\r\n        if (attribution) {\r\n            return LanguageMap.parse(attribution, this.options.locale);\r\n        }\r\n        return [];\r\n    };\r\n    IIIFResource.prototype.getDescription = function () {\r\n        var description = this.getProperty(\"description\");\r\n        if (description) {\r\n            return LanguageMap.parse(description, this.options.locale);\r\n        }\r\n        return [];\r\n    };\r\n    IIIFResource.prototype.getIIIFResourceType = function () {\r\n        return Utils.normaliseType(this.getProperty(\"type\"));\r\n    };\r\n    IIIFResource.prototype.getLogo = function () {\r\n        var logo = this.getProperty(\"logo\");\r\n        if (!logo)\r\n            return null;\r\n        if (typeof logo === \"string\")\r\n            return logo;\r\n        if (Array.isArray(logo) && logo.length) {\r\n            logo = logo[0];\r\n        }\r\n        return logo[\"@id\"] || logo.id;\r\n    };\r\n    IIIFResource.prototype.getLicense = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"license\"), this.options.locale);\r\n    };\r\n    IIIFResource.prototype.getNavDate = function () {\r\n        return new Date(this.getProperty(\"navDate\"));\r\n    };\r\n    IIIFResource.prototype.getRelated = function () {\r\n        return this.getProperty(\"related\");\r\n    };\r\n    IIIFResource.prototype.getSeeAlso = function () {\r\n        return this.getProperty(\"seeAlso\");\r\n    };\r\n    IIIFResource.prototype.getTrackingLabel = function () {\r\n        var service = (this.getService(distCommonjs_7.TRACKING_EXTENSIONS));\r\n        if (service) {\r\n            return service.getProperty(\"trackingLabel\");\r\n        }\r\n        return \"\";\r\n    };\r\n    IIIFResource.prototype.getDefaultTree = function () {\r\n        this.defaultTree = new TreeNode(\"root\");\r\n        this.defaultTree.data = this;\r\n        return this.defaultTree;\r\n    };\r\n    IIIFResource.prototype.getRequiredStatement = function () {\r\n        var requiredStatement = null;\r\n        var _requiredStatement = this.getProperty(\"requiredStatement\");\r\n        if (_requiredStatement) {\r\n            requiredStatement = new LabelValuePair(this.options.locale);\r\n            requiredStatement.parse(_requiredStatement);\r\n        }\r\n        else {\r\n            // fall back to attribution (if it exists)\r\n            var attribution = this.getAttribution();\r\n            if (attribution) {\r\n                requiredStatement = new LabelValuePair(this.options.locale);\r\n                requiredStatement.value = attribution;\r\n            }\r\n        }\r\n        return requiredStatement;\r\n    };\r\n    IIIFResource.prototype.isCollection = function () {\r\n        if (this.getIIIFResourceType() === distCommonjs_4.COLLECTION) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IIIFResource.prototype.isManifest = function () {\r\n        if (this.getIIIFResourceType() === distCommonjs_4.MANIFEST) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    IIIFResource.prototype.load = function () {\r\n        var that = this;\r\n        return new Promise(function (resolve) {\r\n            if (that.isLoaded) {\r\n                resolve(that);\r\n            }\r\n            else {\r\n                var options_1 = that.options;\r\n                options_1.navDate = that.getNavDate();\r\n                var id = that.__jsonld.id;\r\n                if (!id) {\r\n                    id = that.__jsonld[\"@id\"];\r\n                }\r\n                Utils.loadManifest(id).then(function (data) {\r\n                    that.parentLabel = (LanguageMap.getValue(that.getLabel(), options_1.locale));\r\n                    var parsed = Deserialiser.parse(data, options_1);\r\n                    that = Object.assign(that, parsed);\r\n                    //that.parentCollection = options.resource.parentCollection;\r\n                    that.index = options_1.index;\r\n                    resolve(that);\r\n                });\r\n            }\r\n        });\r\n    };\r\n    return IIIFResource;\r\n}(ManifestResource));\r\nvar __extends$3 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Annotation = /** @class */ (function (_super) {\r\n    __extends$3(Annotation, _super);\r\n    function Annotation(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    Annotation.prototype.getBody = function () {\r\n        var bodies = [];\r\n        var body = this.getProperty(\"body\");\r\n        // todo: make this a generic \"property that can be an object or array enumerator\" util\r\n        if (body) {\r\n            if (Array.isArray(body)) {\r\n                for (var i = 0; i < body.length; i++) {\r\n                    var b = body[i];\r\n                    if (b.items) {\r\n                        for (var i_1 = 0; i_1 < b.items.length; i_1++) {\r\n                            // todo: don't ignore that it's a choice. maybe add isChoice() to IAnnotationBody?\r\n                            var c = b.items[i_1];\r\n                            bodies.push(new AnnotationBody(c, this.options));\r\n                        }\r\n                    }\r\n                    else {\r\n                        bodies.push(new AnnotationBody(b, this.options));\r\n                    }\r\n                }\r\n            }\r\n            else if (body.items) {\r\n                for (var i = 0; i < body.items.length; i++) {\r\n                    var b = body.items[i];\r\n                    bodies.push(new AnnotationBody(b, this.options));\r\n                }\r\n            }\r\n            else {\r\n                bodies.push(new AnnotationBody(body, this.options));\r\n            }\r\n        }\r\n        return bodies;\r\n    };\r\n    Annotation.prototype.getMotivation = function () {\r\n        var motivation = this.getProperty(\"motivation\");\r\n        if (motivation) {\r\n            //const key: string | undefined = Object.keys(AnnotationMotivationEnum).find(k => AnnotationMotivationEnum[k] === motivation);\r\n            return motivation;\r\n        }\r\n        return null;\r\n    };\r\n    // open annotation\r\n    Annotation.prototype.getOn = function () {\r\n        return this.getProperty(\"on\");\r\n    };\r\n    Annotation.prototype.getTarget = function () {\r\n        return this.getProperty(\"target\");\r\n    };\r\n    Annotation.prototype.getResource = function () {\r\n        return new Resource(this.getProperty(\"resource\"), this.options);\r\n    };\r\n    return Annotation;\r\n}(ManifestResource));\r\nvar __extends$4 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar AnnotationBody = /** @class */ (function (_super) {\r\n    __extends$4(AnnotationBody, _super);\r\n    function AnnotationBody(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    AnnotationBody.prototype.getFormat = function () {\r\n        var format = this.getProperty(\"format\");\r\n        if (format) {\r\n            return Utils.getMediaType(format);\r\n        }\r\n        return null;\r\n    };\r\n    AnnotationBody.prototype.getType = function () {\r\n        var type = this.getProperty(\"type\");\r\n        if (type) {\r\n            return (Utils.normaliseType(this.getProperty(\"type\")));\r\n        }\r\n        return null;\r\n    };\r\n    AnnotationBody.prototype.getWidth = function () {\r\n        return this.getProperty(\"width\");\r\n    };\r\n    AnnotationBody.prototype.getHeight = function () {\r\n        return this.getProperty(\"height\");\r\n    };\r\n    return AnnotationBody;\r\n}(ManifestResource));\r\nvar __extends$5 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar AnnotationList = /** @class */ (function (_super) {\r\n    __extends$5(AnnotationList, _super);\r\n    function AnnotationList(label, jsonld, options) {\r\n        var _this = _super.call(this, jsonld) || this;\r\n        _this.label = label;\r\n        _this.options = options;\r\n        return _this;\r\n    }\r\n    AnnotationList.prototype.getIIIFResourceType = function () {\r\n        return Utils.normaliseType(this.getProperty(\"type\"));\r\n    };\r\n    AnnotationList.prototype.getLabel = function () {\r\n        return this.label;\r\n    };\r\n    AnnotationList.prototype.getResources = function () {\r\n        var _this = this;\r\n        var resources = this.getProperty(\"resources\");\r\n        return resources.map(function (resource) { return new Annotation(resource, _this.options); });\r\n    };\r\n    AnnotationList.prototype.load = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (_this.isLoaded) {\r\n                resolve(_this);\r\n            }\r\n            else {\r\n                var id = _this.__jsonld.id;\r\n                if (!id) {\r\n                    id = _this.__jsonld[\"@id\"];\r\n                }\r\n                Utils.loadManifest(id)\r\n                    .then(function (data) {\r\n                    _this.__jsonld = data;\r\n                    _this.context = _this.getProperty(\"context\");\r\n                    _this.id = _this.getProperty(\"id\");\r\n                    _this.isLoaded = true;\r\n                    resolve(_this);\r\n                })\r\n                    .catch(reject);\r\n            }\r\n        });\r\n    };\r\n    return AnnotationList;\r\n}(JSONLDResource));\r\nvar __extends$6 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar AnnotationPage = /** @class */ (function (_super) {\r\n    __extends$6(AnnotationPage, _super);\r\n    function AnnotationPage(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    AnnotationPage.prototype.getItems = function () {\r\n        return this.getProperty(\"items\");\r\n    };\r\n    return AnnotationPage;\r\n}(ManifestResource));\r\nvar __extends$7 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Canvas = /** @class */ (function (_super) {\r\n    __extends$7(Canvas, _super);\r\n    function Canvas(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    // http://iiif.io/api/image/2.1/#canonical-uri-syntax\r\n    Canvas.prototype.getCanonicalImageUri = function (w) {\r\n        var id = null;\r\n        var region = \"full\";\r\n        var rotation = 0;\r\n        var quality = \"default\";\r\n        var width = w;\r\n        var size;\r\n        // if an info.json has been loaded\r\n        if (this.externalResource &&\r\n            this.externalResource.data &&\r\n            this.externalResource.data[\"@id\"]) {\r\n            id = this.externalResource.data[\"@id\"];\r\n            if (!width) {\r\n                width = this.externalResource.data.width;\r\n            }\r\n            if (this.externalResource.data[\"@context\"]) {\r\n                if (this.externalResource.data[\"@context\"].indexOf(\"/1.0/context.json\") >\r\n                    -1 ||\r\n                    this.externalResource.data[\"@context\"].indexOf(\"/1.1/context.json\") >\r\n                        -1 ||\r\n                    this.externalResource.data[\"@context\"].indexOf(\"/1/context.json\") > -1) {\r\n                    quality = \"native\";\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // info.json hasn't been loaded yet\r\n            var images = this.getImages();\r\n            if (images && images.length) {\r\n                var firstImage = images[0];\r\n                var resource = firstImage.getResource();\r\n                var services = resource.getServices();\r\n                if (!width) {\r\n                    width = resource.getWidth();\r\n                }\r\n                if (services.length) {\r\n                    var service = services[0];\r\n                    id = service.id;\r\n                    quality = Utils.getImageQuality(service.getProfile());\r\n                }\r\n                else if (width === resource.getWidth()) {\r\n                    // if the passed width is the same as the resource width\r\n                    // i.e. not looking for a thumbnail\r\n                    // return the full size image.\r\n                    // used for download options when loading static images.\r\n                    return resource.id;\r\n                }\r\n            }\r\n            // todo: should this be moved to getThumbUri?\r\n            if (!id) {\r\n                var thumbnail = this.getProperty(\"thumbnail\");\r\n                if (thumbnail) {\r\n                    if (typeof thumbnail === \"string\") {\r\n                        return thumbnail;\r\n                    }\r\n                    else {\r\n                        if (thumbnail[\"@id\"]) {\r\n                            return thumbnail[\"@id\"];\r\n                        }\r\n                        else if (thumbnail.length) {\r\n                            return thumbnail[0].id;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        size = width + \",\";\r\n        // trim off trailing '/'\r\n        if (id && id.endsWith(\"/\")) {\r\n            id = id.substr(0, id.length - 1);\r\n        }\r\n        var uri = [id, region, size, rotation, quality + \".jpg\"].join(\"/\");\r\n        return uri;\r\n    };\r\n    Canvas.prototype.getMaxDimensions = function () {\r\n        var maxDimensions = null;\r\n        var profile;\r\n        if (this.externalResource &&\r\n            this.externalResource.data &&\r\n            this.externalResource.data.profile) {\r\n            profile = this.externalResource.data.profile;\r\n            if (Array.isArray(profile)) {\r\n                profile = profile.filter(function (p) { return p[\"maxWidth\"]; })[0];\r\n                if (profile) {\r\n                    maxDimensions = new Size(profile.maxWidth, profile.maxHeight ? profile.maxHeight : profile.maxWidth);\r\n                }\r\n            }\r\n        }\r\n        return maxDimensions;\r\n    };\r\n    // Presentation API 3.0\r\n    Canvas.prototype.getContent = function () {\r\n        var content = [];\r\n        var items = this.__jsonld.items || this.__jsonld.content;\r\n        if (!items)\r\n            return content;\r\n        // should be contained in an AnnotationPage\r\n        var annotationPage = null;\r\n        if (items.length) {\r\n            annotationPage = new AnnotationPage(items[0], this.options);\r\n        }\r\n        if (!annotationPage) {\r\n            return content;\r\n        }\r\n        var annotations = annotationPage.getItems();\r\n        for (var i = 0; i < annotations.length; i++) {\r\n            var a = annotations[i];\r\n            var annotation = new Annotation(a, this.options);\r\n            content.push(annotation);\r\n        }\r\n        return content;\r\n    };\r\n    Canvas.prototype.getDuration = function () {\r\n        return this.getProperty(\"duration\");\r\n    };\r\n    Canvas.prototype.getImages = function () {\r\n        var images = [];\r\n        if (!this.__jsonld.images)\r\n            return images;\r\n        for (var i = 0; i < this.__jsonld.images.length; i++) {\r\n            var a = this.__jsonld.images[i];\r\n            var annotation = new Annotation(a, this.options);\r\n            images.push(annotation);\r\n        }\r\n        return images;\r\n    };\r\n    Canvas.prototype.getIndex = function () {\r\n        return this.getProperty(\"index\");\r\n    };\r\n    Canvas.prototype.getOtherContent = function () {\r\n        var _this = this;\r\n        var otherContent = Array.isArray(this.getProperty(\"otherContent\"))\r\n            ? this.getProperty(\"otherContent\")\r\n            : [this.getProperty(\"otherContent\")];\r\n        var canonicalComparison = function (typeA, typeB) {\r\n            if (typeof typeA !== \"string\" || typeof typeB !== \"string\") {\r\n                return false;\r\n            }\r\n            return typeA.toLowerCase() === typeA.toLowerCase();\r\n        };\r\n        var otherPromises = otherContent\r\n            .filter(function (otherContent) {\r\n            return otherContent &&\r\n                canonicalComparison(otherContent[\"@type\"], \"sc:AnnotationList\");\r\n        })\r\n            .map(function (annotationList, i) {\r\n            return new AnnotationList(annotationList[\"label\"] || \"Annotation list \" + i, annotationList, _this.options);\r\n        })\r\n            .map(function (annotationList) { return annotationList.load(); });\r\n        return Promise.all(otherPromises);\r\n    };\r\n    // Prefer thumbnail service to image service if supplied and if\r\n    // the thumbnail service can provide a satisfactory size +/- x pixels.\r\n    // this is used to get thumb URIs *before* the info.json has been requested\r\n    // and populate thumbnails in a viewer.\r\n    // the publisher may also provide pre-computed fixed-size thumbs for better performance.\r\n    //getThumbUri(width: number): string {\r\n    //\r\n    //    var uri;\r\n    //    var images: IAnnotation[] = this.getImages();\r\n    //\r\n    //    if (images && images.length) {\r\n    //        var firstImage = images[0];\r\n    //        var resource: IResource = firstImage.getResource();\r\n    //        var services: IService[] = resource.getServices();\r\n    //\r\n    //        for (let i = 0; i < services.length; i++) {\r\n    //            var service: IService = services[i];\r\n    //            var id = service.id;\r\n    //\r\n    //            if (!_endsWith(id, '/')) {\r\n    //                id += '/';\r\n    //            }\r\n    //\r\n    //            uri = id + 'full/' + width + ',/0/' + Utils.getImageQuality(service.getProfile()) + '.jpg';\r\n    //        }\r\n    //    }\r\n    //\r\n    //    return uri;\r\n    //}\r\n    //getType(): CanvasType {\r\n    //    return new CanvasType(this.getProperty('@type').toLowerCase());\r\n    //}\r\n    Canvas.prototype.getWidth = function () {\r\n        return this.getProperty(\"width\");\r\n    };\r\n    Canvas.prototype.getHeight = function () {\r\n        return this.getProperty(\"height\");\r\n    };\r\n    return Canvas;\r\n}(Resource));\r\nvar __extends$8 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Collection = /** @class */ (function (_super) {\r\n    __extends$8(Collection, _super);\r\n    function Collection(jsonld, options) {\r\n        var _this = _super.call(this, jsonld, options) || this;\r\n        _this.items = [];\r\n        _this._collections = null;\r\n        _this._manifests = null;\r\n        jsonld.__collection = _this;\r\n        return _this;\r\n    }\r\n    Collection.prototype.getCollections = function () {\r\n        if (this._collections) {\r\n            return this._collections;\r\n        }\r\n        return (this._collections = (this.items.filter(function (m) { return m.isCollection(); })));\r\n    };\r\n    Collection.prototype.getManifests = function () {\r\n        if (this._manifests) {\r\n            return this._manifests;\r\n        }\r\n        return (this._manifests = (this.items.filter(function (m) { return m.isManifest(); })));\r\n    };\r\n    Collection.prototype.getCollectionByIndex = function (collectionIndex) {\r\n        var collections = this.getCollections();\r\n        var collection;\r\n        for (var i = 0; i < collections.length; i++) {\r\n            var c = collections[i];\r\n            if (c.index === collectionIndex) {\r\n                collection = c;\r\n            }\r\n        }\r\n        if (collection) {\r\n            collection.options.index = collectionIndex;\r\n            // id for collection MUST be dereferenceable\r\n            return collection.load();\r\n        }\r\n        else {\r\n            throw new Error(\"Collection index not found\");\r\n        }\r\n    };\r\n    Collection.prototype.getManifestByIndex = function (manifestIndex) {\r\n        var manifests = this.getManifests();\r\n        var manifest;\r\n        for (var i = 0; i < manifests.length; i++) {\r\n            var m = manifests[i];\r\n            if (m.index === manifestIndex) {\r\n                manifest = m;\r\n            }\r\n        }\r\n        if (manifest) {\r\n            manifest.options.index = manifestIndex;\r\n            return manifest.load();\r\n        }\r\n        else {\r\n            throw new Error(\"Manifest index not found\");\r\n        }\r\n    };\r\n    Collection.prototype.getTotalCollections = function () {\r\n        return this.getCollections().length;\r\n    };\r\n    Collection.prototype.getTotalManifests = function () {\r\n        return this.getManifests().length;\r\n    };\r\n    Collection.prototype.getTotalItems = function () {\r\n        return this.items.length;\r\n    };\r\n    Collection.prototype.getViewingDirection = function () {\r\n        if (this.getProperty(\"viewingDirection\")) {\r\n            return this.getProperty(\"viewingDirection\");\r\n        }\r\n        return distCommonjs_8.LEFT_TO_RIGHT;\r\n    };\r\n    /**\r\n     * Get a tree of sub collections and manifests, using each child manifest's first 'top' range.\r\n     */\r\n    Collection.prototype.getDefaultTree = function () {\r\n        _super.prototype.getDefaultTree.call(this);\r\n        //console.log(\"get default tree for \", this.id);\r\n        this.defaultTree.data.type = Utils.normaliseType(TreeNodeType.COLLECTION);\r\n        this._parseManifests(this);\r\n        this._parseCollections(this);\r\n        Utils.generateTreeNodeIds(this.defaultTree);\r\n        return this.defaultTree;\r\n    };\r\n    Collection.prototype._parseManifests = function (parentCollection) {\r\n        if (parentCollection.getManifests() &&\r\n            parentCollection.getManifests().length) {\r\n            for (var i = 0; i < parentCollection.getManifests().length; i++) {\r\n                var manifest = parentCollection.getManifests()[i];\r\n                var tree = manifest.getDefaultTree();\r\n                tree.label =\r\n                    manifest.parentLabel ||\r\n                        LanguageMap.getValue(manifest.getLabel(), this.options.locale) ||\r\n                        \"manifest \" + (i + 1);\r\n                tree.navDate = manifest.getNavDate();\r\n                tree.data.id = manifest.id;\r\n                tree.data.type = Utils.normaliseType(TreeNodeType.MANIFEST);\r\n                parentCollection.defaultTree.addNode(tree);\r\n            }\r\n        }\r\n    };\r\n    Collection.prototype._parseCollections = function (parentCollection) {\r\n        //console.log(\"parse collections for \", parentCollection.id);\r\n        if (parentCollection.getCollections() &&\r\n            parentCollection.getCollections().length) {\r\n            for (var i = 0; i < parentCollection.getCollections().length; i++) {\r\n                var collection = parentCollection.getCollections()[i];\r\n                var tree = collection.getDefaultTree();\r\n                tree.label =\r\n                    collection.parentLabel ||\r\n                        LanguageMap.getValue(collection.getLabel(), this.options.locale) ||\r\n                        \"collection \" + (i + 1);\r\n                tree.navDate = collection.getNavDate();\r\n                tree.data.id = collection.id;\r\n                tree.data.type = Utils.normaliseType(TreeNodeType.COLLECTION);\r\n                parentCollection.defaultTree.addNode(tree);\r\n            }\r\n        }\r\n    };\r\n    return Collection;\r\n}(IIIFResource));\r\nvar Duration = /** @class */ (function () {\r\n    function Duration(start, end) {\r\n        this.start = start;\r\n        this.end = end;\r\n    }\r\n    Duration.prototype.getLength = function () {\r\n        return this.end - this.start;\r\n    };\r\n    return Duration;\r\n}());\r\nvar LabelValuePair = /** @class */ (function () {\r\n    function LabelValuePair(defaultLocale) {\r\n        this.defaultLocale = defaultLocale;\r\n    }\r\n    LabelValuePair.prototype.parse = function (resource) {\r\n        this.resource = resource;\r\n        this.label = LanguageMap.parse(this.resource.label, this.defaultLocale);\r\n        this.value = LanguageMap.parse(this.resource.value, this.defaultLocale);\r\n    };\r\n    // shortcuts to get/set values based on default locale\r\n    LabelValuePair.prototype.getLabel = function () {\r\n        if (this.label) {\r\n            return LanguageMap.getValue(this.label, this.defaultLocale);\r\n        }\r\n        return null;\r\n    };\r\n    LabelValuePair.prototype.setLabel = function (value) {\r\n        var _this = this;\r\n        if (this.label && this.label.length) {\r\n            var t = this.label.filter(function (x) {\r\n                return x.locale === _this.defaultLocale ||\r\n                    x.locale === Utils.getInexactLocale(_this.defaultLocale);\r\n            })[0];\r\n            if (t)\r\n                t.value = value;\r\n        }\r\n    };\r\n    LabelValuePair.prototype.getValue = function () {\r\n        if (this.value) {\r\n            var locale = this.defaultLocale;\r\n            // if the label has a locale, prefer that to the default locale\r\n            if (this.label && this.label.length && this.label[0].locale) {\r\n                locale = this.label[0].locale;\r\n            }\r\n            return LanguageMap.getValue(this.value, locale);\r\n        }\r\n        return null;\r\n    };\r\n    LabelValuePair.prototype.setValue = function (value) {\r\n        var _this = this;\r\n        if (this.value && this.value.length) {\r\n            var t = this.value.filter(function (x) {\r\n                return x.locale === _this.defaultLocale ||\r\n                    x.locale === Utils.getInexactLocale(_this.defaultLocale);\r\n            })[0];\r\n            if (t)\r\n                t.value = value;\r\n        }\r\n    };\r\n    return LabelValuePair;\r\n}());\r\nvar Language = /** @class */ (function () {\r\n    function Language(value, locale) {\r\n        if (Array.isArray(value)) {\r\n            if (value.length === 1) {\r\n                this.value = value[0];\r\n            }\r\n            else {\r\n                // concatenate all of the values\r\n                this.value = value.join(\"<br/>\");\r\n            }\r\n        }\r\n        else {\r\n            this.value = value;\r\n        }\r\n        this.locale = locale;\r\n    }\r\n    return Language;\r\n}());\r\nvar __extends$9 = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar LanguageMap = /** @class */ (function (_super) {\r\n    __extends$9(LanguageMap, _super);\r\n    function LanguageMap() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    LanguageMap.parse = function (language, defaultLocale) {\r\n        var tc = [];\r\n        var t;\r\n        if (!language) {\r\n            return tc;\r\n        }\r\n        else if (Array.isArray(language)) {\r\n            for (var i = 0; i < language.length; i++) {\r\n                var value = language[i];\r\n                if (typeof value === \"string\") {\r\n                    t = new Language(value, defaultLocale);\r\n                }\r\n                else {\r\n                    t = new Language(value[\"@value\"], value[\"@language\"] || defaultLocale);\r\n                }\r\n                tc.push(t);\r\n            }\r\n        }\r\n        else if (typeof language === \"string\") {\r\n            // if it's just a single string value, create one language in the configured locale\r\n            t = new Language(language, defaultLocale);\r\n            tc.push(t);\r\n            return tc;\r\n        }\r\n        else {\r\n            // it's an object\r\n            if (language[\"@value\"]) {\r\n                // presentation 2\r\n                t = new Language(language[\"@value\"], language[\"@language\"] || defaultLocale);\r\n                tc.push(t);\r\n            }\r\n            else {\r\n                // presentation 3\r\n                Object.keys(language).forEach(function (key) {\r\n                    // todo: support multiple values in array\r\n                    if (language[key].length) {\r\n                        t = new Language(language[key], key);\r\n                        tc.push(t);\r\n                    }\r\n                    else {\r\n                        throw new Error(\"language must have a value\");\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return tc;\r\n    };\r\n    LanguageMap.getValue = function (languageCollection, locale) {\r\n        if (languageCollection.length) {\r\n            if (locale) {\r\n                var language = languageCollection.filter(function (t) {\r\n                    return t.locale === locale ||\r\n                        Utils.getInexactLocale(t.locale) === Utils.getInexactLocale(locale);\r\n                })[0];\r\n                if (language) {\r\n                    return language.value;\r\n                }\r\n            }\r\n            // return the first value\r\n            return languageCollection[0].value;\r\n        }\r\n        return null;\r\n    };\r\n    return LanguageMap;\r\n}(Array));\r\nvar __extends$a = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Manifest = /** @class */ (function (_super) {\r\n    __extends$a(Manifest, _super);\r\n    function Manifest(jsonld, options) {\r\n        var _this = _super.call(this, jsonld, options) || this;\r\n        _this.index = 0;\r\n        _this._allRanges = null;\r\n        _this.items = [];\r\n        _this._topRanges = [];\r\n        if (_this.__jsonld.structures && _this.__jsonld.structures.length) {\r\n            var topRanges = _this._getTopRanges();\r\n            for (var i = 0; i < topRanges.length; i++) {\r\n                var range = topRanges[i];\r\n                _this._parseRanges(range, String(i));\r\n            }\r\n        }\r\n        return _this;\r\n    }\r\n    Manifest.prototype.getPosterCanvas = function () {\r\n        var posterCanvas = this.getProperty(\"posterCanvas\");\r\n        if (posterCanvas) {\r\n            posterCanvas = new Canvas(posterCanvas, this.options);\r\n        }\r\n        return posterCanvas;\r\n    };\r\n    Manifest.prototype.getBehavior = function () {\r\n        var behavior = this.getProperty(\"behavior\");\r\n        if (Array.isArray(behavior)) {\r\n            behavior = behavior[0];\r\n        }\r\n        if (behavior) {\r\n            return behavior;\r\n        }\r\n        return null;\r\n    };\r\n    Manifest.prototype.getDefaultTree = function () {\r\n        _super.prototype.getDefaultTree.call(this);\r\n        this.defaultTree.data.type = Utils.normaliseType(TreeNodeType.MANIFEST);\r\n        if (!this.isLoaded) {\r\n            return this.defaultTree;\r\n        }\r\n        var topRanges = this.getTopRanges();\r\n        // if there are any ranges in the manifest, default to the first 'top' range or generated placeholder\r\n        if (topRanges.length) {\r\n            topRanges[0].getTree(this.defaultTree);\r\n        }\r\n        Utils.generateTreeNodeIds(this.defaultTree);\r\n        return this.defaultTree;\r\n    };\r\n    Manifest.prototype._getTopRanges = function () {\r\n        var topRanges = [];\r\n        if (this.__jsonld.structures && this.__jsonld.structures.length) {\r\n            for (var i = 0; i < this.__jsonld.structures.length; i++) {\r\n                var json = this.__jsonld.structures[i];\r\n                if (json.viewingHint === distCommonjs_9.TOP) {\r\n                    topRanges.push(json);\r\n                }\r\n            }\r\n            // if no viewingHint=\"top\" range was found, create a default one\r\n            if (!topRanges.length) {\r\n                var range = {};\r\n                range.ranges = this.__jsonld.structures;\r\n                topRanges.push(range);\r\n            }\r\n        }\r\n        return topRanges;\r\n    };\r\n    Manifest.prototype.getTopRanges = function () {\r\n        return this._topRanges;\r\n    };\r\n    Manifest.prototype._getRangeById = function (id) {\r\n        if (this.__jsonld.structures && this.__jsonld.structures.length) {\r\n            for (var i = 0; i < this.__jsonld.structures.length; i++) {\r\n                var r = this.__jsonld.structures[i];\r\n                if (r[\"@id\"] === id || r.id === id) {\r\n                    return r;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    //private _parseRangeCanvas(json: any, range: Range): void {\r\n    // todo: currently this isn't needed\r\n    //var canvas: IJSONLDResource = new JSONLDResource(json);\r\n    //range.items.push(<IManifestResource>canvas);\r\n    //}\r\n    Manifest.prototype._parseRanges = function (r, path, parentRange) {\r\n        var range;\r\n        var id = null;\r\n        if (typeof r === \"string\") {\r\n            id = r;\r\n            r = this._getRangeById(id);\r\n        }\r\n        if (!r) {\r\n            console.warn(\"Range:\", id, \"does not exist\");\r\n            return;\r\n        }\r\n        range = new Range(r, this.options);\r\n        range.parentRange = parentRange;\r\n        range.path = path;\r\n        if (!parentRange) {\r\n            this._topRanges.push(range);\r\n        }\r\n        else {\r\n            parentRange.items.push(range);\r\n        }\r\n        var items = r.items || r.members;\r\n        if (items) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                var item = items[i];\r\n                // todo: use an ItemType constant?\r\n                if ((item[\"@type\"] && item[\"@type\"].toLowerCase() === \"sc:range\") ||\r\n                    (item[\"type\"] && item[\"type\"].toLowerCase() === \"range\")) {\r\n                    this._parseRanges(item, path + \"/\" + i, range);\r\n                }\r\n                else if ((item[\"@type\"] && item[\"@type\"].toLowerCase() === \"sc:canvas\") ||\r\n                    (item[\"type\"] && item[\"type\"].toLowerCase() === \"canvas\")) {\r\n                    // store the ids on the __jsonld object to be used by Range.getCanvasIds()\r\n                    if (!range.canvases) {\r\n                        range.canvases = [];\r\n                    }\r\n                    var id_1 = item.id || item[\"@id\"];\r\n                    range.canvases.push(id_1);\r\n                }\r\n            }\r\n        }\r\n        else if (r.ranges) {\r\n            for (var i = 0; i < r.ranges.length; i++) {\r\n                this._parseRanges(r.ranges[i], path + \"/\" + i, range);\r\n            }\r\n        }\r\n    };\r\n    Manifest.prototype.getAllRanges = function () {\r\n        if (this._allRanges != null)\r\n            return this._allRanges;\r\n        this._allRanges = [];\r\n        var topRanges = this.getTopRanges();\r\n        var _loop_1 = function (i) {\r\n            var topRange = topRanges[i];\r\n            if (topRange.id) {\r\n                this_1._allRanges.push(topRange); // it might be a placeholder root range\r\n            }\r\n            var reducer = function (acc, next) {\r\n                acc.add(next);\r\n                var nextRanges = next.getRanges();\r\n                if (nextRanges.length) {\r\n                    return nextRanges.reduce(reducer, acc);\r\n                }\r\n                return acc;\r\n            };\r\n            var subRanges = Array.from(topRange.getRanges().reduce(reducer, new Set()));\r\n            this_1._allRanges = this_1._allRanges.concat(subRanges);\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < topRanges.length; i++) {\r\n            _loop_1(i);\r\n        }\r\n        return this._allRanges;\r\n    };\r\n    Manifest.prototype.getRangeById = function (id) {\r\n        var ranges = this.getAllRanges();\r\n        for (var i = 0; i < ranges.length; i++) {\r\n            var range = ranges[i];\r\n            if (range.id === id) {\r\n                return range;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Manifest.prototype.getRangeByPath = function (path) {\r\n        var ranges = this.getAllRanges();\r\n        for (var i = 0; i < ranges.length; i++) {\r\n            var range = ranges[i];\r\n            if (range.path === path) {\r\n                return range;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Manifest.prototype.getSequences = function () {\r\n        if (this.items.length) {\r\n            return this.items;\r\n        }\r\n        // IxIF mediaSequences overrode sequences, so need to be checked first.\r\n        // deprecate this when presentation 3 ships\r\n        var items = this.__jsonld.mediaSequences || this.__jsonld.sequences;\r\n        if (items) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                var s = items[i];\r\n                var sequence = new Sequence(s, this.options);\r\n                this.items.push(sequence);\r\n            }\r\n        }\r\n        else if (this.__jsonld.items) {\r\n            var sequence = new Sequence(this.__jsonld.items, this.options);\r\n            this.items.push(sequence);\r\n        }\r\n        return this.items;\r\n    };\r\n    Manifest.prototype.getSequenceByIndex = function (sequenceIndex) {\r\n        return this.getSequences()[sequenceIndex];\r\n    };\r\n    Manifest.prototype.getTotalSequences = function () {\r\n        return this.getSequences().length;\r\n    };\r\n    Manifest.prototype.getManifestType = function () {\r\n        var service = (this.getService(distCommonjs_7.UI_EXTENSIONS));\r\n        if (service) {\r\n            return service.getProperty(\"manifestType\");\r\n        }\r\n        return ManifestType.EMPTY;\r\n    };\r\n    Manifest.prototype.isMultiSequence = function () {\r\n        return this.getTotalSequences() > 1;\r\n    };\r\n    Manifest.prototype.isPagingEnabled = function () {\r\n        var viewingHint = this.getViewingHint();\r\n        if (viewingHint) {\r\n            return viewingHint === distCommonjs_9.PAGED;\r\n        }\r\n        var behavior = this.getBehavior();\r\n        if (behavior) {\r\n            return behavior === distCommonjs_2.PAGED;\r\n        }\r\n        return false;\r\n    };\r\n    Manifest.prototype.getViewingDirection = function () {\r\n        return this.getProperty(\"viewingDirection\");\r\n    };\r\n    Manifest.prototype.getViewingHint = function () {\r\n        return this.getProperty(\"viewingHint\");\r\n    };\r\n    return Manifest;\r\n}(IIIFResource));\r\nvar ManifestType;\r\n(function (ManifestType) {\r\n    ManifestType[\"EMPTY\"] = \"\";\r\n    ManifestType[\"MANUSCRIPT\"] = \"manuscript\";\r\n    ManifestType[\"MONOGRAPH\"] = \"monograph\";\r\n})(ManifestType || (ManifestType = {}));\r\nvar __extends$b = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Range = /** @class */ (function (_super) {\r\n    __extends$b(Range, _super);\r\n    function Range(jsonld, options) {\r\n        var _this = _super.call(this, jsonld, options) || this;\r\n        _this._ranges = null;\r\n        _this.canvases = null;\r\n        _this.items = [];\r\n        return _this;\r\n    }\r\n    Range.prototype.getCanvasIds = function () {\r\n        if (this.__jsonld.canvases) {\r\n            return this.__jsonld.canvases;\r\n        }\r\n        else if (this.canvases) {\r\n            return this.canvases;\r\n        }\r\n        return [];\r\n    };\r\n    Range.prototype.getDuration = function () {\r\n        var start;\r\n        var end;\r\n        if (this.canvases && this.canvases.length) {\r\n            for (var i = 0; i < this.canvases.length; i++) {\r\n                var canvas = this.canvases[i];\r\n                var temporal = Utils.getTemporalComponent(canvas);\r\n                if (temporal && temporal.length > 1) {\r\n                    if (i === 0) {\r\n                        start = Number(temporal[0]);\r\n                    }\r\n                    if (i === this.canvases.length - 1) {\r\n                        end = Number(temporal[1]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // get child ranges and calculate the start and end based on them\r\n            var childRanges = this.getRanges();\r\n            for (var i = 0; i < childRanges.length; i++) {\r\n                var childRange = childRanges[i];\r\n                var duration = childRange.getDuration();\r\n                if (duration) {\r\n                    if (i === 0) {\r\n                        start = duration.start;\r\n                    }\r\n                    if (i === childRanges.length - 1) {\r\n                        end = duration.end;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (start !== undefined && end !== undefined) {\r\n            return new Duration(start, end);\r\n        }\r\n        return undefined;\r\n    };\r\n    // getCanvases(): ICanvas[] {\r\n    //     if (this._canvases) {\r\n    //         return this._canvases;\r\n    //     }\r\n    //     return this._canvases = <ICanvas[]>this.items.en().where(m => m.isCanvas()).toArray();\r\n    // }\r\n    Range.prototype.getRanges = function () {\r\n        if (this._ranges) {\r\n            return this._ranges;\r\n        }\r\n        return (this._ranges = this.items.filter(function (m) { return m.isRange(); }));\r\n    };\r\n    Range.prototype.getBehavior = function () {\r\n        var behavior = this.getProperty(\"behavior\");\r\n        if (Array.isArray(behavior)) {\r\n            behavior = behavior[0];\r\n        }\r\n        if (behavior) {\r\n            return behavior;\r\n        }\r\n        return null;\r\n    };\r\n    Range.prototype.getViewingDirection = function () {\r\n        return this.getProperty(\"viewingDirection\");\r\n    };\r\n    Range.prototype.getViewingHint = function () {\r\n        return this.getProperty(\"viewingHint\");\r\n    };\r\n    Range.prototype.getTree = function (treeRoot) {\r\n        treeRoot.data = this;\r\n        this.treeNode = treeRoot;\r\n        var ranges = this.getRanges();\r\n        if (ranges && ranges.length) {\r\n            for (var i = 0; i < ranges.length; i++) {\r\n                var range = ranges[i];\r\n                var node = new TreeNode();\r\n                treeRoot.addNode(node);\r\n                this._parseTreeNode(node, range);\r\n            }\r\n        }\r\n        Utils.generateTreeNodeIds(treeRoot);\r\n        return treeRoot;\r\n    };\r\n    Range.prototype.spansTime = function (time) {\r\n        var duration = this.getDuration();\r\n        if (duration) {\r\n            if (time >= duration.start && time <= duration.end) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Range.prototype._parseTreeNode = function (node, range) {\r\n        node.label = (LanguageMap.getValue(range.getLabel(), this.options.locale));\r\n        node.data = range;\r\n        node.data.type = Utils.normaliseType(TreeNodeType.RANGE);\r\n        range.treeNode = node;\r\n        var ranges = range.getRanges();\r\n        if (ranges && ranges.length) {\r\n            for (var i = 0; i < ranges.length; i++) {\r\n                var childRange = ranges[i];\r\n                var behavior = childRange.getBehavior();\r\n                if (behavior === distCommonjs_2.NO_NAV) {\r\n                    continue;\r\n                }\r\n                else {\r\n                    var childNode = new TreeNode();\r\n                    node.addNode(childNode);\r\n                    this._parseTreeNode(childNode, childRange);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return Range;\r\n}(ManifestResource));\r\nvar __extends$c = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Rendering = /** @class */ (function (_super) {\r\n    __extends$c(Rendering, _super);\r\n    function Rendering(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    Rendering.prototype.getFormat = function () {\r\n        return this.getProperty(\"format\");\r\n    };\r\n    return Rendering;\r\n}(ManifestResource));\r\nvar __extends$d = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Sequence = /** @class */ (function (_super) {\r\n    __extends$d(Sequence, _super);\r\n    function Sequence(jsonld, options) {\r\n        var _this = _super.call(this, jsonld, options) || this;\r\n        _this.items = [];\r\n        _this._thumbnails = null;\r\n        return _this;\r\n    }\r\n    Sequence.prototype.getCanvases = function () {\r\n        if (this.items.length) {\r\n            return this.items;\r\n        }\r\n        var items = this.__jsonld.canvases || this.__jsonld.elements;\r\n        if (items) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                var c = items[i];\r\n                var canvas = new Canvas(c, this.options);\r\n                canvas.index = i;\r\n                this.items.push(canvas);\r\n            }\r\n        }\r\n        else if (this.__jsonld) {\r\n            for (var i = 0; i < this.__jsonld.length; i++) {\r\n                var c = this.__jsonld[i];\r\n                var canvas = new Canvas(c, this.options);\r\n                canvas.index = i;\r\n                this.items.push(canvas);\r\n            }\r\n        }\r\n        return this.items;\r\n    };\r\n    Sequence.prototype.getCanvasById = function (id) {\r\n        for (var i = 0; i < this.getTotalCanvases(); i++) {\r\n            var canvas = this.getCanvasByIndex(i);\r\n            // normalise canvas id\r\n            var canvasId = Utils.normaliseUrl(canvas.id);\r\n            if (Utils.normaliseUrl(id) === canvasId) {\r\n                return canvas;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Sequence.prototype.getCanvasByIndex = function (canvasIndex) {\r\n        return this.getCanvases()[canvasIndex];\r\n    };\r\n    Sequence.prototype.getCanvasIndexById = function (id) {\r\n        for (var i = 0; i < this.getTotalCanvases(); i++) {\r\n            var canvas = this.getCanvasByIndex(i);\r\n            if (canvas.id === id) {\r\n                return i;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Sequence.prototype.getCanvasIndexByLabel = function (label, foliated) {\r\n        label = label.trim();\r\n        if (!isNaN(label)) {\r\n            // if the label is numeric\r\n            label = parseInt(label, 10).toString(); // trim any preceding zeros.\r\n            if (foliated)\r\n                label += \"r\"; // default to recto\r\n        }\r\n        var doublePageRegExp = /(\\d*)\\D+(\\d*)/;\r\n        var match, regExp, regStr, labelPart1, labelPart2;\r\n        for (var i = 0; i < this.getTotalCanvases(); i++) {\r\n            var canvas = this.getCanvasByIndex(i);\r\n            // check if there's a literal match\r\n            if (LanguageMap.getValue(canvas.getLabel(), this.options.locale) === label) {\r\n                return i;\r\n            }\r\n            // check if there's a match for double-page spreads e.g. 100-101, 100_101, 100 101\r\n            match = doublePageRegExp.exec(label);\r\n            if (!match)\r\n                continue;\r\n            labelPart1 = match[1];\r\n            labelPart2 = match[2];\r\n            if (!labelPart2)\r\n                continue;\r\n            regStr = \"^\" + labelPart1 + \"\\\\D+\" + labelPart2 + \"$\";\r\n            regExp = new RegExp(regStr);\r\n            if (regExp.test(canvas.getLabel().toString())) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    Sequence.prototype.getLastCanvasLabel = function (alphanumeric) {\r\n        for (var i = this.getTotalCanvases() - 1; i >= 0; i--) {\r\n            var canvas = this.getCanvasByIndex(i);\r\n            var label = (LanguageMap.getValue(canvas.getLabel(), this.options.locale));\r\n            if (alphanumeric) {\r\n                var regExp = /^[a-zA-Z0-9]*$/;\r\n                if (regExp.test(label)) {\r\n                    return label;\r\n                }\r\n            }\r\n            else if (label) {\r\n                return label;\r\n            }\r\n        }\r\n        return this.options.defaultLabel;\r\n    };\r\n    Sequence.prototype.getLastPageIndex = function () {\r\n        return this.getTotalCanvases() - 1;\r\n    };\r\n    Sequence.prototype.getNextPageIndex = function (canvasIndex, pagingEnabled) {\r\n        var index;\r\n        if (pagingEnabled) {\r\n            var indices = this.getPagedIndices(canvasIndex);\r\n            var viewingDirection = this.getViewingDirection();\r\n            if (viewingDirection &&\r\n                viewingDirection === distCommonjs_8.RIGHT_TO_LEFT) {\r\n                index = indices[0] + 1;\r\n            }\r\n            else {\r\n                index = indices[indices.length - 1] + 1;\r\n            }\r\n        }\r\n        else {\r\n            index = canvasIndex + 1;\r\n        }\r\n        if (index > this.getLastPageIndex()) {\r\n            return -1;\r\n        }\r\n        return index;\r\n    };\r\n    Sequence.prototype.getPagedIndices = function (canvasIndex, pagingEnabled) {\r\n        var indices = [];\r\n        if (!pagingEnabled) {\r\n            indices.push(canvasIndex);\r\n        }\r\n        else {\r\n            if (this.isFirstCanvas(canvasIndex) || this.isLastCanvas(canvasIndex)) {\r\n                indices = [canvasIndex];\r\n            }\r\n            else if (canvasIndex % 2) {\r\n                indices = [canvasIndex, canvasIndex + 1];\r\n            }\r\n            else {\r\n                indices = [canvasIndex - 1, canvasIndex];\r\n            }\r\n            var viewingDirection = this.getViewingDirection();\r\n            if (viewingDirection &&\r\n                viewingDirection === distCommonjs_8.RIGHT_TO_LEFT) {\r\n                indices = indices.reverse();\r\n            }\r\n        }\r\n        return indices;\r\n    };\r\n    Sequence.prototype.getPrevPageIndex = function (canvasIndex, pagingEnabled) {\r\n        var index;\r\n        if (pagingEnabled) {\r\n            var indices = this.getPagedIndices(canvasIndex);\r\n            var viewingDirection = this.getViewingDirection();\r\n            if (viewingDirection &&\r\n                viewingDirection === distCommonjs_8.RIGHT_TO_LEFT) {\r\n                index = indices[indices.length - 1] - 1;\r\n            }\r\n            else {\r\n                index = indices[0] - 1;\r\n            }\r\n        }\r\n        else {\r\n            index = canvasIndex - 1;\r\n        }\r\n        return index;\r\n    };\r\n    Sequence.prototype.getStartCanvasIndex = function () {\r\n        var startCanvas = this.getStartCanvas();\r\n        if (startCanvas) {\r\n            // if there's a startCanvas attribute, loop through the canvases and return the matching index.\r\n            for (var i = 0; i < this.getTotalCanvases(); i++) {\r\n                var canvas = this.getCanvasByIndex(i);\r\n                if (canvas.id === startCanvas)\r\n                    return i;\r\n            }\r\n        }\r\n        // default to first canvas.\r\n        return 0;\r\n    };\r\n    // todo: deprecate\r\n    Sequence.prototype.getThumbs = function (width, height) {\r\n        //console.warn('getThumbs will be deprecated, use getThumbnails instead');\r\n        var thumbs = [];\r\n        var totalCanvases = this.getTotalCanvases();\r\n        for (var i = 0; i < totalCanvases; i++) {\r\n            var canvas = this.getCanvasByIndex(i);\r\n            var thumb = new Thumb(width, canvas);\r\n            thumbs.push(thumb);\r\n        }\r\n        return thumbs;\r\n    };\r\n    Sequence.prototype.getThumbnails = function () {\r\n        if (this._thumbnails != null)\r\n            return this._thumbnails;\r\n        this._thumbnails = [];\r\n        var canvases = this.getCanvases();\r\n        for (var i = 0; i < canvases.length; i++) {\r\n            var thumbnail = canvases[i].getThumbnail();\r\n            if (thumbnail) {\r\n                this._thumbnails.push(thumbnail);\r\n            }\r\n        }\r\n        return this._thumbnails;\r\n    };\r\n    Sequence.prototype.getStartCanvas = function () {\r\n        return this.getProperty(\"startCanvas\");\r\n    };\r\n    Sequence.prototype.getTotalCanvases = function () {\r\n        return this.getCanvases().length;\r\n    };\r\n    Sequence.prototype.getViewingDirection = function () {\r\n        if (this.getProperty(\"viewingDirection\")) {\r\n            return this.getProperty(\"viewingDirection\");\r\n        }\r\n        else if (this.options.resource.getViewingDirection) {\r\n            return this.options.resource.getViewingDirection();\r\n        }\r\n        return null;\r\n    };\r\n    Sequence.prototype.getViewingHint = function () {\r\n        return this.getProperty(\"viewingHint\");\r\n    };\r\n    Sequence.prototype.isCanvasIndexOutOfRange = function (canvasIndex) {\r\n        return canvasIndex > this.getTotalCanvases() - 1;\r\n    };\r\n    Sequence.prototype.isFirstCanvas = function (canvasIndex) {\r\n        return canvasIndex === 0;\r\n    };\r\n    Sequence.prototype.isLastCanvas = function (canvasIndex) {\r\n        return canvasIndex === this.getTotalCanvases() - 1;\r\n    };\r\n    Sequence.prototype.isMultiCanvas = function () {\r\n        return this.getTotalCanvases() > 1;\r\n    };\r\n    Sequence.prototype.isPagingEnabled = function () {\r\n        var viewingHint = this.getViewingHint();\r\n        if (viewingHint) {\r\n            return viewingHint === distCommonjs_9.PAGED;\r\n        }\r\n        return false;\r\n    };\r\n    // checks if the number of canvases is even - therefore has a front and back cover\r\n    Sequence.prototype.isTotalCanvasesEven = function () {\r\n        return this.getTotalCanvases() % 2 === 0;\r\n    };\r\n    return Sequence;\r\n}(ManifestResource));\r\nvar Deserialiser = /** @class */ (function () {\r\n    function Deserialiser() {\r\n    }\r\n    Deserialiser.parse = function (manifest, options) {\r\n        if (typeof manifest === \"string\") {\r\n            manifest = JSON.parse(manifest);\r\n        }\r\n        return this.parseJson(manifest, options);\r\n    };\r\n    Deserialiser.parseJson = function (json, options) {\r\n        var resource;\r\n        // have options been passed for the manifest to inherit?\r\n        if (options) {\r\n            if (options.navDate && !isNaN(options.navDate.getTime())) {\r\n                json.navDate = options.navDate.toString();\r\n            }\r\n        }\r\n        if (json[\"@type\"]) {\r\n            switch (json[\"@type\"]) {\r\n                case \"sc:Collection\":\r\n                    resource = this.parseCollection(json, options);\r\n                    break;\r\n                case \"sc:Manifest\":\r\n                    resource = this.parseManifest(json, options);\r\n                    break;\r\n                default:\r\n                    return null;\r\n            }\r\n        }\r\n        else {\r\n            // presentation 3\r\n            switch (json[\"type\"]) {\r\n                case \"Collection\":\r\n                    resource = this.parseCollection(json, options);\r\n                    break;\r\n                case \"Manifest\":\r\n                    resource = this.parseManifest(json, options);\r\n                    break;\r\n                default:\r\n                    return null;\r\n            }\r\n        }\r\n        // Top-level resource was loaded from a URI, so flag it to prevent\r\n        // unnecessary reload:\r\n        resource.isLoaded = true;\r\n        return resource;\r\n    };\r\n    Deserialiser.parseCollection = function (json, options) {\r\n        var collection = new Collection(json, options);\r\n        if (options) {\r\n            collection.index = options.index || 0;\r\n            if (options.resource) {\r\n                collection.parentCollection = options.resource.parentCollection;\r\n            }\r\n        }\r\n        else {\r\n            collection.index = 0;\r\n        }\r\n        this.parseCollections(collection, options);\r\n        this.parseManifests(collection, options);\r\n        this.parseItems(collection, options);\r\n        return collection;\r\n    };\r\n    Deserialiser.parseCollections = function (collection, options) {\r\n        var items;\r\n        if (collection.__jsonld.collections) {\r\n            items = collection.__jsonld.collections;\r\n        }\r\n        else if (collection.__jsonld.items) {\r\n            items = collection.__jsonld.items.filter(function (m) { return m.type.toLowerCase() === \"collection\"; });\r\n        }\r\n        if (items) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                if (options) {\r\n                    options.index = i;\r\n                }\r\n                var item = this.parseCollection(items[i], options);\r\n                item.index = i;\r\n                item.parentCollection = collection;\r\n                collection.items.push(item);\r\n            }\r\n        }\r\n    };\r\n    Deserialiser.parseManifest = function (json, options) {\r\n        var manifest = new Manifest(json, options);\r\n        return manifest;\r\n    };\r\n    Deserialiser.parseManifests = function (collection, options) {\r\n        var items;\r\n        if (collection.__jsonld.manifests) {\r\n            items = collection.__jsonld.manifests;\r\n        }\r\n        else if (collection.__jsonld.items) {\r\n            items = collection.__jsonld.items.filter(function (m) { return m.type.toLowerCase() === \"manifest\"; });\r\n        }\r\n        if (items) {\r\n            for (var i = 0; i < items.length; i++) {\r\n                var item = this.parseManifest(items[i], options);\r\n                item.index = i;\r\n                item.parentCollection = collection;\r\n                collection.items.push(item);\r\n            }\r\n        }\r\n    };\r\n    Deserialiser.parseItem = function (json, options) {\r\n        if (json[\"@type\"]) {\r\n            if (json[\"@type\"].toLowerCase() === \"sc:manifest\") {\r\n                return this.parseManifest(json, options);\r\n            }\r\n            else if (json[\"@type\"].toLowerCase() === \"sc:collection\") {\r\n                return this.parseCollection(json, options);\r\n            }\r\n        }\r\n        else if (json.type) {\r\n            if (json.type.toLowerCase() === \"manifest\") {\r\n                return this.parseManifest(json, options);\r\n            }\r\n            else if (json.type.toLowerCase() === \"collection\") {\r\n                return this.parseCollection(json, options);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Deserialiser.parseItems = function (collection, options) {\r\n        var items = collection.__jsonld.members || collection.__jsonld.items;\r\n        if (items) {\r\n            var _loop_1 = function (i) {\r\n                if (options) {\r\n                    options.index = i;\r\n                }\r\n                var item = this_1.parseItem(items[i], options);\r\n                if (!item)\r\n                    return { value: void 0 };\r\n                // only add to items if not already parsed from backwards-compatible collections/manifests arrays\r\n                if (collection.items.filter(function (m) { return m.id === item.id; })[0]) {\r\n                    return \"continue\";\r\n                }\r\n                item.index = i;\r\n                item.parentCollection = collection;\r\n                collection.items.push(item);\r\n            };\r\n            var this_1 = this;\r\n            for (var i = 0; i < items.length; i++) {\r\n                var state_1 = _loop_1(i);\r\n                if (typeof state_1 === \"object\")\r\n                    return state_1.value;\r\n            }\r\n        }\r\n    };\r\n    return Deserialiser;\r\n}());\r\nvar __extends$e = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Service = /** @class */ (function (_super) {\r\n    __extends$e(Service, _super);\r\n    function Service(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    Service.prototype.getProfile = function () {\r\n        var profile = this.getProperty(\"profile\");\r\n        if (!profile) {\r\n            profile = this.getProperty(\"dcterms:conformsTo\");\r\n        }\r\n        if (Array.isArray(profile)) {\r\n            return profile[0];\r\n        }\r\n        return profile;\r\n    };\r\n    Service.prototype.getConfirmLabel = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"confirmLabel\"), this.options.locale);\r\n    };\r\n    Service.prototype.getDescription = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"description\"), this.options.locale);\r\n    };\r\n    Service.prototype.getFailureDescription = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"failureDescription\"), this.options.locale);\r\n    };\r\n    Service.prototype.getFailureHeader = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"failureHeader\"), this.options.locale);\r\n    };\r\n    Service.prototype.getHeader = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"header\"), this.options.locale);\r\n    };\r\n    Service.prototype.getServiceLabel = function () {\r\n        return Utils.getLocalisedValue(this.getProperty(\"label\"), this.options.locale);\r\n    };\r\n    Service.prototype.getInfoUri = function () {\r\n        var infoUri = this.id;\r\n        if (!infoUri.endsWith(\"/\")) {\r\n            infoUri += \"/\";\r\n        }\r\n        infoUri += \"info.json\";\r\n        return infoUri;\r\n    };\r\n    return Service;\r\n}(ManifestResource));\r\nvar Size = /** @class */ (function () {\r\n    function Size(width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    return Size;\r\n}());\r\nvar StatusCode;\r\n(function (StatusCode) {\r\n    StatusCode[StatusCode[\"AUTHORIZATION_FAILED\"] = 1] = \"AUTHORIZATION_FAILED\";\r\n    StatusCode[StatusCode[\"FORBIDDEN\"] = 2] = \"FORBIDDEN\";\r\n    StatusCode[StatusCode[\"INTERNAL_SERVER_ERROR\"] = 3] = \"INTERNAL_SERVER_ERROR\";\r\n    StatusCode[StatusCode[\"RESTRICTED\"] = 4] = \"RESTRICTED\";\r\n})(StatusCode || (StatusCode = {}));\r\n// todo: deprecate\r\n// this is used by Sequence.getThumbs\r\nvar Thumb = /** @class */ (function () {\r\n    function Thumb(width, canvas) {\r\n        this.data = canvas;\r\n        this.index = canvas.index;\r\n        this.width = width;\r\n        var heightRatio = canvas.getHeight() / canvas.getWidth();\r\n        if (heightRatio) {\r\n            this.height = Math.floor(this.width * heightRatio);\r\n        }\r\n        else {\r\n            this.height = width;\r\n        }\r\n        this.uri = canvas.getCanonicalImageUri(width);\r\n        this.label = LanguageMap.getValue(canvas.getLabel()); // todo: pass locale?\r\n    }\r\n    return Thumb;\r\n}());\r\nvar __extends$f = (undefined && undefined.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b)\r\n                if (b.hasOwnProperty(p))\r\n                    d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar Thumbnail = /** @class */ (function (_super) {\r\n    __extends$f(Thumbnail, _super);\r\n    function Thumbnail(jsonld, options) {\r\n        return _super.call(this, jsonld, options) || this;\r\n    }\r\n    return Thumbnail;\r\n}(Resource));\r\nvar TreeNode = /** @class */ (function () {\r\n    function TreeNode(label, data) {\r\n        this.label = label;\r\n        this.data = data || {};\r\n        this.nodes = [];\r\n    }\r\n    TreeNode.prototype.addNode = function (node) {\r\n        this.nodes.push(node);\r\n        node.parentNode = this;\r\n    };\r\n    TreeNode.prototype.isCollection = function () {\r\n        return this.data.type === Utils.normaliseType(TreeNodeType.COLLECTION);\r\n    };\r\n    TreeNode.prototype.isManifest = function () {\r\n        return this.data.type === Utils.normaliseType(TreeNodeType.MANIFEST);\r\n    };\r\n    TreeNode.prototype.isRange = function () {\r\n        return this.data.type === Utils.normaliseType(TreeNodeType.RANGE);\r\n    };\r\n    return TreeNode;\r\n}());\r\nvar TreeNodeType;\r\n(function (TreeNodeType) {\r\n    TreeNodeType[\"COLLECTION\"] = \"collection\";\r\n    TreeNodeType[\"MANIFEST\"] = \"manifest\";\r\n    TreeNodeType[\"RANGE\"] = \"range\";\r\n})(TreeNodeType || (TreeNodeType = {}));\r\nvar distCommonjs$1 = createCommonjsModule(function (module, exports) {\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    exports.CONTINUE = 100;\r\n    exports.SWITCHING_PROTOCOLS = 101;\r\n    exports.PROCESSING = 102;\r\n    exports.OK = 200;\r\n    exports.CREATED = 201;\r\n    exports.ACCEPTED = 202;\r\n    exports.NON_AUTHORITATIVE_INFORMATION = 203;\r\n    exports.NO_CONTENT = 204;\r\n    exports.RESET_CONTENT = 205;\r\n    exports.PARTIAL_CONTENT = 206;\r\n    exports.MULTI_STATUS = 207;\r\n    exports.MULTIPLE_CHOICES = 300;\r\n    exports.MOVED_PERMANENTLY = 301;\r\n    exports.MOVED_TEMPORARILY = 302;\r\n    exports.SEE_OTHER = 303;\r\n    exports.NOT_MODIFIED = 304;\r\n    exports.USE_PROXY = 305;\r\n    exports.TEMPORARY_REDIRECT = 307;\r\n    exports.BAD_REQUEST = 400;\r\n    exports.UNAUTHORIZED = 401;\r\n    exports.PAYMENT_REQUIRED = 402;\r\n    exports.FORBIDDEN = 403;\r\n    exports.NOT_FOUND = 404;\r\n    exports.METHOD_NOT_ALLOWED = 405;\r\n    exports.NOT_ACCEPTABLE = 406;\r\n    exports.PROXY_AUTHENTICATION_REQUIRED = 407;\r\n    exports.REQUEST_TIME_OUT = 408;\r\n    exports.CONFLICT = 409;\r\n    exports.GONE = 410;\r\n    exports.LENGTH_REQUIRED = 411;\r\n    exports.PRECONDITION_FAILED = 412;\r\n    exports.REQUEST_ENTITY_TOO_LARGE = 413;\r\n    exports.REQUEST_URI_TOO_LARGE = 414;\r\n    exports.UNSUPPORTED_MEDIA_TYPE = 415;\r\n    exports.REQUESTED_RANGE_NOT_SATISFIABLE = 416;\r\n    exports.EXPECTATION_FAILED = 417;\r\n    exports.IM_A_TEAPOT = 418;\r\n    exports.UNPROCESSABLE_ENTITY = 422;\r\n    exports.LOCKED = 423;\r\n    exports.FAILED_DEPENDENCY = 424;\r\n    exports.UNORDERED_COLLECTION = 425;\r\n    exports.UPGRADE_REQUIRED = 426;\r\n    exports.PRECONDITION_REQUIRED = 428;\r\n    exports.TOO_MANY_REQUESTS = 429;\r\n    exports.REQUEST_HEADER_FIELDS_TOO_LARGE = 431;\r\n    exports.INTERNAL_SERVER_ERROR = 500;\r\n    exports.NOT_IMPLEMENTED = 501;\r\n    exports.BAD_GATEWAY = 502;\r\n    exports.SERVICE_UNAVAILABLE = 503;\r\n    exports.GATEWAY_TIME_OUT = 504;\r\n    exports.HTTP_VERSION_NOT_SUPPORTED = 505;\r\n    exports.VARIANT_ALSO_NEGOTIATES = 506;\r\n    exports.INSUFFICIENT_STORAGE = 507;\r\n    exports.BANDWIDTH_LIMIT_EXCEEDED = 509;\r\n    exports.NOT_EXTENDED = 510;\r\n    exports.NETWORK_AUTHENTICATION_REQUIRED = 511;\r\n});\r\nunwrapExports(distCommonjs$1);\r\nvar distCommonjs_4$1 = distCommonjs$1.OK;\r\nvar distCommonjs_14 = distCommonjs$1.MOVED_TEMPORARILY;\r\nvar distCommonjs_20 = distCommonjs$1.UNAUTHORIZED;\r\nfunction unfetch(e, n) { return n = n || {}, new Promise(function (t, r) { var s = new XMLHttpRequest, o = [], u = [], i = {}, a = function () { return { ok: 2 == (s.status / 100 | 0), statusText: s.statusText, status: s.status, url: s.responseURL, text: function () { return Promise.resolve(s.responseText); }, json: function () { return Promise.resolve(JSON.parse(s.responseText)); }, blob: function () { return Promise.resolve(new Blob([s.response])); }, clone: a, headers: { keys: function () { return o; }, entries: function () { return u; }, get: function (e) { return i[e.toLowerCase()]; }, has: function (e) { return e.toLowerCase() in i; } } }; }; for (var l in s.open(n.method || \"get\", e, !0), s.onload = function () { s.getAllResponseHeaders().replace(/^(.*?):[^\\S\\n]*([\\s\\S]*?)$/gm, function (e, n, t) { o.push(n = n.toLowerCase()), u.push([n, t]), i[n] = i[n] ? i[n] + \",\" + t : t; }), t(a()); }, s.onerror = r, s.withCredentials = \"include\" == n.credentials, n.headers)\r\n    s.setRequestHeader(l, n.headers[l]); s.send(n.body || null); }); }\r\nvar unfetch$1 = /*#__PURE__*/ Object.freeze({\r\n    __proto__: null,\r\n    'default': unfetch\r\n});\r\nvar require$$0 = getCjsExportFromNamespace(unfetch$1);\r\nvar browser = window.fetch || (window.fetch = require$$0.default || require$$0);\r\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try {\r\n            step(generator.next(value));\r\n        }\r\n        catch (e) {\r\n            reject(e);\r\n        } }\r\n        function rejected(value) { try {\r\n            step(generator[\"throw\"](value));\r\n        }\r\n        catch (e) {\r\n            reject(e);\r\n        } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function () { if (t[0] & 1)\r\n            throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f)\r\n            throw new TypeError(\"Generator is already executing.\");\r\n        while (_)\r\n            try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)\r\n                    return t;\r\n                if (y = 0, t)\r\n                    op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0:\r\n                    case 1:\r\n                        t = op;\r\n                        break;\r\n                    case 4:\r\n                        _.label++;\r\n                        return { value: op[1], done: false };\r\n                    case 5:\r\n                        _.label++;\r\n                        y = op[1];\r\n                        op = [0];\r\n                        continue;\r\n                    case 7:\r\n                        op = _.ops.pop();\r\n                        _.trys.pop();\r\n                        continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\r\n                            _ = 0;\r\n                            continue;\r\n                        }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {\r\n                            _.label = op[1];\r\n                            break;\r\n                        }\r\n                        if (op[0] === 6 && _.label < t[1]) {\r\n                            _.label = t[1];\r\n                            t = op;\r\n                            break;\r\n                        }\r\n                        if (t && _.label < t[2]) {\r\n                            _.label = t[2];\r\n                            _.ops.push(op);\r\n                            break;\r\n                        }\r\n                        if (t[2])\r\n                            _.ops.pop();\r\n                        _.trys.pop();\r\n                        continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            }\r\n            catch (e) {\r\n                op = [6, e];\r\n                y = 0;\r\n            }\r\n            finally {\r\n                f = t = 0;\r\n            }\r\n        if (op[0] & 5)\r\n            throw op[1];\r\n        return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar Utils = /** @class */ (function () {\r\n    function Utils() {\r\n    }\r\n    Utils.getMediaType = function (type) {\r\n        type = type.toLowerCase();\r\n        type = type.split(\";\")[0];\r\n        return type.trim();\r\n    };\r\n    Utils.getImageQuality = function (profile) {\r\n        if (profile === distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_1 ||\r\n            profile === distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_2 ||\r\n            profile === distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_1 ||\r\n            profile === distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_2 ||\r\n            profile === distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_1 ||\r\n            profile === distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_2 ||\r\n            profile === distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_1 ||\r\n            profile === distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_2 ||\r\n            profile === distCommonjs_7.IMAGE_1_LEVEL_1 ||\r\n            profile === distCommonjs_7.IMAGE_1_PROFILE_LEVEL_1 ||\r\n            profile === distCommonjs_7.IMAGE_1_LEVEL_2 ||\r\n            profile === distCommonjs_7.IMAGE_1_PROFILE_LEVEL_2) {\r\n            return \"native\";\r\n        }\r\n        return \"default\";\r\n    };\r\n    Utils.getInexactLocale = function (locale) {\r\n        if (locale.indexOf(\"-\") !== -1) {\r\n            return locale.substr(0, locale.indexOf(\"-\"));\r\n        }\r\n        return locale;\r\n    };\r\n    Utils.getLocalisedValue = function (resource, locale) {\r\n        // if the resource is not an array of translations, return the string.\r\n        if (!Array.isArray(resource)) {\r\n            return resource;\r\n        }\r\n        // test for exact match\r\n        for (var i = 0; i < resource.length; i++) {\r\n            var value_1 = resource[i];\r\n            var language_1 = value_1[\"@language\"];\r\n            if (locale === language_1) {\r\n                return value_1[\"@value\"];\r\n            }\r\n        }\r\n        // test for inexact match\r\n        var match = locale.substr(0, locale.indexOf(\"-\"));\r\n        for (var i = 0; i < resource.length; i++) {\r\n            var value = resource[i];\r\n            var language = value[\"@language\"];\r\n            if (language === match) {\r\n                return value[\"@value\"];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Utils.generateTreeNodeIds = function (treeNode, index) {\r\n        if (index === void 0) {\r\n            index = 0;\r\n        }\r\n        var id;\r\n        if (!treeNode.parentNode) {\r\n            id = \"0\";\r\n        }\r\n        else {\r\n            id = treeNode.parentNode.id + \"-\" + index;\r\n        }\r\n        treeNode.id = id;\r\n        for (var i = 0; i < treeNode.nodes.length; i++) {\r\n            var n = treeNode.nodes[i];\r\n            Utils.generateTreeNodeIds(n, i);\r\n        }\r\n    };\r\n    Utils.normaliseType = function (type) {\r\n        type = type.toLowerCase();\r\n        if (type.indexOf(\":\") !== -1) {\r\n            var split = type.split(\":\");\r\n            return split[1];\r\n        }\r\n        return type;\r\n    };\r\n    Utils.normaliseUrl = function (url) {\r\n        url = url.substr(url.indexOf(\"://\"));\r\n        if (url.indexOf(\"#\") !== -1) {\r\n            url = url.split(\"#\")[0];\r\n        }\r\n        return url;\r\n    };\r\n    Utils.normalisedUrlsMatch = function (url1, url2) {\r\n        return Utils.normaliseUrl(url1) === Utils.normaliseUrl(url2);\r\n    };\r\n    Utils.isImageProfile = function (profile) {\r\n        if (Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_PROFILE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_PROFILE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_PROFILE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_PROFILE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_PROFILE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_PROFILE_LEVEL_2)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Utils.isLevel0ImageProfile = function (profile) {\r\n        if (Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_PROFILE_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_LEVEL_0) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_PROFILE_LEVEL_0)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Utils.isLevel1ImageProfile = function (profile) {\r\n        if (Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_PROFILE_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_LEVEL_1) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_PROFILE_LEVEL_1)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Utils.isLevel2ImageProfile = function (profile) {\r\n        if (Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_COMPLIANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_COMPLIANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_0_CONFORMANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_CONFORMANCE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_1_PROFILE_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_LEVEL_2) ||\r\n            Utils.normalisedUrlsMatch(profile, distCommonjs_7.IMAGE_2_PROFILE_LEVEL_2)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Utils.parseManifest = function (manifest, options) {\r\n        return Deserialiser.parse(manifest, options);\r\n    };\r\n    Utils.checkStatus = function (response) {\r\n        if (response.ok) {\r\n            return response;\r\n        }\r\n        else {\r\n            var error = new Error(response.statusText);\r\n            error.response = response;\r\n            return Promise.reject(error);\r\n        }\r\n    };\r\n    Utils.loadManifest = function (url) {\r\n        return new Promise(function (resolve) {\r\n            fetch(url)\r\n                .then(Utils.checkStatus)\r\n                .then(function (r) { return r.json(); })\r\n                .then(function (data) {\r\n                resolve(data);\r\n            });\r\n        });\r\n    };\r\n    Utils.loadExternalResourcesAuth1 = function (resources, openContentProviderInteraction, openTokenService, getStoredAccessToken, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages) {\r\n        return new Promise(function (resolve, reject) {\r\n            var promises = resources.map(function (resource) {\r\n                return Utils.loadExternalResourceAuth1(resource, openContentProviderInteraction, openTokenService, getStoredAccessToken, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages);\r\n            });\r\n            Promise.all(promises)\r\n                .then(function () {\r\n                resolve(resources);\r\n            })[\"catch\"](function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    Utils.loadExternalResourceAuth1 = function (resource, openContentProviderInteraction, openTokenService, getStoredAccessToken, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var storedAccessToken;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, getStoredAccessToken(resource)];\r\n                    case 1:\r\n                        storedAccessToken = _a.sent();\r\n                        if (!storedAccessToken)\r\n                            return [3 /*break*/, 6];\r\n                        return [4 /*yield*/, resource.getData(storedAccessToken)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        if (!(resource.status === distCommonjs_4$1))\r\n                            return [3 /*break*/, 3];\r\n                        return [2 /*return*/, resource];\r\n                    case 3:\r\n                        // the stored token is no good for this resource\r\n                        return [4 /*yield*/, Utils.doAuthChain(resource, openContentProviderInteraction, openTokenService, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages)];\r\n                    case 4:\r\n                        // the stored token is no good for this resource\r\n                        _a.sent();\r\n                        _a.label = 5;\r\n                    case 5:\r\n                        if (resource.status === distCommonjs_4$1 || resource.status === distCommonjs_14) {\r\n                            return [2 /*return*/, resource];\r\n                        }\r\n                        throw Utils.createAuthorizationFailedError();\r\n                    case 6: return [4 /*yield*/, resource.getData()];\r\n                    case 7:\r\n                        _a.sent();\r\n                        if (!(resource.status === distCommonjs_14 ||\r\n                            resource.status === distCommonjs_20))\r\n                            return [3 /*break*/, 9];\r\n                        return [4 /*yield*/, Utils.doAuthChain(resource, openContentProviderInteraction, openTokenService, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages)];\r\n                    case 8:\r\n                        _a.sent();\r\n                        _a.label = 9;\r\n                    case 9:\r\n                        if (resource.status === distCommonjs_4$1 || resource.status === distCommonjs_14) {\r\n                            return [2 /*return*/, resource];\r\n                        }\r\n                        throw Utils.createAuthorizationFailedError();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Utils.doAuthChain = function (resource, openContentProviderInteraction, openTokenService, userInteractedWithContentProvider, getContentProviderInteraction, handleMovedTemporarily, showOutOfOptionsMessages) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var externalService, kioskService, clickThroughService, loginService, serviceToTry, lastAttempted, kioskInteraction, contentProviderInteraction, contentProviderInteraction;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // This function enters the flowchart at the < External? > junction\r\n                        // http://iiif.io/api/auth/1.0/#workflow-from-the-browser-client-perspective\r\n                        if (!resource.isAccessControlled()) {\r\n                            return [2 /*return*/, resource]; // no services found\r\n                        }\r\n                        externalService = resource.externalService;\r\n                        if (externalService) {\r\n                            externalService.options = resource.options;\r\n                        }\r\n                        kioskService = resource.kioskService;\r\n                        if (kioskService) {\r\n                            kioskService.options = resource.options;\r\n                        }\r\n                        clickThroughService = resource.clickThroughService;\r\n                        if (clickThroughService) {\r\n                            clickThroughService.options = resource.options;\r\n                        }\r\n                        loginService = resource.loginService;\r\n                        if (loginService) {\r\n                            loginService.options = resource.options;\r\n                        }\r\n                        if (!(!resource.isResponseHandled && resource.status === distCommonjs_14))\r\n                            return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, handleMovedTemporarily(resource)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/, resource];\r\n                    case 2:\r\n                        serviceToTry = null;\r\n                        lastAttempted = null;\r\n                        // repetition of logic is left in these steps for clarity:\r\n                        // Looking for external pattern\r\n                        serviceToTry = externalService;\r\n                        if (!serviceToTry)\r\n                            return [3 /*break*/, 4];\r\n                        lastAttempted = serviceToTry;\r\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\r\n                    case 3:\r\n                        _a.sent();\r\n                        return [2 /*return*/, resource];\r\n                    case 4:\r\n                        // Looking for kiosk pattern\r\n                        serviceToTry = kioskService;\r\n                        if (!serviceToTry)\r\n                            return [3 /*break*/, 7];\r\n                        lastAttempted = serviceToTry;\r\n                        kioskInteraction = openContentProviderInteraction(serviceToTry);\r\n                        if (!kioskInteraction)\r\n                            return [3 /*break*/, 7];\r\n                        return [4 /*yield*/, userInteractedWithContentProvider(kioskInteraction)];\r\n                    case 5:\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\r\n                    case 6:\r\n                        _a.sent();\r\n                        return [2 /*return*/, resource];\r\n                    case 7:\r\n                        // The code for the next two patterns is identical (other than the profile name).\r\n                        // The difference is in the expected behaviour of\r\n                        //\r\n                        //    await userInteractedWithContentProvider(contentProviderInteraction);\r\n                        //\r\n                        // For clickthrough the opened window should close immediately having established\r\n                        // a session, whereas for login the user might spend some time entering credentials etc.\r\n                        // Looking for clickthrough pattern\r\n                        serviceToTry = clickThroughService;\r\n                        if (!serviceToTry)\r\n                            return [3 /*break*/, 11];\r\n                        lastAttempted = serviceToTry;\r\n                        return [4 /*yield*/, getContentProviderInteraction(resource, serviceToTry)];\r\n                    case 8:\r\n                        contentProviderInteraction = _a.sent();\r\n                        if (!contentProviderInteraction)\r\n                            return [3 /*break*/, 11];\r\n                        // should close immediately\r\n                        return [4 /*yield*/, userInteractedWithContentProvider(contentProviderInteraction)];\r\n                    case 9:\r\n                        // should close immediately\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\r\n                    case 10:\r\n                        _a.sent();\r\n                        return [2 /*return*/, resource];\r\n                    case 11:\r\n                        // Looking for login pattern\r\n                        serviceToTry = loginService;\r\n                        if (!serviceToTry)\r\n                            return [3 /*break*/, 15];\r\n                        lastAttempted = serviceToTry;\r\n                        return [4 /*yield*/, getContentProviderInteraction(resource, serviceToTry)];\r\n                    case 12:\r\n                        contentProviderInteraction = _a.sent();\r\n                        if (!contentProviderInteraction)\r\n                            return [3 /*break*/, 15];\r\n                        // we expect the user to spend some time interacting\r\n                        return [4 /*yield*/, userInteractedWithContentProvider(contentProviderInteraction)];\r\n                    case 13:\r\n                        // we expect the user to spend some time interacting\r\n                        _a.sent();\r\n                        return [4 /*yield*/, Utils.attemptResourceWithToken(resource, openTokenService, serviceToTry)];\r\n                    case 14:\r\n                        _a.sent();\r\n                        return [2 /*return*/, resource];\r\n                    case 15:\r\n                        // nothing worked! Use the most recently tried service as the source of\r\n                        // messages to show to the user.\r\n                        if (lastAttempted) {\r\n                            showOutOfOptionsMessages(resource, lastAttempted);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Utils.attemptResourceWithToken = function (resource, openTokenService, authService) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var tokenService, tokenMessage;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        tokenService = authService.getService(distCommonjs_7.AUTH_1_TOKEN);\r\n                        if (!tokenService)\r\n                            return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, openTokenService(resource, tokenService)];\r\n                    case 1:\r\n                        tokenMessage = _a.sent();\r\n                        if (!(tokenMessage && tokenMessage.accessToken))\r\n                            return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, resource.getData(tokenMessage)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [2 /*return*/, resource];\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Utils.loadExternalResourcesAuth09 = function (resources, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken, handleResourceResponse, options) {\r\n        return new Promise(function (resolve, reject) {\r\n            var promises = resources.map(function (resource) {\r\n                return Utils.loadExternalResourceAuth09(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken, handleResourceResponse, options);\r\n            });\r\n            Promise.all(promises)\r\n                .then(function () {\r\n                resolve(resources);\r\n            })[\"catch\"](function (error) {\r\n                reject(error);\r\n            });\r\n        });\r\n    };\r\n    // IIIF auth api pre v1.0\r\n    // Keeping this around for now until the auth 1.0 implementation is stable\r\n    Utils.loadExternalResourceAuth09 = function (resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken, handleResourceResponse, options) {\r\n        return new Promise(function (resolve, reject) {\r\n            if (options && options.pessimisticAccessControl) {\r\n                // pessimistic: access control cookies may have been deleted.\r\n                // always request the access token for every access controlled info.json request\r\n                // returned access tokens are not stored, therefore the login window flashes for every request.\r\n                resource\r\n                    .getData()\r\n                    .then(function () {\r\n                    if (resource.isAccessControlled()) {\r\n                        // if the resource has a click through service, use that.\r\n                        if (resource.clickThroughService) {\r\n                            resolve(clickThrough(resource));\r\n                            //} else if(resource.restrictedService) {\r\n                            resolve(restricted(resource));\r\n                        }\r\n                        else {\r\n                            login(resource)\r\n                                .then(function () {\r\n                                getAccessToken(resource, true)\r\n                                    .then(function (token) {\r\n                                    resource\r\n                                        .getData(token)\r\n                                        .then(function () {\r\n                                        resolve(handleResourceResponse(resource));\r\n                                    })[\"catch\"](function (message) {\r\n                                        reject(Utils.createInternalServerError(message));\r\n                                    });\r\n                                })[\"catch\"](function (message) {\r\n                                    reject(Utils.createInternalServerError(message));\r\n                                });\r\n                            })[\"catch\"](function (message) {\r\n                                reject(Utils.createInternalServerError(message));\r\n                            });\r\n                        }\r\n                    }\r\n                    else {\r\n                        // this info.json isn't access controlled, therefore no need to request an access token.\r\n                        resolve(resource);\r\n                    }\r\n                })[\"catch\"](function (message) {\r\n                    reject(Utils.createInternalServerError(message));\r\n                });\r\n            }\r\n            else {\r\n                // optimistic: access control cookies may not have been deleted.\r\n                // store access tokens to avoid login window flashes.\r\n                // if cookies are deleted a page refresh is required.\r\n                // try loading the resource using an access token that matches the info.json domain.\r\n                // if an access token is found, request the resource using it regardless of whether it is access controlled.\r\n                getStoredAccessToken(resource, tokenStorageStrategy)\r\n                    .then(function (storedAccessToken) {\r\n                    if (storedAccessToken) {\r\n                        // try using the stored access token\r\n                        resource\r\n                            .getData(storedAccessToken)\r\n                            .then(function () {\r\n                            // if the info.json loaded using the stored access token\r\n                            if (resource.status === distCommonjs_4$1) {\r\n                                resolve(handleResourceResponse(resource));\r\n                            }\r\n                            else {\r\n                                // otherwise, load the resource data to determine the correct access control services.\r\n                                // if access controlled, do login.\r\n                                Utils.authorize(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken)\r\n                                    .then(function () {\r\n                                    resolve(handleResourceResponse(resource));\r\n                                })[\"catch\"](function (error) {\r\n                                    // if (resource.restrictedService){\r\n                                    //     reject(Utils.createRestrictedError());\r\n                                    // } else {\r\n                                    reject(Utils.createAuthorizationFailedError());\r\n                                    //}\r\n                                });\r\n                            }\r\n                        })[\"catch\"](function (error) {\r\n                            reject(Utils.createAuthorizationFailedError());\r\n                        });\r\n                    }\r\n                    else {\r\n                        Utils.authorize(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken)\r\n                            .then(function () {\r\n                            resolve(handleResourceResponse(resource));\r\n                        })[\"catch\"](function (error) {\r\n                            reject(Utils.createAuthorizationFailedError());\r\n                        });\r\n                    }\r\n                })[\"catch\"](function (error) {\r\n                    reject(Utils.createAuthorizationFailedError());\r\n                });\r\n            }\r\n        });\r\n    };\r\n    Utils.createError = function (name, message) {\r\n        var error = new Error();\r\n        error.message = message;\r\n        error.name = String(name);\r\n        return error;\r\n    };\r\n    Utils.createAuthorizationFailedError = function () {\r\n        return Utils.createError(StatusCode.AUTHORIZATION_FAILED, \"Authorization failed\");\r\n    };\r\n    Utils.createRestrictedError = function () {\r\n        return Utils.createError(StatusCode.RESTRICTED, \"Restricted\");\r\n    };\r\n    Utils.createInternalServerError = function (message) {\r\n        return Utils.createError(StatusCode.INTERNAL_SERVER_ERROR, message);\r\n    };\r\n    Utils.authorize = function (resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, getStoredAccessToken) {\r\n        return new Promise(function (resolve, reject) {\r\n            resource.getData().then(function () {\r\n                if (resource.isAccessControlled()) {\r\n                    getStoredAccessToken(resource, tokenStorageStrategy)\r\n                        .then(function (storedAccessToken) {\r\n                        if (storedAccessToken) {\r\n                            // try using the stored access token\r\n                            resource\r\n                                .getData(storedAccessToken)\r\n                                .then(function () {\r\n                                if (resource.status === distCommonjs_4$1) {\r\n                                    resolve(resource); // happy path ended\r\n                                }\r\n                                else {\r\n                                    // the stored token is no good for this resource\r\n                                    Utils.showAuthInteraction(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject);\r\n                                }\r\n                            })[\"catch\"](function (message) {\r\n                                reject(Utils.createInternalServerError(message));\r\n                            });\r\n                        }\r\n                        else {\r\n                            // There was no stored token, but the user might have a cookie that will grant a token\r\n                            getAccessToken(resource, false).then(function (accessToken) {\r\n                                if (accessToken) {\r\n                                    storeAccessToken(resource, accessToken, tokenStorageStrategy)\r\n                                        .then(function () {\r\n                                        // try using the fresh access token\r\n                                        resource\r\n                                            .getData(accessToken)\r\n                                            .then(function () {\r\n                                            if (resource.status === distCommonjs_4$1) {\r\n                                                resolve(resource);\r\n                                            }\r\n                                            else {\r\n                                                // User has a token, but it's not good enough\r\n                                                Utils.showAuthInteraction(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject);\r\n                                            }\r\n                                        })[\"catch\"](function (message) {\r\n                                            reject(Utils.createInternalServerError(message));\r\n                                        });\r\n                                    })[\"catch\"](function (message) {\r\n                                        // not able to store access token\r\n                                        reject(Utils.createInternalServerError(message));\r\n                                    });\r\n                                }\r\n                                else {\r\n                                    // The user did not have a cookie that granted a token\r\n                                    Utils.showAuthInteraction(resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject);\r\n                                }\r\n                            });\r\n                        }\r\n                    })[\"catch\"](function (message) {\r\n                        reject(Utils.createInternalServerError(message));\r\n                    });\r\n                }\r\n                else {\r\n                    // this info.json isn't access controlled, therefore there's no need to request an access token\r\n                    resolve(resource);\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Utils.showAuthInteraction = function (resource, tokenStorageStrategy, clickThrough, restricted, login, getAccessToken, storeAccessToken, resolve, reject) {\r\n        if (resource.status === distCommonjs_14 && !resource.isResponseHandled) {\r\n            // if the resource was redirected to a degraded version\r\n            // and the response hasn't been handled yet.\r\n            // if the client wishes to trigger a login, set resource.isResponseHandled to true\r\n            // and call loadExternalResources() again passing the resource.\r\n            resolve(resource);\r\n            // } else if (resource.restrictedService) {\r\n            //     resolve(restricted(resource));\r\n            //     // TODO: move to next etc\r\n        }\r\n        else if (resource.clickThroughService && !resource.isResponseHandled) {\r\n            // if the resource has a click through service, use that.\r\n            clickThrough(resource).then(function () {\r\n                getAccessToken(resource, true)\r\n                    .then(function (accessToken) {\r\n                    storeAccessToken(resource, accessToken, tokenStorageStrategy)\r\n                        .then(function () {\r\n                        resource\r\n                            .getData(accessToken)\r\n                            .then(function () {\r\n                            resolve(resource);\r\n                        })[\"catch\"](function (message) {\r\n                            reject(Utils.createInternalServerError(message));\r\n                        });\r\n                    })[\"catch\"](function (message) {\r\n                        reject(Utils.createInternalServerError(message));\r\n                    });\r\n                })[\"catch\"](function (message) {\r\n                    reject(Utils.createInternalServerError(message));\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            // get an access token\r\n            login(resource).then(function () {\r\n                getAccessToken(resource, true)\r\n                    .then(function (accessToken) {\r\n                    storeAccessToken(resource, accessToken, tokenStorageStrategy)\r\n                        .then(function () {\r\n                        resource\r\n                            .getData(accessToken)\r\n                            .then(function () {\r\n                            resolve(resource);\r\n                        })[\"catch\"](function (message) {\r\n                            reject(Utils.createInternalServerError(message));\r\n                        });\r\n                    })[\"catch\"](function (message) {\r\n                        reject(Utils.createInternalServerError(message));\r\n                    });\r\n                })[\"catch\"](function (message) {\r\n                    reject(Utils.createInternalServerError(message));\r\n                });\r\n            });\r\n        }\r\n    };\r\n    Utils.getService = function (resource, profile) {\r\n        var services = this.getServices(resource);\r\n        for (var i = 0; i < services.length; i++) {\r\n            var service = services[i];\r\n            if (service.getProfile() === profile) {\r\n                return service;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Utils.getResourceById = function (parentResource, id) {\r\n        return (Utils.traverseAndFind(parentResource.__jsonld, \"@id\", id));\r\n    };\r\n    /**\r\n     * Does a depth first traversal of an Object, returning an Object that\r\n     * matches provided k and v arguments\r\n     * @example Utils.traverseAndFind({foo: 'bar'}, 'foo', 'bar')\r\n     */\r\n    Utils.traverseAndFind = function (object, k, v) {\r\n        if (object.hasOwnProperty(k) && object[k] === v) {\r\n            return object;\r\n        }\r\n        for (var i = 0; i < Object.keys(object).length; i++) {\r\n            if (typeof object[Object.keys(object)[i]] === \"object\") {\r\n                var o = Utils.traverseAndFind(object[Object.keys(object)[i]], k, v);\r\n                if (o != null) {\r\n                    return o;\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    Utils.getServices = function (resource) {\r\n        var service;\r\n        // if passing a manifesto-parsed object, use the __jsonld.service property,\r\n        // otherwise look for a service property (info.json services)\r\n        if (resource.__jsonld) {\r\n            service = resource.__jsonld.service;\r\n        }\r\n        else {\r\n            service = resource.service;\r\n        }\r\n        var services = [];\r\n        if (!service)\r\n            return services;\r\n        // coerce to array\r\n        if (!Array.isArray(service)) {\r\n            service = [service];\r\n        }\r\n        for (var i = 0; i < service.length; i++) {\r\n            var s = service[i];\r\n            if (typeof s === \"string\") {\r\n                var r = this.getResourceById(resource.options.resource, s);\r\n                if (r) {\r\n                    services.push(new Service(r.__jsonld || r, resource.options));\r\n                }\r\n            }\r\n            else {\r\n                services.push(new Service(s, resource.options));\r\n            }\r\n        }\r\n        return services;\r\n    };\r\n    Utils.getTemporalComponent = function (target) {\r\n        var temporal = /t=([^&]+)/g.exec(target);\r\n        var t = null;\r\n        if (temporal && temporal[1]) {\r\n            t = temporal[1].split(\",\");\r\n        }\r\n        return t;\r\n    };\r\n    return Utils;\r\n}());\r\nvar loadManifest = function (url) {\r\n    return Utils.loadManifest(url);\r\n};\r\nvar parseManifest = function (manifest, options) {\r\n    return Utils.parseManifest(manifest, options);\r\n};\r\nvar img = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyB2aWV3Qm94PScwIDAgNTEyIDUxMic+PHRpdGxlPmlvbmljb25zLXY1LW48L3RpdGxlPjxwYXRoIGQ9J00xNiw0MjBhMjgsMjgsMCwwLDAsMjgsMjhINDY4YTI4LDI4LDAsMCwwLDI4LTI4VjIwOEgxNlonLz48cGF0aCBkPSdNNDk2LDEyNGEyOCwyOCwwLDAsMC0yOC0yOEgyMTIuODRsLTQ4LTMySDQ0QTI4LDI4LDAsMCwwLDE2LDkydjg0SDQ5NlonLz48L3N2Zz4=';\r\nvar IIIFExplorer = /** @class */ (function () {\r\n    function class_1(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this._items = [];\r\n        this.copyEnabled = false;\r\n        this.pageLoadThreshold = \"10%\";\r\n        this.pageSize = 50;\r\n        this.pagingLimitKey = \"_limit\";\r\n        this.pagingStartKey = \"_start\";\r\n        this.searchEnabled = true;\r\n        this.upLevelEnabled = true;\r\n        this._parentCollections = [];\r\n        this._currentPage = 0;\r\n        this.selectCollection = createEvent(this, \"selectCollection\", 7);\r\n        this.selectManifest = createEvent(this, \"selectManifest\", 7);\r\n    }\r\n    class_1.prototype.componentWillLoad = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_b) {\r\n                this._loadCollection(this.manifest);\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    // this gets triggered when the user has scrolled to the bottom\r\n    class_1.prototype._loadPage = function (event) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this._currentPage = this._currentPage + 1;\r\n                        return [4 /*yield*/, this._loadCollection(this._currentCollectionId, this._currentPage)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        event.target.complete();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    class_1.prototype._upLevel = function (collection) {\r\n        var index = this._parentCollections.indexOf(collection);\r\n        this._parentCollections = this._parentCollections.slice(0, index);\r\n        this._selectedItem = null;\r\n        this._loadCollection(collection.id);\r\n    };\r\n    class_1.prototype._sortCollectionsFirst = function (a, b) {\r\n        var aType = a.getIIIFResourceType();\r\n        var bType = b.getIIIFResourceType();\r\n        if (aType === bType) {\r\n            // Alphabetical\r\n            var aLabel = LanguageMap.getValue(a.getLabel());\r\n            var bLabel = LanguageMap.getValue(b.getLabel());\r\n            if (aLabel && bLabel) {\r\n                return aLabel < bLabel ? -1 : 1;\r\n            }\r\n        }\r\n        // Collections first\r\n        return bType.indexOf(\"collection\") - aType.indexOf(\"collection\");\r\n    };\r\n    Object.defineProperty(class_1.prototype, \"_copyEnabled\", {\r\n        get: function () {\r\n            return this.copyEnabled && Clipboard.supportsCopy();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_1.prototype, \"_pagingEnabled\", {\r\n        get: function () {\r\n            return this.pagingEnabled && !!this.pagingStartKey && !!this.pagingLimitKey;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    class_1.prototype._pageUrl = function (url, start, limit) {\r\n        var u = new URL(url, document.baseURI);\r\n        return \"\" + u.origin + u.pathname + u.search + \"&\" + this.pagingStartKey + \"=\" + start + \"&\" + this.pagingLimitKey + \"=\" + limit;\r\n    };\r\n    // remove paging qs keys\r\n    class_1.prototype._normaliseCollectionId = function (id) {\r\n        var url = new URL(id);\r\n        var params = new URLSearchParams(url.search.slice(1));\r\n        params.delete(this.pagingStartKey);\r\n        params.delete(this.pagingLimitKey);\r\n        var normalisedUrl = \"\" + url.origin + url.pathname + \"?\" + params;\r\n        return normalisedUrl;\r\n    };\r\n    class_1.prototype._loadCollection = function (collectionId, page) {\r\n        if (page === void 0) { page = 0; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var data, collection, nextCollectionId;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        this._loading = true;\r\n                        // reset currentPage if no page number is passed\r\n                        if (page === 0) {\r\n                            this._currentPage = 0;\r\n                        }\r\n                        if (this._pagingEnabled) {\r\n                            collectionId = this._pageUrl(collectionId, this._currentPage * this.pageSize, this.pageSize);\r\n                        }\r\n                        return [4 /*yield*/, loadManifest(collectionId)];\r\n                    case 1:\r\n                        data = _b.sent();\r\n                        collection = parseManifest(data);\r\n                        nextCollectionId = this._normaliseCollectionId(collection.id);\r\n                        if (!collection.isCollection()) {\r\n                            // if it's a manifest, just list that\r\n                            this._items = [collection];\r\n                        }\r\n                        else {\r\n                            // if we're loading more items from the current collection\r\n                            if (this._currentCollectionId === nextCollectionId) {\r\n                                this._items = __spreadArrays(this._items, collection.items);\r\n                            }\r\n                            else {\r\n                                this._items = collection.items;\r\n                                if (this._parentCollections.length) {\r\n                                    collection.parentCollection = this._parentCollections[this._parentCollections.length - 1];\r\n                                }\r\n                                this._parentCollections.push(collection);\r\n                            }\r\n                            // only sort items if paging isn't enabled, otherwise the order of items\r\n                            // will change each time a new page is loaded.\r\n                            if (!this.pagingEnabled) {\r\n                                this._items = this._items.sort(this._sortCollectionsFirst);\r\n                            }\r\n                        }\r\n                        this._selectedItem = null;\r\n                        this._currentCollectionId = nextCollectionId;\r\n                        this._loading = false;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // disabling this for now for simplicity\r\n    // private async _followWithin(collection: Collection): Promise<Collection[]> {\r\n    //   const url: any = collection.getProperty(\"within\");\r\n    //   if (Array.isArray(url)) {\r\n    //     // TODO: Handle multiple within values\r\n    //     return [];\r\n    //   }\r\n    //   const parent = await loadManifest(url);\r\n    //   const parentCollection: Collection = parseManifest(parent) as Collection;\r\n    //   if (parentCollection.getProperty(\"within\")) {\r\n    //     this._followWithin(parentCollection).then((array: Collection[]) => {\r\n    //       array.push(collection);\r\n    //       return array;\r\n    //     });\r\n    //   }\r\n    //   return [parentCollection, collection];\r\n    // }\r\n    class_1.prototype._searchInput = function (e) {\r\n        var items = Array.from(this.el.querySelector(\".items\").children);\r\n        var query = e.target.value.toLowerCase();\r\n        requestAnimationFrame(function () {\r\n            items.forEach(function (item) {\r\n                var shouldShow = item.textContent.toLowerCase().indexOf(query) > -1;\r\n                item.style.display = shouldShow ? \"block\" : \"none\";\r\n            });\r\n        });\r\n    };\r\n    class_1.prototype.render = function () {\r\n        var _this_1 = this;\r\n        return [\r\n            this._parentCollections.length > 0 && (h(\"ion-header\", { class: \"breadcrumbs-header\" }, h(\"ion-list\", { class: \"breadcrumbs\", lines: \"none\" }, this._loading ? (h(\"ion-item\", { class: \"breadcrumb\" }, h(\"ion-icon\", { src: img, slot: \"start\" }), h(\"ion-spinner\", { name: \"dots\" }))) : (this._parentCollections\r\n                .slice(-1)\r\n                .map(function (collection, index) { return (h(\"iiif-explorer-breadcrumb\", { enabled: !_this_1._loading, collection: collection, isOpen: index === _this_1._parentCollections.length - 1 })); }))))),\r\n            h(\"ion-content\", null, h(\"ion-list\", { class: \"items\", lines: \"none\" }, this._items.map(function (item) { return (h(\"iiif-explorer-item\", { enabled: !_this_1._loading, copyEnabled: _this_1._copyEnabled, item: item, selected: _this_1._selectedItem && _this_1._selectedItem.id === item.id })); })), this._pagingEnabled && (h(\"ion-infinite-scroll\", { threshold: this.pageLoadThreshold, onIonInfinite: function (e) { return _this_1._loadPage(e); } }, h(\"ion-infinite-scroll-content\", { \"loading-spinner\": \"dots\" })))),\r\n            this.searchEnabled && (h(\"ion-footer\", null, h(\"ion-toolbar\", null, h(\"ion-searchbar\", { placeholder: \"search\", onIonInput: function (e) { return _this_1._searchInput(e); } }))))\r\n        ];\r\n    };\r\n    class_1.prototype.breadcrumbSelected = function (event) {\r\n        var collection = event.detail;\r\n        if (this._normaliseCollectionId(collection.id) !== this._currentCollectionId) {\r\n            this._upLevel(collection);\r\n        }\r\n    };\r\n    class_1.prototype.onUpLevel = function (event) {\r\n        var collection = event.detail;\r\n        this._upLevel(collection);\r\n    };\r\n    class_1.prototype.itemSelected = function (event) {\r\n        var item = event.detail;\r\n        if (item.isCollection()) {\r\n            this._loadCollection(item.id);\r\n            this.selectCollection.emit(item);\r\n        }\r\n        else {\r\n            this._selectedItem = item;\r\n            this.selectManifest.emit(item);\r\n        }\r\n    };\r\n    Object.defineProperty(class_1.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_1, \"style\", {\r\n        get: function () { return \"iiif-explorer{font-family:sans-serif}ion-item{display:block}ion-header{min-height:64px}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.hide{visibility:hidden}input[type=search]::-ms-clear,input[type=search]::-ms-reveal{display:none;width:0;height:0}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration{display:none}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_1;\r\n}());\r\nvar img$1 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyB2aWV3Qm94PScwIDAgNTEyIDUxMic+PHRpdGxlPmlvbmljb25zLXY1LWE8L3RpdGxlPjxwb2x5bGluZSBwb2ludHM9JzExMiAyNDQgMjU2IDEwMCA0MDAgMjQ0JyBzdHlsZT0nZmlsbDpub25lO3N0cm9rZTojMDAwO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbWl0ZXJsaW1pdDoxMDtzdHJva2Utd2lkdGg6NDhweCcvPjxsaW5lIHgxPScyNTYnIHkxPScxMjAnIHgyPScyNTYnIHkyPSc0MTInIHN0eWxlPSdmaWxsOm5vbmU7c3Ryb2tlOiMwMDA7c3Ryb2tlLWxpbmVjYXA6c3F1YXJlO3N0cm9rZS1taXRlcmxpbWl0OjEwO3N0cm9rZS13aWR0aDo0OHB4Jy8+PC9zdmc+';\r\nvar img$2 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyB2aWV3Qm94PScwIDAgNTEyIDUxMic+PHRpdGxlPmlvbmljb25zLXY1LW48L3RpdGxlPjxwYXRoIGQ9J00xNi4wOCwxODkuNCw0NC42Niw0MjMuMjdBMjgsMjgsMCwwLDAsNzIuNTIsNDQ4aDM2N2EyOCwyOCwwLDAsMCwyNy44Ni0yNC43M0w0OTUuOTIsMTg5LjRBMTIsMTIsMCwwLDAsNDg0LDE3NkgyOEExMiwxMiwwLDAsMCwxNi4wOCwxODkuNFonLz48cGF0aCBkPSdNNDY0LDEyNGEyOCwyOCwwLDAsMC0yOC0yOEgyNDQuODRsLTQ4LTMySDc2QTI4LDI4LDAsMCwwLDQ4LDkydjUySDQ2NFonLz48L3N2Zz4=';\r\nvar IIIFExplorerBreadcrumb = /** @class */ (function () {\r\n    function IIIFExplorerBreadcrumb(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.enabled = true;\r\n        this.selectBreadcrumb = createEvent(this, \"selectBreadcrumb\", 7);\r\n        this.upLevel = createEvent(this, \"upLevel\", 7);\r\n    }\r\n    IIIFExplorerBreadcrumb.prototype.render = function () {\r\n        var _this_1 = this;\r\n        var label = this.collection.getDefaultLabel() || \"no label\";\r\n        return (h(\"ion-item\", { class: \"breadcrumb\" }, h(\"ion-icon\", { src: this.isOpen ? img$2 : img, slot: \"start\" }), h(\"ion-label\", { onClick: function () { return _this_1.enabled ? _this_1.selectBreadcrumb.emit(_this_1.collection) : false; }, title: label, class: {\r\n                noselect: true,\r\n                enabled: this.enabled\r\n            } }, label), this.collection.parentCollection && (h(\"ion-icon\", { slot: \"end\", class: {\r\n                \"up-arrow\": true\r\n            }, src: img$1, onClick: function (_e) { return _this_1.upLevel.emit(_this_1.collection.parentCollection); } }))));\r\n    };\r\n    Object.defineProperty(IIIFExplorerBreadcrumb, \"style\", {\r\n        get: function () { return \".up-arrow,ion-label{cursor:pointer}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return IIIFExplorerBreadcrumb;\r\n}());\r\nvar img$3 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyB2aWV3Qm94PScwIDAgNTEyIDUxMic+PHRpdGxlPmlvbmljb25zLXY1LWU8L3RpdGxlPjxwYXRoIGQ9J000NTYsNDgwSDEzNmEyNCwyNCwwLDAsMS0yNC0yNFYxMjhhMTYsMTYsMCwwLDEsMTYtMTZINDU2YTI0LDI0LDAsMCwxLDI0LDI0VjQ1NkEyNCwyNCwwLDAsMSw0NTYsNDgwWicvPjxwYXRoIGQ9J00xMTIsODBINDAwVjU2YTI0LDI0LDAsMCwwLTI0LTI0SDYwQTI4LDI4LDAsMCwwLDMyLDYwVjM3NmEyNCwyNCwwLDAsMCwyNCwyNEg4MFYxMTJBMzIsMzIsMCwwLDEsMTEyLDgwWicvPjwvc3ZnPg==';\r\nvar img$4 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyB2aWV3Qm94PScwIDAgNTEyIDUxMic+PHRpdGxlPmlvbmljb25zLXY1LWU8L3RpdGxlPjxwYXRoIGQ9J00yNDAsMjE2VjMySDkyQTEyLDEyLDAsMCwwLDgwLDQ0VjQ2OGExMiwxMiwwLDAsMCwxMiwxMkg0MjBhMTIsMTIsMCwwLDAsMTItMTJWMjI0SDI0OEE4LDgsMCwwLDEsMjQwLDIxNlonLz48cGF0aCBkPSdNMjcyLDQxLjY5VjE4OGE0LDQsMCwwLDAsNCw0SDQyMi4zMWEyLDIsMCwwLDAsMS40Mi0zLjQxTDI3NS40MSw0MC4yN0EyLDIsMCwwLDAsMjcyLDQxLjY5WicvPjwvc3ZnPgo=';\r\nvar IIIFExplorerItem = /** @class */ (function () {\r\n    function class_2(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.copyEnabled = true;\r\n        this.enabled = true;\r\n        this.selected = false;\r\n        this.popoverFadeTimeout = 1000;\r\n        this.selectItem = createEvent(this, \"selectItem\", 7);\r\n    }\r\n    class_2.prototype.render = function () {\r\n        var _this_1 = this;\r\n        var label = this.item.getDefaultLabel() || \"no label\";\r\n        return (this.item && (h(\"ion-item\", { class: {\r\n                selected: this.selected,\r\n                folder: this.item.isCollection(),\r\n                file: this.item.isManifest()\r\n            } }, h(\"ion-icon\", { slot: \"start\", src: this.item.isCollection() ? img : img$4 }), h(\"ion-label\", { onClick: function () { return _this_1.enabled ? _this_1.selectItem.emit(_this_1.item) : false; }, title: label, class: {\r\n                noselect: true,\r\n                enabled: this.enabled\r\n            } }, label), this.copyEnabled && [\r\n            h(\"div\", { class: \"popover hide\" }, \"Copied\"),\r\n            h(\"ion-button\", { title: \"Copy path\", class: {\r\n                    copy: true\r\n                }, onClick: function (ev) { return __awaiter(_this_1, void 0, void 0, function () {\r\n                    var popover;\r\n                    return __generator(this, function (_b) {\r\n                        Clipboard.copy(this.item.id);\r\n                        popover = ev.target.parentElement.querySelector(\".popover\");\r\n                        popover.classList.remove(\"hide\");\r\n                        // popover.style.left = (ev.target as any).offsetLeft + \"px\";\r\n                        setTimeout(function () {\r\n                            popover.classList.add(\"hide\");\r\n                        }, this.popoverFadeTimeout);\r\n                        return [2 /*return*/];\r\n                    });\r\n                }); }, slot: \"end\" }, h(\"ion-icon\", { src: img$3 }))\r\n        ])));\r\n    };\r\n    Object.defineProperty(class_2, \"style\", {\r\n        get: function () { return \".selected{--background:grey;color:#fff}ion-label{\\@apply --my-mixin}.copy,ion-label{cursor:pointer}.popover{font-size:11px}ion-button{margin-left:10px}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_2;\r\n}());\r\nvar Button = /** @class */ (function () {\r\n    function Button(hostRef) {\r\n        var _this_1 = this;\r\n        registerInstance(this, hostRef);\r\n        this.inItem = false;\r\n        this.inListHeader = false;\r\n        this.inToolbar = false;\r\n        /**\r\n         * The type of button.\r\n         */\r\n        this.buttonType = 'button';\r\n        /**\r\n         * If `true`, the user cannot interact with the button.\r\n         */\r\n        this.disabled = false;\r\n        /**\r\n         * When using a router, it specifies the transition direction when navigating to\r\n         * another page using `href`.\r\n         */\r\n        this.routerDirection = 'forward';\r\n        /**\r\n         * If `true`, activates a button with a heavier font weight.\r\n         */\r\n        this.strong = false;\r\n        /**\r\n         * The type of the button.\r\n         */\r\n        this.type = 'button';\r\n        this.handleClick = function (ev) {\r\n            if (_this_1.type === 'button') {\r\n                openURL(_this_1.href, ev, _this_1.routerDirection);\r\n            }\r\n            else if (hasShadowDom(_this_1.el)) {\r\n                // this button wants to specifically submit a form\r\n                // climb up the dom to see if we're in a <form>\r\n                // and if so, then use JS to submit it\r\n                var form = _this_1.el.closest('form');\r\n                if (form) {\r\n                    ev.preventDefault();\r\n                    var fakeButton = document.createElement('button');\r\n                    fakeButton.type = _this_1.type;\r\n                    fakeButton.style.display = 'none';\r\n                    form.appendChild(fakeButton);\r\n                    fakeButton.click();\r\n                    fakeButton.remove();\r\n                }\r\n            }\r\n        };\r\n        this.onFocus = function () {\r\n            _this_1.ionFocus.emit();\r\n        };\r\n        this.onBlur = function () {\r\n            _this_1.ionBlur.emit();\r\n        };\r\n        this.ionFocus = createEvent(this, \"ionFocus\", 7);\r\n        this.ionBlur = createEvent(this, \"ionBlur\", 7);\r\n    }\r\n    Button.prototype.componentWillLoad = function () {\r\n        this.inToolbar = !!this.el.closest('ion-buttons');\r\n        this.inListHeader = !!this.el.closest('ion-list-header');\r\n        this.inItem = !!this.el.closest('ion-item') || !!this.el.closest('ion-item-divider');\r\n    };\r\n    Object.defineProperty(Button.prototype, \"hasIconOnly\", {\r\n        get: function () {\r\n            return !!this.el.querySelector('ion-icon[slot=\"icon-only\"]');\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Button.prototype, \"rippleType\", {\r\n        get: function () {\r\n            var hasClearFill = this.fill === undefined || this.fill === 'clear';\r\n            // If the button is in a toolbar, has a clear fill (which is the default)\r\n            // and only has an icon we use the unbounded \"circular\" ripple effect\r\n            if (hasClearFill && this.hasIconOnly && this.inToolbar) {\r\n                return 'unbounded';\r\n            }\r\n            return 'bounded';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Button.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        var _c = this, buttonType = _c.buttonType, type = _c.type, disabled = _c.disabled, rel = _c.rel, target = _c.target, size = _c.size, href = _c.href, color = _c.color, expand = _c.expand, hasIconOnly = _c.hasIconOnly, shape = _c.shape, strong = _c.strong;\r\n        var finalSize = size === undefined && this.inItem ? 'small' : size;\r\n        var TagType = href === undefined ? 'button' : 'a';\r\n        var attrs = (TagType === 'button')\r\n            ? { type: type }\r\n            : {\r\n                download: this.download,\r\n                href: href,\r\n                rel: rel,\r\n                target: target\r\n            };\r\n        var fill = this.fill;\r\n        if (fill === undefined) {\r\n            fill = this.inToolbar || this.inListHeader ? 'clear' : 'solid';\r\n        }\r\n        return (h(Host, { onClick: this.handleClick, \"aria-disabled\": disabled ? 'true' : null, class: Object.assign(Object.assign({}, createColorClasses$1(color)), (_b = {}, _b[mode] = true, _b[buttonType] = true, _b[buttonType + \"-\" + expand] = expand !== undefined, _b[buttonType + \"-\" + finalSize] = finalSize !== undefined, _b[buttonType + \"-\" + shape] = shape !== undefined, _b[buttonType + \"-\" + fill] = true, _b[buttonType + \"-strong\"] = strong, _b['in-toolbar'] = hostContext('ion-toolbar', this.el), _b['in-toolbar-color'] = hostContext('ion-toolbar[color]', this.el), _b['button-has-icon-only'] = hasIconOnly, _b['button-disabled'] = disabled, _b['ion-activatable'] = true, _b['ion-focusable'] = true, _b)) }, h(TagType, Object.assign({}, attrs, { class: \"button-native\", disabled: disabled, onFocus: this.onFocus, onBlur: this.onBlur, part: \"button\" }), h(\"span\", { class: \"button-inner\", part: \"button-inner\" }, h(\"slot\", { name: \"icon-only\" }), h(\"slot\", { name: \"start\" }), h(\"slot\", null), h(\"slot\", { name: \"end\" })), mode === 'md' && h(\"ion-ripple-effect\", { type: this.rippleType }))));\r\n    };\r\n    Object.defineProperty(Button.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Button, \"style\", {\r\n        get: function () { return \":host{--overflow:hidden;--ripple-color:currentColor;--border-width:initial;--border-color:initial;--border-style:initial;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--box-shadow:none;display:inline-block;width:auto;color:var(--color);font-family:var(--ion-font-family,inherit);text-align:center;text-decoration:none;text-overflow:ellipsis;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;vertical-align:-webkit-baseline-middle;pointer-events:auto;-webkit-font-kerning:none;font-kerning:none}:host(.button-disabled){cursor:default;opacity:.5;pointer-events:none}:host(.button-solid){--background:var(--ion-color-primary,#3880ff);--color:var(--ion-color-primary-contrast,#fff)}:host(.button-outline){--border-color:var(--ion-color-primary,#3880ff)}:host(.button-clear),:host(.button-outline){--background:transparent;--color:var(--ion-color-primary,#3880ff)}:host(.button-clear){--border-width:0}:host(.button-block){display:block}:host(.button-block) .button-native{margin-left:0;margin-right:0;display:block;width:100%;clear:both;contain:content}:host(.button-block) .button-native:after{clear:both}:host(.button-full){display:block}:host(.button-full) .button-native{margin-left:0;margin-right:0;display:block;width:100%;contain:content}:host(.button-full:not(.button-round)) .button-native{border-radius:0;border-right-width:0;border-left-width:0}.button-native{border-radius:var(--border-radius);-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;position:relative;width:100%;height:100%;-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);line-height:1;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);contain:layout style;cursor:pointer;opacity:var(--opacity);overflow:var(--overflow);z-index:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.button-native{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.button-native::-moz-focus-inner{border:0}.button-inner{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;z-index:1}::slotted(ion-icon){font-size:1.4em;pointer-events:none}::slotted(ion-icon[slot=start]){margin-left:-.3em;margin-right:.3em;margin-top:0;margin-bottom:0}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){::slotted(ion-icon[slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:-.3em;margin-inline-start:-.3em;-webkit-margin-end:.3em;margin-inline-end:.3em}}::slotted(ion-icon[slot=end]){margin-left:.3em;margin-right:-.2em;margin-top:0;margin-bottom:0}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){::slotted(ion-icon[slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:.3em;margin-inline-start:.3em;-webkit-margin-end:-.2em;margin-inline-end:-.2em}}::slotted(ion-icon[slot=icon-only]){font-size:1.8em}ion-ripple-effect{color:var(--ripple-color)}.button-native:after{left:0;right:0;top:0;bottom:0;position:absolute;content:\\\"\\\";opacity:0}:host(.ion-activated){color:var(--color-activated)}:host(.ion-activated) .button-native:after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-focused){color:var(--color-focused)}:host(.ion-focused) .button-native:after{background:var(--background-focused);opacity:var(--background-focused-opacity)}\\@media (any-hover:hover){:host(:hover){color:var(--color-hover)}:host(:hover) .button-native:after{background:var(--background-hover);opacity:var(--background-hover-opacity)}}:host(.button-solid.ion-color) .button-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.button-outline.ion-color) .button-native{border-color:var(--ion-color-base)}:host(.button-clear.ion-color) .button-native,:host(.button-outline.ion-color) .button-native{background:transparent;color:var(--ion-color-base)}:host(.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{color:var(--ion-toolbar-color,var(--color))}:host(.button-outline.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{border-color:var(--ion-toolbar-color,var(--color,var(--border-color)))}:host(.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native{background:var(--ion-toolbar-color,var(--background));color:var(--ion-toolbar-background,var(--color))}:host{--border-radius:10px;--padding-top:0;--padding-bottom:0;--padding-start:1em;--padding-end:1em;--transition:background-color,opacity 100ms linear;margin-left:2px;margin-right:2px;margin-top:4px;margin-bottom:4px;height:2.8em;font-size:16px;font-weight:500;letter-spacing:-.03em}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){:host{margin-left:unset;margin-right:unset;-webkit-margin-start:2px;margin-inline-start:2px;-webkit-margin-end:2px;margin-inline-end:2px}}:host(.button-solid){--background-activated:var(--ion-color-primary-shade,#3171e0);--background-focused:var(--ion-color-primary-shade,#3171e0);--background-hover:var(--ion-color-primary-tint,#4c8dff);--background-activated-opacity:1;--background-focused-opacity:1;--background-hover-opacity:1}:host(.button-outline){--border-radius:10px;--border-width:1px;--border-style:solid;--background-activated:var(--ion-color-primary,#3880ff);--background-focused-opacity:.1;--color-activated:var(--ion-color-primary-contrast,#fff)}:host(.button-clear),:host(.button-outline){--background-focused:var(--ion-color-primary,#3880ff);--background-hover:transparent}:host(.button-clear){--background-activated:transparent;--background-focused-opacity:.1;font-size:17px;font-weight:400;letter-spacing:0}:host(.button-large){--border-radius:12px;--padding-top:0;--padding-start:1em;--padding-end:1em;--padding-bottom:0;height:2.8em;font-size:20px}:host(.button-small){--border-radius:6px;--padding-top:0;--padding-start:0.9em;--padding-end:0.9em;--padding-bottom:0;height:2.1em;font-size:13px}:host(.button-round){--border-radius:64px;--padding-top:0;--padding-start:26px;--padding-end:26px;--padding-bottom:0}:host(.button-strong){font-weight:600}:host(.button-clear.ion-activated){opacity:.4}:host(.button-outline.ion-activated.ion-color) .button-native{color:var(--ion-color-contrast)}:host(.button-outline.ion-activated.ion-color) .button-native:after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-activated) .button-native:after{background:var(--ion-color-shade)}:host(.button-clear.ion-focused.ion-color) .button-native,:host(.button-outline.ion-focused.ion-color) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-focused.ion-color) .button-native:after,:host(.button-outline.ion-focused.ion-color) .button-native:after{background:var(--ion-color-base)}:host(.button-solid.ion-color.ion-focused) .button-native:after{background:var(--ion-color-shade)}\\@media (any-hover:hover){:host(.button-clear:hover),:host(.button-outline:hover){opacity:.6}:host(.button-clear.ion-color:hover) .button-native,:host(.button-outline.ion-color:hover) .button-native{color:var(--ion-color-base)}:host(.button-clear.ion-color:hover) .button-native:after,:host(.button-outline.ion-color:hover) .button-native:after{background:transparent}:host(.button-solid.ion-color:hover) .button-native:after{background:var(--ion-color-tint)}:host(:hover.button-solid.in-toolbar:not(.ion-color):not(.in-toolbar-color)) .button-native:after{background:#fff;opacity:.1}}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Button;\r\n}());\r\nvar Content = /** @class */ (function () {\r\n    function class_3(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.isScrolling = false;\r\n        this.lastScroll = 0;\r\n        this.queued = false;\r\n        this.cTop = -1;\r\n        this.cBottom = -1;\r\n        this.mode = getIonMode$1(this);\r\n        // Detail is used in a hot loop in the scroll event, by allocating it here\r\n        // V8 will be able to inline any read/write to it since it's a monomorphic class.\r\n        // https://mrale.ph/blog/2015/01/11/whats-up-with-monomorphism.html\r\n        this.detail = {\r\n            scrollTop: 0,\r\n            scrollLeft: 0,\r\n            type: 'scroll',\r\n            event: undefined,\r\n            startX: 0,\r\n            startY: 0,\r\n            startTime: 0,\r\n            currentX: 0,\r\n            currentY: 0,\r\n            velocityX: 0,\r\n            velocityY: 0,\r\n            deltaX: 0,\r\n            deltaY: 0,\r\n            currentTime: 0,\r\n            data: undefined,\r\n            isScrolling: true,\r\n        };\r\n        /**\r\n         * If `true`, the content will scroll behind the headers\r\n         * and footers. This effect can easily be seen by setting the toolbar\r\n         * to transparent.\r\n         */\r\n        this.fullscreen = false;\r\n        /**\r\n         * If you want to enable the content scrolling in the X axis, set this property to `true`.\r\n         */\r\n        this.scrollX = false;\r\n        /**\r\n         * If you want to disable the content scrolling in the Y axis, set this property to `false`.\r\n         */\r\n        this.scrollY = true;\r\n        /**\r\n         * Because of performance reasons, ionScroll events are disabled by default, in order to enable them\r\n         * and start listening from (ionScroll), set this property to `true`.\r\n         */\r\n        this.scrollEvents = false;\r\n        this.ionScrollStart = createEvent(this, \"ionScrollStart\", 7);\r\n        this.ionScroll = createEvent(this, \"ionScroll\", 7);\r\n        this.ionScrollEnd = createEvent(this, \"ionScrollEnd\", 7);\r\n    }\r\n    class_3.prototype.disconnectedCallback = function () {\r\n        this.onScrollEnd();\r\n    };\r\n    class_3.prototype.componentDidLoad = function () {\r\n        this.resize();\r\n    };\r\n    class_3.prototype.onClick = function (ev) {\r\n        if (this.isScrolling) {\r\n            ev.preventDefault();\r\n            ev.stopPropagation();\r\n        }\r\n    };\r\n    class_3.prototype.shouldForceOverscroll = function () {\r\n        var _b = this, forceOverscroll = _b.forceOverscroll, mode = _b.mode;\r\n        return forceOverscroll === undefined\r\n            ? mode === 'ios' && isPlatform('ios')\r\n            : forceOverscroll;\r\n    };\r\n    class_3.prototype.resize = function () {\r\n        if (this.fullscreen) {\r\n            readTask(this.readDimensions.bind(this));\r\n        }\r\n        else if (this.cTop !== 0 || this.cBottom !== 0) {\r\n            this.cTop = this.cBottom = 0;\r\n            this.el.forceUpdate();\r\n        }\r\n    };\r\n    class_3.prototype.readDimensions = function () {\r\n        var page = getPageElement(this.el);\r\n        var top = Math.max(this.el.offsetTop, 0);\r\n        var bottom = Math.max(page.offsetHeight - top - this.el.offsetHeight, 0);\r\n        var dirty = top !== this.cTop || bottom !== this.cBottom;\r\n        if (dirty) {\r\n            this.cTop = top;\r\n            this.cBottom = bottom;\r\n            this.el.forceUpdate();\r\n        }\r\n    };\r\n    class_3.prototype.onScroll = function (ev) {\r\n        var _this_1 = this;\r\n        var timeStamp = Date.now();\r\n        var shouldStart = !this.isScrolling;\r\n        this.lastScroll = timeStamp;\r\n        if (shouldStart) {\r\n            this.onScrollStart();\r\n        }\r\n        if (!this.queued && this.scrollEvents) {\r\n            this.queued = true;\r\n            readTask(function (ts) {\r\n                _this_1.queued = false;\r\n                _this_1.detail.event = ev;\r\n                updateScrollDetail(_this_1.detail, _this_1.scrollEl, ts, shouldStart);\r\n                _this_1.ionScroll.emit(_this_1.detail);\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     * Get the element where the actual scrolling takes place.\r\n     * This element can be used to subscribe to `scroll` events or manually modify\r\n     * `scrollTop`. However, it's recommended to use the API provided by `ion-content`:\r\n     *\r\n     * i.e. Using `ionScroll`, `ionScrollStart`, `ionScrollEnd` for scrolling events\r\n     * and `scrollToPoint()` to scroll the content into a certain point.\r\n     */\r\n    class_3.prototype.getScrollElement = function () {\r\n        return Promise.resolve(this.scrollEl);\r\n    };\r\n    /**\r\n     * Scroll to the top of the component.\r\n     *\r\n     * @param duration The amount of time to take scrolling to the top. Defaults to `0`.\r\n     */\r\n    class_3.prototype.scrollToTop = function (duration) {\r\n        if (duration === void 0) { duration = 0; }\r\n        return this.scrollToPoint(undefined, 0, duration);\r\n    };\r\n    /**\r\n     * Scroll to the bottom of the component.\r\n     *\r\n     * @param duration The amount of time to take scrolling to the bottom. Defaults to `0`.\r\n     */\r\n    class_3.prototype.scrollToBottom = function (duration) {\r\n        if (duration === void 0) { duration = 0; }\r\n        var y = this.scrollEl.scrollHeight - this.scrollEl.clientHeight;\r\n        return this.scrollToPoint(undefined, y, duration);\r\n    };\r\n    /**\r\n     * Scroll by a specified X/Y distance in the component.\r\n     *\r\n     * @param x The amount to scroll by on the horizontal axis.\r\n     * @param y The amount to scroll by on the vertical axis.\r\n     * @param duration The amount of time to take scrolling by that amount.\r\n     */\r\n    class_3.prototype.scrollByPoint = function (x, y, duration) {\r\n        return this.scrollToPoint(x + this.scrollEl.scrollLeft, y + this.scrollEl.scrollTop, duration);\r\n    };\r\n    /**\r\n     * Scroll to a specified X/Y location in the component.\r\n     *\r\n     * @param x The point to scroll to on the horizontal axis.\r\n     * @param y The point to scroll to on the vertical axis.\r\n     * @param duration The amount of time to take scrolling to that point. Defaults to `0`.\r\n     */\r\n    class_3.prototype.scrollToPoint = function (x, y, duration) {\r\n        if (duration === void 0) { duration = 0; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var el, resolve, startTime, promise, fromY, fromX, deltaY, deltaX, step;\r\n            return __generator(this, function (_b) {\r\n                el = this.scrollEl;\r\n                if (duration < 32) {\r\n                    if (y != null) {\r\n                        el.scrollTop = y;\r\n                    }\r\n                    if (x != null) {\r\n                        el.scrollLeft = x;\r\n                    }\r\n                    return [2 /*return*/];\r\n                }\r\n                startTime = 0;\r\n                promise = new Promise(function (r) { return resolve = r; });\r\n                fromY = el.scrollTop;\r\n                fromX = el.scrollLeft;\r\n                deltaY = y != null ? y - fromY : 0;\r\n                deltaX = x != null ? x - fromX : 0;\r\n                step = function (timeStamp) {\r\n                    var linearTime = Math.min(1, ((timeStamp - startTime) / duration)) - 1;\r\n                    var easedT = Math.pow(linearTime, 3) + 1;\r\n                    if (deltaY !== 0) {\r\n                        el.scrollTop = Math.floor((easedT * deltaY) + fromY);\r\n                    }\r\n                    if (deltaX !== 0) {\r\n                        el.scrollLeft = Math.floor((easedT * deltaX) + fromX);\r\n                    }\r\n                    if (easedT < 1) {\r\n                        // do not use DomController here\r\n                        // must use nativeRaf in order to fire in the next frame\r\n                        // TODO: remove as any\r\n                        requestAnimationFrame(step);\r\n                    }\r\n                    else {\r\n                        resolve();\r\n                    }\r\n                };\r\n                // chill out for a frame first\r\n                requestAnimationFrame(function (ts) {\r\n                    startTime = ts;\r\n                    step(ts);\r\n                });\r\n                return [2 /*return*/, promise];\r\n            });\r\n        });\r\n    };\r\n    class_3.prototype.onScrollStart = function () {\r\n        var _this_1 = this;\r\n        this.isScrolling = true;\r\n        this.ionScrollStart.emit({\r\n            isScrolling: true\r\n        });\r\n        if (this.watchDog) {\r\n            clearInterval(this.watchDog);\r\n        }\r\n        // watchdog\r\n        this.watchDog = setInterval(function () {\r\n            if (_this_1.lastScroll < Date.now() - 120) {\r\n                _this_1.onScrollEnd();\r\n            }\r\n        }, 100);\r\n    };\r\n    class_3.prototype.onScrollEnd = function () {\r\n        clearInterval(this.watchDog);\r\n        this.watchDog = null;\r\n        if (this.isScrolling) {\r\n            this.isScrolling = false;\r\n            this.ionScrollEnd.emit({\r\n                isScrolling: false\r\n            });\r\n        }\r\n    };\r\n    class_3.prototype.render = function () {\r\n        var _b;\r\n        var _this_1 = this;\r\n        var _c = this, scrollX = _c.scrollX, scrollY = _c.scrollY;\r\n        var mode = getIonMode$1(this);\r\n        var forceOverscroll = this.shouldForceOverscroll();\r\n        var transitionShadow = (mode === 'ios' && config.getBoolean('experimentalTransitionShadow', true));\r\n        this.resize();\r\n        return (h(Host, { class: Object.assign(Object.assign({}, createColorClasses$1(this.color)), (_b = {}, _b[mode] = true, _b['content-sizing'] = hostContext('ion-popover', this.el), _b['overscroll'] = forceOverscroll, _b)), style: {\r\n                '--offset-top': this.cTop + \"px\",\r\n                '--offset-bottom': this.cBottom + \"px\",\r\n            } }, h(\"div\", { id: \"background-content\" }), h(\"main\", { class: {\r\n                'inner-scroll': true,\r\n                'scroll-x': scrollX,\r\n                'scroll-y': scrollY,\r\n                'overscroll': (scrollX || scrollY) && forceOverscroll\r\n            }, ref: function (el) { return _this_1.scrollEl = el; }, onScroll: (this.scrollEvents) ? function (ev) { return _this_1.onScroll(ev); } : undefined }, h(\"slot\", null)), transitionShadow ? (h(\"div\", { class: \"transition-effect\" }, h(\"div\", { class: \"transition-cover\" }), h(\"div\", { class: \"transition-shadow\" }))) : null, h(\"slot\", { name: \"fixed\" })));\r\n    };\r\n    Object.defineProperty(class_3.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_3, \"style\", {\r\n        get: function () { return \":host{--background:var(--ion-background-color,#fff);--color:var(--ion-text-color,#000);--padding-top:0px;--padding-bottom:0px;--padding-start:0px;--padding-end:0px;--keyboard-offset:0px;--offset-top:0px;--offset-bottom:0px;--overflow:auto;display:block;position:relative;-ms-flex:1;flex:1;width:100%;height:100%;margin:0!important;padding:0!important;font-family:var(--ion-font-family,inherit);contain:size style}:host(.ion-color) .inner-scroll{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.outer-content){--background:var(--ion-color-step-50,#f2f2f2)}#background-content{background:var(--background)}#background-content,.inner-scroll{left:0;right:0;top:calc(var(--offset-top) * -1);bottom:calc(var(--offset-bottom) * -1);position:absolute}.inner-scroll{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:calc(var(--padding-top) + var(--offset-top));padding-bottom:calc(var(--padding-bottom) + var(--keyboard-offset) + var(--offset-bottom));color:var(--color);-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.inner-scroll{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.scroll-x,.scroll-y{-webkit-overflow-scrolling:touch;will-change:scroll-position;-ms-scroll-chaining:none;overscroll-behavior:contain}.scroll-y{-ms-touch-action:pan-y;touch-action:pan-y;overflow-y:var(--overflow)}.scroll-x{-ms-touch-action:pan-x;touch-action:pan-x;overflow-x:var(--overflow)}.scroll-x.scroll-y{-ms-touch-action:auto;touch-action:auto}.overscroll:after,.overscroll:before{position:absolute;width:1px;height:1px;content:\\\"\\\"}.overscroll:before{bottom:-1px}.overscroll:after{top:-1px}:host(.content-sizing){contain:none}:host(.content-sizing) .inner-scroll{position:relative}.transition-effect{display:none;left:-100%;opacity:0;pointer-events:none}.transition-cover,.transition-effect{position:absolute;width:100%;height:100%}.transition-cover{right:0;background:#000;opacity:.1}.transition-shadow{display:block;position:absolute;right:0;width:10px;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAgCAYAAAAIXrg4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTE3MDgzRkQ5QTkyMTFFOUEwNzQ5MkJFREE1NUY2MjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTE3MDgzRkU5QTkyMTFFOUEwNzQ5MkJFREE1NUY2MjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxMTcwODNGQjlBOTIxMUU5QTA3NDkyQkVEQTU1RjYyNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxMTcwODNGQzlBOTIxMUU5QTA3NDkyQkVEQTU1RjYyNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmePEuQAAABNSURBVHjaYvz//z8DIxAwMDAwATGMhmFmPDQuOSZks0AMmoJBaQHjkPfB0Lfg/2gQjVow+HPy/yHvg9GiYjQfjMbBqAWjFgy/4hogwADYqwdzxy5BuwAAAABJRU5ErkJggg==);background-repeat:repeat-y;background-size:10px 16px}::slotted([slot=fixed]){position:absolute}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_3;\r\n}());\r\nvar getParentElement = function (el) {\r\n    if (el.parentElement) {\r\n        // normal element with a parent element\r\n        return el.parentElement;\r\n    }\r\n    if (el.parentNode && el.parentNode.host) {\r\n        // shadow dom's document fragment\r\n        return el.parentNode.host;\r\n    }\r\n    return null;\r\n};\r\nvar getPageElement = function (el) {\r\n    var tabs = el.closest('ion-tabs');\r\n    if (tabs) {\r\n        return tabs;\r\n    }\r\n    var page = el.closest('ion-app,ion-page,.ion-page,page-inner');\r\n    if (page) {\r\n        return page;\r\n    }\r\n    return getParentElement(el);\r\n};\r\n// ******** DOM READ ****************\r\nvar updateScrollDetail = function (detail, el, timestamp, shouldStart) {\r\n    var prevX = detail.currentX;\r\n    var prevY = detail.currentY;\r\n    var prevT = detail.currentTime;\r\n    var currentX = el.scrollLeft;\r\n    var currentY = el.scrollTop;\r\n    var timeDelta = timestamp - prevT;\r\n    if (shouldStart) {\r\n        // remember the start positions\r\n        detail.startTime = timestamp;\r\n        detail.startX = currentX;\r\n        detail.startY = currentY;\r\n        detail.velocityX = detail.velocityY = 0;\r\n    }\r\n    detail.currentTime = timestamp;\r\n    detail.currentX = detail.scrollLeft = currentX;\r\n    detail.currentY = detail.scrollTop = currentY;\r\n    detail.deltaX = currentX - detail.startX;\r\n    detail.deltaY = currentY - detail.startY;\r\n    if (timeDelta > 0 && timeDelta < 100) {\r\n        var velocityX = (currentX - prevX) / timeDelta;\r\n        var velocityY = (currentY - prevY) / timeDelta;\r\n        detail.velocityX = velocityX * 0.7 + detail.velocityX * 0.3;\r\n        detail.velocityY = velocityY * 0.7 + detail.velocityY * 0.3;\r\n    }\r\n};\r\nvar Footer = /** @class */ (function () {\r\n    function Footer(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        /**\r\n         * If `true`, the footer will be translucent.\r\n         * Only applies when the mode is `\"ios\"` and the device supports\r\n         * [`backdrop-filter`](https://developer.mozilla.org/en-US/docs/Web/CSS/backdrop-filter#Browser_compatibility).\r\n         *\r\n         * Note: In order to scroll content behind the footer, the `fullscreen`\r\n         * attribute needs to be set on the content.\r\n         */\r\n        this.translucent = false;\r\n    }\r\n    Footer.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        var translucent = this.translucent;\r\n        return (h(Host, { role: \"contentinfo\", class: (_b = {},\r\n                _b[mode] = true,\r\n                // Used internally for styling\r\n                _b[\"footer-\" + mode] = true,\r\n                _b[\"footer-translucent\"] = translucent,\r\n                _b[\"footer-translucent-\" + mode] = translucent,\r\n                _b) }, mode === 'ios' && translucent &&\r\n            h(\"div\", { class: \"footer-background\" }), h(\"slot\", null)));\r\n    };\r\n    Object.defineProperty(Footer, \"style\", {\r\n        get: function () { return \"ion-footer{display:block;position:relative;-ms-flex-order:1;order:1;width:100%;z-index:10}ion-footer ion-toolbar:last-of-type{padding-bottom:var(--ion-safe-area-bottom,0)}.footer-ios ion-toolbar:first-of-type{--border-width:0.55px 0 0}\\@supports ((-webkit-backdrop-filter:blur(0)) or (backdrop-filter:blur(0))){.footer-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.footer-translucent-ios ion-toolbar{--opacity:.8}}.footer-ios.ion-no-border ion-toolbar:first-of-type{--border-width:0}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Footer;\r\n}());\r\nvar TRANSITION = 'all 0.2s ease-in-out';\r\nvar cloneElement = function (tagName) {\r\n    var getCachedEl = document.querySelector(tagName + \".ion-cloned-element\");\r\n    if (getCachedEl !== null) {\r\n        return getCachedEl;\r\n    }\r\n    var clonedEl = document.createElement(tagName);\r\n    clonedEl.classList.add('ion-cloned-element');\r\n    clonedEl.style.setProperty('display', 'none');\r\n    document.body.appendChild(clonedEl);\r\n    return clonedEl;\r\n};\r\nvar createHeaderIndex = function (headerEl) {\r\n    if (!headerEl) {\r\n        return;\r\n    }\r\n    var toolbars = headerEl.querySelectorAll('ion-toolbar');\r\n    return {\r\n        el: headerEl,\r\n        toolbars: Array.from(toolbars).map(function (toolbar) {\r\n            var ionTitleEl = toolbar.querySelector('ion-title');\r\n            return {\r\n                el: toolbar,\r\n                background: toolbar.shadowRoot.querySelector('.toolbar-background'),\r\n                ionTitleEl: ionTitleEl,\r\n                innerTitleEl: (ionTitleEl) ? ionTitleEl.shadowRoot.querySelector('.toolbar-title') : null,\r\n                ionButtonsEl: Array.from(toolbar.querySelectorAll('ion-buttons')) || []\r\n            };\r\n        }) || []\r\n    };\r\n};\r\nvar handleContentScroll = function (scrollEl, scrollHeaderIndex, contentEl) {\r\n    readTask(function () {\r\n        var scrollTop = scrollEl.scrollTop;\r\n        var scale = clamp(1, 1 + (-scrollTop / 500), 1.1);\r\n        // Native refresher should not cause titles to scale\r\n        var nativeRefresher = contentEl.querySelector('ion-refresher.refresher-native');\r\n        if (nativeRefresher === null) {\r\n            writeTask(function () {\r\n                scaleLargeTitles(scrollHeaderIndex.toolbars, scale);\r\n            });\r\n        }\r\n    });\r\n};\r\nvar setToolbarBackgroundOpacity = function (toolbar, opacity) {\r\n    if (opacity === undefined) {\r\n        toolbar.background.style.removeProperty('--opacity');\r\n    }\r\n    else {\r\n        toolbar.background.style.setProperty('--opacity', opacity.toString());\r\n    }\r\n};\r\nvar handleToolbarBorderIntersection = function (ev, mainHeaderIndex) {\r\n    if (!ev[0].isIntersecting) {\r\n        return;\r\n    }\r\n    /**\r\n     * There is a bug in Safari where overflow scrolling on a non-body element\r\n     * does not always reset the scrollTop position to 0 when letting go. It will\r\n     * set to 1 once the rubber band effect has ended. This causes the background to\r\n     * appear slightly on certain app setups.\r\n     */\r\n    var scale = (ev[0].intersectionRatio > 0.9) ? 0 : ((1 - ev[0].intersectionRatio) * 100) / 75;\r\n    mainHeaderIndex.toolbars.forEach(function (toolbar) {\r\n        setToolbarBackgroundOpacity(toolbar, (scale === 1) ? undefined : scale);\r\n    });\r\n};\r\n/**\r\n * If toolbars are intersecting, hide the scrollable toolbar content\r\n * and show the primary toolbar content. If the toolbars are not intersecting,\r\n * hide the primary toolbar content and show the scrollable toolbar content\r\n */\r\nvar handleToolbarIntersection = function (ev, mainHeaderIndex, scrollHeaderIndex) {\r\n    writeTask(function () {\r\n        handleToolbarBorderIntersection(ev, mainHeaderIndex);\r\n        var event = ev[0];\r\n        var intersection = event.intersectionRect;\r\n        var intersectionArea = intersection.width * intersection.height;\r\n        var rootArea = event.rootBounds.width * event.rootBounds.height;\r\n        var isPageHidden = intersectionArea === 0 && rootArea === 0;\r\n        var leftDiff = Math.abs(intersection.left - event.boundingClientRect.left);\r\n        var rightDiff = Math.abs(intersection.right - event.boundingClientRect.right);\r\n        var isPageTransitioning = intersectionArea > 0 && (leftDiff >= 5 || rightDiff >= 5);\r\n        if (isPageHidden || isPageTransitioning) {\r\n            return;\r\n        }\r\n        if (event.isIntersecting) {\r\n            setHeaderActive(mainHeaderIndex, false);\r\n            setHeaderActive(scrollHeaderIndex);\r\n        }\r\n        else {\r\n            /**\r\n             * There is a bug with IntersectionObserver on Safari\r\n             * where `event.isIntersecting === false` when cancelling\r\n             * a swipe to go back gesture. Checking the intersection\r\n             * x, y, width, and height provides a workaround. This bug\r\n             * does not happen when using Safari + Web Animations,\r\n             * only Safari + CSS Animations.\r\n             */\r\n            var hasValidIntersection = (intersection.x === 0 && intersection.y === 0) || (intersection.width !== 0 && intersection.height !== 0);\r\n            if (hasValidIntersection) {\r\n                setHeaderActive(mainHeaderIndex);\r\n                setHeaderActive(scrollHeaderIndex, false);\r\n                setToolbarBackgroundOpacity(mainHeaderIndex.toolbars[0]);\r\n            }\r\n        }\r\n    });\r\n};\r\nvar setHeaderActive = function (headerIndex, active) {\r\n    if (active === void 0) { active = true; }\r\n    if (active) {\r\n        headerIndex.el.classList.remove('header-collapse-condense-inactive');\r\n    }\r\n    else {\r\n        headerIndex.el.classList.add('header-collapse-condense-inactive');\r\n    }\r\n};\r\nvar scaleLargeTitles = function (toolbars, scale, transition) {\r\n    if (toolbars === void 0) { toolbars = []; }\r\n    if (scale === void 0) { scale = 1; }\r\n    if (transition === void 0) { transition = false; }\r\n    toolbars.forEach(function (toolbar) {\r\n        var ionTitle = toolbar.ionTitleEl;\r\n        var titleDiv = toolbar.innerTitleEl;\r\n        if (!ionTitle || ionTitle.size !== 'large') {\r\n            return;\r\n        }\r\n        titleDiv.style.transformOrigin = 'left center';\r\n        titleDiv.style.transition = (transition) ? TRANSITION : '';\r\n        titleDiv.style.transform = \"scale3d(\" + scale + \", \" + scale + \", 1)\";\r\n    });\r\n};\r\nvar Header = /** @class */ (function () {\r\n    function class_4(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.collapsibleHeaderInitialized = false;\r\n        /**\r\n         * If `true`, the header will be translucent.\r\n         * Only applies when the mode is `\"ios\"` and the device supports\r\n         * [`backdrop-filter`](https://developer.mozilla.org/en-US/docs/Web/CSS/backdrop-filter#Browser_compatibility).\r\n         *\r\n         * Note: In order to scroll content behind the header, the `fullscreen`\r\n         * attribute needs to be set on the content.\r\n         */\r\n        this.translucent = false;\r\n    }\r\n    class_4.prototype.componentDidLoad = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.checkCollapsibleHeader()];\r\n                    case 1:\r\n                        _b.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    class_4.prototype.componentDidUpdate = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0: return [4 /*yield*/, this.checkCollapsibleHeader()];\r\n                    case 1:\r\n                        _b.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    class_4.prototype.componentDidUnload = function () {\r\n        this.destroyCollapsibleHeader();\r\n    };\r\n    class_4.prototype.checkCollapsibleHeader = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var hasCollapse, canCollapse, pageEl, contentEl;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        hasCollapse = this.collapse === 'condense';\r\n                        canCollapse = (hasCollapse && getIonMode$1(this) === 'ios') ? hasCollapse : false;\r\n                        if (!(!canCollapse && this.collapsibleHeaderInitialized)) return [3 /*break*/, 1];\r\n                        this.destroyCollapsibleHeader();\r\n                        return [3 /*break*/, 3];\r\n                    case 1:\r\n                        if (!(canCollapse && !this.collapsibleHeaderInitialized)) return [3 /*break*/, 3];\r\n                        pageEl = this.el.closest('ion-app,ion-page,.ion-page,page-inner');\r\n                        contentEl = (pageEl) ? pageEl.querySelector('ion-content') : null;\r\n                        return [4 /*yield*/, this.setupCollapsibleHeader(contentEl, pageEl)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    class_4.prototype.destroyCollapsibleHeader = function () {\r\n        if (this.intersectionObserver) {\r\n            this.intersectionObserver.disconnect();\r\n            this.intersectionObserver = undefined;\r\n        }\r\n        if (this.scrollEl && this.contentScrollCallback) {\r\n            this.scrollEl.removeEventListener('scroll', this.contentScrollCallback);\r\n            this.contentScrollCallback = undefined;\r\n        }\r\n        if (this.collapsibleMainHeader) {\r\n            this.collapsibleMainHeader.classList.remove('header-collapse-main');\r\n            this.collapsibleMainHeader = undefined;\r\n        }\r\n    };\r\n    class_4.prototype.setupCollapsibleHeader = function (contentEl, pageEl) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _b, headers, mainHeaderIndex, scrollHeaderIndex, toolbarIntersection;\r\n            var _this_1 = this;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        if (!contentEl || !pageEl) {\r\n                            console.error('ion-header requires a content to collapse, make sure there is an ion-content.');\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _b = this;\r\n                        return [4 /*yield*/, contentEl.getScrollElement()];\r\n                    case 1:\r\n                        _b.scrollEl = _c.sent();\r\n                        headers = pageEl.querySelectorAll('ion-header');\r\n                        this.collapsibleMainHeader = Array.from(headers).find(function (header) { return header.collapse !== 'condense'; });\r\n                        if (!this.collapsibleMainHeader) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        mainHeaderIndex = createHeaderIndex(this.collapsibleMainHeader);\r\n                        scrollHeaderIndex = createHeaderIndex(this.el);\r\n                        if (!mainHeaderIndex || !scrollHeaderIndex) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        setHeaderActive(mainHeaderIndex, false);\r\n                        mainHeaderIndex.toolbars.forEach(function (toolbar) {\r\n                            setToolbarBackgroundOpacity(toolbar, 0);\r\n                        });\r\n                        toolbarIntersection = function (ev) { handleToolbarIntersection(ev, mainHeaderIndex, scrollHeaderIndex); };\r\n                        this.intersectionObserver = new IntersectionObserver(toolbarIntersection, { root: contentEl, threshold: [0.25, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1] });\r\n                        this.intersectionObserver.observe(scrollHeaderIndex.toolbars[scrollHeaderIndex.toolbars.length - 1].el);\r\n                        /**\r\n                         * Handle scaling of large iOS titles and\r\n                         * showing/hiding border on last toolbar\r\n                         * in primary header\r\n                         */\r\n                        this.contentScrollCallback = function () { handleContentScroll(_this_1.scrollEl, scrollHeaderIndex, contentEl); };\r\n                        this.scrollEl.addEventListener('scroll', this.contentScrollCallback);\r\n                        writeTask(function () {\r\n                            cloneElement('ion-title');\r\n                            cloneElement('ion-back-button');\r\n                            if (_this_1.collapsibleMainHeader !== undefined) {\r\n                                _this_1.collapsibleMainHeader.classList.add('header-collapse-main');\r\n                            }\r\n                        });\r\n                        this.collapsibleHeaderInitialized = true;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    class_4.prototype.render = function () {\r\n        var _b;\r\n        var translucent = this.translucent;\r\n        var mode = getIonMode$1(this);\r\n        var collapse = this.collapse || 'none';\r\n        return (h(Host, { role: \"banner\", class: (_b = {},\r\n                _b[mode] = true,\r\n                // Used internally for styling\r\n                _b[\"header-\" + mode] = true,\r\n                _b[\"header-translucent\"] = this.translucent,\r\n                _b[\"header-collapse-\" + collapse] = true,\r\n                _b[\"header-translucent-\" + mode] = this.translucent,\r\n                _b) }, mode === 'ios' && translucent &&\r\n            h(\"div\", { class: \"header-background\" }), h(\"slot\", null)));\r\n    };\r\n    Object.defineProperty(class_4.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_4, \"style\", {\r\n        get: function () { return \"ion-header{display:block;position:relative;-ms-flex-order:-1;order:-1;width:100%;z-index:10}ion-header ion-toolbar:first-of-type{padding-top:var(--ion-safe-area-top,0)}.header-ios ion-toolbar:last-of-type{--border-width:0 0 0.55px}\\@supports ((-webkit-backdrop-filter:blur(0)) or (backdrop-filter:blur(0))){.header-background{left:0;right:0;top:0;bottom:0;position:absolute;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.header-translucent-ios ion-toolbar{--opacity:.8}.header-collapse-condense-inactive .header-background{-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}}.header-ios.ion-no-border ion-toolbar:last-of-type{--border-width:0}.header-collapse-condense{z-index:9}.header-collapse-condense ion-toolbar{position:-webkit-sticky;position:sticky;top:0}.header-collapse-condense ion-toolbar:first-of-type{padding-top:7px;z-index:1}.header-collapse-condense ion-toolbar{--background:var(--ion-background-color,#fff);z-index:0}.header-collapse-condense ion-toolbar ion-searchbar{height:48px;padding-top:0;padding-bottom:13px}.header-collapse-main ion-toolbar.in-toolbar ion-buttons,.header-collapse-main ion-toolbar.in-toolbar ion-title{-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-buttons.buttons-collapse,.header-collapse-condense-inactive:not(.header-collapse-condense) ion-toolbar.in-toolbar ion-title{opacity:0;pointer-events:none}.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-buttons.buttons-collapse,.header-collapse-condense-inactive.header-collapse-condense ion-toolbar.in-toolbar ion-title{visibility:hidden}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_4;\r\n}());\r\nvar CACHED_MAP;\r\nvar getIconMap = function () {\r\n    if (typeof window === 'undefined') {\r\n        return new Map();\r\n    }\r\n    else {\r\n        if (!CACHED_MAP) {\r\n            var win = window;\r\n            win.Ionicons = win.Ionicons || {};\r\n            CACHED_MAP = win.Ionicons.map = win.Ionicons.map || new Map();\r\n        }\r\n        return CACHED_MAP;\r\n    }\r\n};\r\nvar getUrl = function (i) {\r\n    var url = getSrc(i.src);\r\n    if (url) {\r\n        return url;\r\n    }\r\n    url = getName(i.name, i.icon, i.mode, i.ios, i.md);\r\n    if (url) {\r\n        return getNamedUrl(url);\r\n    }\r\n    if (i.icon) {\r\n        url = getSrc(i.icon);\r\n        if (url) {\r\n            return url;\r\n        }\r\n        url = getSrc(i.icon[i.mode]);\r\n        if (url) {\r\n            return url;\r\n        }\r\n    }\r\n    return null;\r\n};\r\nvar getNamedUrl = function (iconName) {\r\n    var url = getIconMap().get(iconName);\r\n    if (url) {\r\n        return url;\r\n    }\r\n    return getAssetPath(\"svg/\" + iconName + \".svg\");\r\n};\r\nvar getName = function (iconName, icon, mode, ios, md) {\r\n    // default to \"md\" if somehow the mode wasn't set\r\n    mode = (mode && toLower(mode)) === 'ios' ? 'ios' : 'md';\r\n    // if an icon was passed in using the ios or md attributes\r\n    // set the iconName to whatever was passed in\r\n    if (ios && mode === 'ios') {\r\n        iconName = toLower(ios);\r\n    }\r\n    else if (md && mode === 'md') {\r\n        iconName = toLower(md);\r\n    }\r\n    else {\r\n        if (!iconName && icon && !isSrc(icon)) {\r\n            iconName = icon;\r\n        }\r\n        if (isStr(iconName)) {\r\n            iconName = toLower(iconName);\r\n        }\r\n    }\r\n    if (!isStr(iconName) || iconName.trim() === '') {\r\n        return null;\r\n    }\r\n    // only allow alpha characters and dash\r\n    var invalidChars = iconName.replace(/[a-z]|-|\\d/gi, '');\r\n    if (invalidChars !== '') {\r\n        return null;\r\n    }\r\n    return iconName;\r\n};\r\nvar getSrc = function (src) {\r\n    if (isStr(src)) {\r\n        src = src.trim();\r\n        if (isSrc(src)) {\r\n            return src;\r\n        }\r\n    }\r\n    return null;\r\n};\r\nvar isSrc = function (str) { return str.length > 0 && /(\\/|\\.)/.test(str); };\r\nvar isStr = function (val) { return typeof val === 'string'; };\r\nvar toLower = function (val) { return val.toLowerCase(); };\r\nvar validateContent = function (svgContent) {\r\n    if (svgContent && typeof document !== 'undefined') {\r\n        var div = document.createElement('div');\r\n        div.innerHTML = svgContent;\r\n        // setup this way to ensure it works on our buddy IE\r\n        for (var i = div.childNodes.length - 1; i >= 0; i--) {\r\n            if (div.childNodes[i].nodeName.toLowerCase() !== 'svg') {\r\n                div.removeChild(div.childNodes[i]);\r\n            }\r\n        }\r\n        // must only have 1 root element\r\n        var svgElm = div.firstElementChild;\r\n        if (svgElm && svgElm.nodeName.toLowerCase() === 'svg') {\r\n            var svgClass = svgElm.getAttribute('class') || '';\r\n            svgElm.setAttribute('class', (svgClass + ' s-ion-icon').trim());\r\n            // root element must be an svg\r\n            // lets double check we've got valid elements\r\n            // do not allow scripts\r\n            if (isValid(svgElm)) {\r\n                return div.innerHTML;\r\n            }\r\n        }\r\n    }\r\n    return '';\r\n};\r\nvar isValid = function (elm) {\r\n    if (elm.nodeType === 1) {\r\n        if (elm.nodeName.toLowerCase() === 'script') {\r\n            return false;\r\n        }\r\n        for (var i = 0; i < elm.attributes.length; i++) {\r\n            var val = elm.attributes[i].value;\r\n            if (isStr(val) && val.toLowerCase().indexOf('on') === 0) {\r\n                return false;\r\n            }\r\n        }\r\n        for (var i = 0; i < elm.childNodes.length; i++) {\r\n            if (!isValid(elm.childNodes[i])) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n};\r\nvar ioniconContent = new Map();\r\nvar requests = new Map();\r\nvar getSvgContent = function (url) {\r\n    // see if we already have a request for this url\r\n    var req = requests.get(url);\r\n    if (!req) {\r\n        if (typeof fetch !== 'undefined') {\r\n            // we don't already have a request\r\n            req = fetch(url).then(function (rsp) {\r\n                if (rsp.ok) {\r\n                    return rsp.text().then(function (svgContent) {\r\n                        ioniconContent.set(url, validateContent(svgContent));\r\n                    });\r\n                }\r\n                ioniconContent.set(url, '');\r\n            });\r\n            // cache for the same requests\r\n            requests.set(url, req);\r\n        }\r\n        else {\r\n            // set to empty for ssr scenarios and resolve promise\r\n            ioniconContent.set(url, '');\r\n            return Promise.resolve();\r\n        }\r\n    }\r\n    return req;\r\n};\r\nvar Icon = /** @class */ (function () {\r\n    function Icon(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.isVisible = false;\r\n        /**\r\n         * The mode determines which platform styles to use.\r\n         */\r\n        this.mode = getIonMode();\r\n        /**\r\n         * If enabled, ion-icon will be loaded lazily when it's visible in the viewport.\r\n         * Default, `false`.\r\n         */\r\n        this.lazy = false;\r\n    }\r\n    Icon.prototype.connectedCallback = function () {\r\n        var _this_1 = this;\r\n        // purposely do not return the promise here because loading\r\n        // the svg file should not hold up loading the app\r\n        // only load the svg if it's visible\r\n        this.waitUntilVisible(this.el, '50px', function () {\r\n            _this_1.isVisible = true;\r\n            _this_1.loadIcon();\r\n        });\r\n    };\r\n    Icon.prototype.disconnectedCallback = function () {\r\n        if (this.io) {\r\n            this.io.disconnect();\r\n            this.io = undefined;\r\n        }\r\n    };\r\n    Icon.prototype.waitUntilVisible = function (el, rootMargin, cb) {\r\n        var _this_1 = this;\r\n        if (this.lazy && typeof window !== 'undefined' && window.IntersectionObserver) {\r\n            var io_1 = this.io = new window.IntersectionObserver(function (data) {\r\n                if (data[0].isIntersecting) {\r\n                    io_1.disconnect();\r\n                    _this_1.io = undefined;\r\n                    cb();\r\n                }\r\n            }, { rootMargin: rootMargin });\r\n            io_1.observe(el);\r\n        }\r\n        else {\r\n            // browser doesn't support IntersectionObserver\r\n            // so just fallback to always show it\r\n            cb();\r\n        }\r\n    };\r\n    Icon.prototype.loadIcon = function () {\r\n        var _this_1 = this;\r\n        if (this.isVisible) {\r\n            var url_1 = getUrl(this);\r\n            if (url_1) {\r\n                if (ioniconContent.has(url_1)) {\r\n                    // sync if it's already loaded\r\n                    this.svgContent = ioniconContent.get(url_1);\r\n                }\r\n                else {\r\n                    // async if it hasn't been loaded\r\n                    getSvgContent(url_1).then(function () { return _this_1.svgContent = ioniconContent.get(url_1); });\r\n                }\r\n            }\r\n        }\r\n        if (!this.ariaLabel) {\r\n            var label = getName(this.name, this.icon, this.mode, this.ios, this.md);\r\n            // user did not provide a label\r\n            // come up with the label based on the icon name\r\n            if (label) {\r\n                this.ariaLabel = label.replace(/\\-/g, ' ');\r\n            }\r\n        }\r\n    };\r\n    Icon.prototype.render = function () {\r\n        var _b, _c;\r\n        var mode = this.mode || 'md';\r\n        var flipRtl = this.flipRtl || (this.ariaLabel && (this.ariaLabel.indexOf('arrow') > -1 || this.ariaLabel.indexOf('chevron') > -1) && this.flipRtl !== false);\r\n        return (h(Host, { role: \"img\", class: Object.assign(Object.assign((_b = {}, _b[mode] = true, _b), createColorClasses(this.color)), (_c = {}, _c[\"icon-\" + this.size] = !!this.size, _c['flip-rtl'] = !!flipRtl && this.el.ownerDocument.dir === 'rtl', _c)) }, ((this.svgContent)\r\n            ? h(\"div\", { class: \"icon-inner\", innerHTML: this.svgContent })\r\n            : h(\"div\", { class: \"icon-inner\" }))));\r\n    };\r\n    Object.defineProperty(Icon, \"assetsDirs\", {\r\n        get: function () { return [\"svg\"]; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Icon.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Icon, \"watchers\", {\r\n        get: function () {\r\n            return {\r\n                \"name\": [\"loadIcon\"],\r\n                \"src\": [\"loadIcon\"],\r\n                \"icon\": [\"loadIcon\"]\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Icon, \"style\", {\r\n        get: function () { return \":host{display:inline-block;width:1em;height:1em;contain:strict;fill:currentColor;-webkit-box-sizing:content-box!important;box-sizing:content-box!important}:host .ionicon{stroke:currentColor}.ionicon-fill-none{fill:none}.ionicon-stroke-width{stroke-width:32px;stroke-width:var(--ionicon-stroke-width,32px)}.icon-inner,.ionicon,svg{display:block;height:100%;width:100%}:host(.flip-rtl) .icon-inner{-webkit-transform:scaleX(-1);transform:scaleX(-1)}:host(.icon-small){font-size:18px!important}:host(.icon-large){font-size:32px!important}:host(.ion-color){color:var(--ion-color-base)!important}:host(.ion-color-primary){--ion-color-base:var(--ion-color-primary,#3880ff)}:host(.ion-color-secondary){--ion-color-base:var(--ion-color-secondary,#0cd1e8)}:host(.ion-color-tertiary){--ion-color-base:var(--ion-color-tertiary,#f4a942)}:host(.ion-color-success){--ion-color-base:var(--ion-color-success,#10dc60)}:host(.ion-color-warning){--ion-color-base:var(--ion-color-warning,#ffce00)}:host(.ion-color-danger){--ion-color-base:var(--ion-color-danger,#f14141)}:host(.ion-color-light){--ion-color-base:var(--ion-color-light,#f4f5f8)}:host(.ion-color-medium){--ion-color-base:var(--ion-color-medium,#989aa2)}:host(.ion-color-dark){--ion-color-base:var(--ion-color-dark,#222428)}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Icon;\r\n}());\r\nvar getIonMode = function () { return (typeof document !== 'undefined' && document.documentElement.getAttribute('mode')) || 'md'; };\r\nvar createColorClasses = function (color) {\r\n    var _b;\r\n    return (color) ? (_b = {\r\n            'ion-color': true\r\n        },\r\n        _b[\"ion-color-\" + color] = true,\r\n        _b) : null;\r\n};\r\nvar InfiniteScroll = /** @class */ (function () {\r\n    function class_5(hostRef) {\r\n        var _this_1 = this;\r\n        registerInstance(this, hostRef);\r\n        this.thrPx = 0;\r\n        this.thrPc = 0;\r\n        this.didFire = false;\r\n        this.isBusy = false;\r\n        this.isLoading = false;\r\n        /**\r\n         * The threshold distance from the bottom\r\n         * of the content to call the `infinite` output event when scrolled.\r\n         * The threshold value can be either a percent, or\r\n         * in pixels. For example, use the value of `10%` for the `infinite`\r\n         * output event to get called when the user has scrolled 10%\r\n         * from the bottom of the page. Use the value `100px` when the\r\n         * scroll is within 100 pixels from the bottom of the page.\r\n         */\r\n        this.threshold = '15%';\r\n        /**\r\n         * If `true`, the infinite scroll will be hidden and scroll event listeners\r\n         * will be removed.\r\n         *\r\n         * Set this to true to disable the infinite scroll from actively\r\n         * trying to receive new data while scrolling. This is useful\r\n         * when it is known that there is no more data that can be added, and\r\n         * the infinite scroll is no longer needed.\r\n         */\r\n        this.disabled = false;\r\n        /**\r\n         * The position of the infinite scroll element.\r\n         * The value can be either `top` or `bottom`.\r\n         */\r\n        this.position = 'bottom';\r\n        this.onScroll = function () {\r\n            var scrollEl = _this_1.scrollEl;\r\n            if (!scrollEl || !_this_1.canStart()) {\r\n                return 1;\r\n            }\r\n            var infiniteHeight = _this_1.el.offsetHeight;\r\n            if (infiniteHeight === 0) {\r\n                // if there is no height of this element then do nothing\r\n                return 2;\r\n            }\r\n            var scrollTop = scrollEl.scrollTop;\r\n            var scrollHeight = scrollEl.scrollHeight;\r\n            var height = scrollEl.offsetHeight;\r\n            var threshold = _this_1.thrPc !== 0 ? (height * _this_1.thrPc) : _this_1.thrPx;\r\n            var distanceFromInfinite = (_this_1.position === 'bottom')\r\n                ? scrollHeight - infiniteHeight - scrollTop - threshold - height\r\n                : scrollTop - infiniteHeight - threshold;\r\n            if (distanceFromInfinite < 0) {\r\n                if (!_this_1.didFire) {\r\n                    _this_1.isLoading = true;\r\n                    _this_1.didFire = true;\r\n                    _this_1.ionInfinite.emit();\r\n                    return 3;\r\n                }\r\n            }\r\n            else {\r\n                _this_1.didFire = false;\r\n            }\r\n            return 4;\r\n        };\r\n        this.ionInfinite = createEvent(this, \"ionInfinite\", 7);\r\n    }\r\n    class_5.prototype.thresholdChanged = function () {\r\n        var val = this.threshold;\r\n        if (val.lastIndexOf('%') > -1) {\r\n            this.thrPx = 0;\r\n            this.thrPc = (parseFloat(val) / 100);\r\n        }\r\n        else {\r\n            this.thrPx = parseFloat(val);\r\n            this.thrPc = 0;\r\n        }\r\n    };\r\n    class_5.prototype.disabledChanged = function () {\r\n        var disabled = this.disabled;\r\n        if (disabled) {\r\n            this.isLoading = false;\r\n            this.isBusy = false;\r\n        }\r\n        this.enableScrollEvents(!disabled);\r\n    };\r\n    class_5.prototype.connectedCallback = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var contentEl, _b;\r\n            var _this_1 = this;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        contentEl = this.el.closest('ion-content');\r\n                        if (!contentEl) {\r\n                            console.error('<ion-infinite-scroll> must be used inside an <ion-content>');\r\n                            return [2 /*return*/];\r\n                        }\r\n                        _b = this;\r\n                        return [4 /*yield*/, contentEl.getScrollElement()];\r\n                    case 1:\r\n                        _b.scrollEl = _c.sent();\r\n                        this.thresholdChanged();\r\n                        this.disabledChanged();\r\n                        if (this.position === 'top') {\r\n                            writeTask(function () {\r\n                                if (_this_1.scrollEl) {\r\n                                    _this_1.scrollEl.scrollTop = _this_1.scrollEl.scrollHeight - _this_1.scrollEl.clientHeight;\r\n                                }\r\n                            });\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    class_5.prototype.disconnectedCallback = function () {\r\n        this.enableScrollEvents(false);\r\n        this.scrollEl = undefined;\r\n    };\r\n    /**\r\n     * Call `complete()` within the `ionInfinite` output event handler when\r\n     * your async operation has completed. For example, the `loading`\r\n     * state is while the app is performing an asynchronous operation,\r\n     * such as receiving more data from an AJAX request to add more items\r\n     * to a data list. Once the data has been received and UI updated, you\r\n     * then call this method to signify that the loading has completed.\r\n     * This method will change the infinite scroll's state from `loading`\r\n     * to `enabled`.\r\n     */\r\n    class_5.prototype.complete = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var scrollEl, prev_1;\r\n            var _this_1 = this;\r\n            return __generator(this, function (_b) {\r\n                scrollEl = this.scrollEl;\r\n                if (!this.isLoading || !scrollEl) {\r\n                    return [2 /*return*/];\r\n                }\r\n                this.isLoading = false;\r\n                if (this.position === 'top') {\r\n                    /**\r\n                     * New content is being added at the top, but the scrollTop position stays the same,\r\n                     * which causes a scroll jump visually. This algorithm makes sure to prevent this.\r\n                     * (Frame 1)\r\n                     *    - complete() is called, but the UI hasn't had time to update yet.\r\n                     *    - Save the current content dimensions.\r\n                     *    - Wait for the next frame using _dom.read, so the UI will be updated.\r\n                     * (Frame 2)\r\n                     *    - Read the new content dimensions.\r\n                     *    - Calculate the height difference and the new scroll position.\r\n                     *    - Delay the scroll position change until other possible dom reads are done using _dom.write to be performant.\r\n                     * (Still frame 2, if I'm correct)\r\n                     *    - Change the scroll position (= visually maintain the scroll position).\r\n                     *    - Change the state to re-enable the InfiniteScroll.\r\n                     *    - This should be after changing the scroll position, or it could\r\n                     *    cause the InfiniteScroll to be triggered again immediately.\r\n                     * (Frame 3)\r\n                     *    Done.\r\n                     */\r\n                    this.isBusy = true;\r\n                    prev_1 = scrollEl.scrollHeight - scrollEl.scrollTop;\r\n                    // ******** DOM READ ****************\r\n                    requestAnimationFrame(function () {\r\n                        readTask(function () {\r\n                            // UI has updated, save the new content dimensions\r\n                            var scrollHeight = scrollEl.scrollHeight;\r\n                            // New content was added on top, so the scroll position should be changed immediately to prevent it from jumping around\r\n                            var newScrollTop = scrollHeight - prev_1;\r\n                            // ******** DOM WRITE ****************\r\n                            requestAnimationFrame(function () {\r\n                                writeTask(function () {\r\n                                    scrollEl.scrollTop = newScrollTop;\r\n                                    _this_1.isBusy = false;\r\n                                });\r\n                            });\r\n                        });\r\n                    });\r\n                }\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    class_5.prototype.canStart = function () {\r\n        return (!this.disabled &&\r\n            !this.isBusy &&\r\n            !!this.scrollEl &&\r\n            !this.isLoading);\r\n    };\r\n    class_5.prototype.enableScrollEvents = function (shouldListen) {\r\n        if (this.scrollEl) {\r\n            if (shouldListen) {\r\n                this.scrollEl.addEventListener('scroll', this.onScroll);\r\n            }\r\n            else {\r\n                this.scrollEl.removeEventListener('scroll', this.onScroll);\r\n            }\r\n        }\r\n    };\r\n    class_5.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        var disabled = this.disabled;\r\n        return (h(Host, { class: (_b = {},\r\n                _b[mode] = true,\r\n                _b['infinite-scroll-loading'] = this.isLoading,\r\n                _b['infinite-scroll-enabled'] = !disabled,\r\n                _b) }));\r\n    };\r\n    Object.defineProperty(class_5.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_5, \"watchers\", {\r\n        get: function () {\r\n            return {\r\n                \"threshold\": [\"thresholdChanged\"],\r\n                \"disabled\": [\"disabledChanged\"]\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_5, \"style\", {\r\n        get: function () { return \"ion-infinite-scroll{display:none;width:100%}.infinite-scroll-enabled{display:block}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_5;\r\n}());\r\nvar InfiniteScrollContent = /** @class */ (function () {\r\n    function InfiniteScrollContent(hostRef) {\r\n        registerInstance(this, hostRef);\r\n    }\r\n    InfiniteScrollContent.prototype.componentDidLoad = function () {\r\n        if (this.loadingSpinner === undefined) {\r\n            var mode = getIonMode$1(this);\r\n            this.loadingSpinner = config.get('infiniteLoadingSpinner', config.get('spinner', mode === 'ios' ? 'lines' : 'crescent'));\r\n        }\r\n    };\r\n    InfiniteScrollContent.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        return (h(Host, { class: (_b = {},\r\n                _b[mode] = true,\r\n                // Used internally for styling\r\n                _b[\"infinite-scroll-content-\" + mode] = true,\r\n                _b) }, h(\"div\", { class: \"infinite-loading\" }, this.loadingSpinner && (h(\"div\", { class: \"infinite-loading-spinner\" }, h(\"ion-spinner\", { name: this.loadingSpinner }))), this.loadingText && (h(\"div\", { class: \"infinite-loading-text\", innerHTML: sanitizeDOMString(this.loadingText) })))));\r\n    };\r\n    Object.defineProperty(InfiniteScrollContent, \"style\", {\r\n        get: function () { return \"ion-infinite-scroll-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;min-height:84px;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.infinite-loading{margin-left:0;margin-right:0;margin-top:0;margin-bottom:32px;display:none;width:100%}.infinite-loading-text{margin-left:32px;margin-right:32px;margin-top:4px;margin-bottom:0}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.infinite-loading-text{margin-left:unset;margin-right:unset;-webkit-margin-start:32px;margin-inline-start:32px;-webkit-margin-end:32px;margin-inline-end:32px}}.infinite-scroll-loading ion-infinite-scroll-content>.infinite-loading{display:block}.infinite-scroll-content-ios .infinite-loading-text{color:var(--ion-color-step-600,#666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-crescent circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-ios line,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-lines-small-ios line{stroke:var(--ion-color-step-600,#666)}.infinite-scroll-content-ios .infinite-loading-spinner .spinner-bubbles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-circles circle,.infinite-scroll-content-ios .infinite-loading-spinner .spinner-dots circle{fill:var(--ion-color-step-600,#666)}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return InfiniteScrollContent;\r\n}());\r\nvar Item = /** @class */ (function () {\r\n    function Item(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.itemStyles = new Map();\r\n        this.multipleInputs = false;\r\n        /**\r\n         * If `true`, a button tag will be rendered and the item will be tappable.\r\n         */\r\n        this.button = false;\r\n        /**\r\n         * The icon to use when `detail` is set to `true`.\r\n         */\r\n        this.detailIcon = 'chevron-forward';\r\n        /**\r\n         * If `true`, the user cannot interact with the item.\r\n         */\r\n        this.disabled = false;\r\n        /**\r\n         * When using a router, it specifies the transition direction when navigating to\r\n         * another page using `href`.\r\n         */\r\n        this.routerDirection = 'forward';\r\n        /**\r\n         * The type of the button. Only used when an `onclick` or `button` property is present.\r\n         */\r\n        this.type = 'button';\r\n    }\r\n    Item.prototype.itemStyle = function (ev) {\r\n        ev.stopPropagation();\r\n        var tagName = ev.target.tagName;\r\n        var updatedStyles = ev.detail;\r\n        var newStyles = {};\r\n        var childStyles = this.itemStyles.get(tagName) || {};\r\n        var hasStyleChange = false;\r\n        Object.keys(updatedStyles).forEach(function (key) {\r\n            if (updatedStyles[key]) {\r\n                var itemKey = \"item-\" + key;\r\n                if (!childStyles[itemKey]) {\r\n                    hasStyleChange = true;\r\n                }\r\n                newStyles[itemKey] = true;\r\n            }\r\n        });\r\n        if (!hasStyleChange && Object.keys(newStyles).length !== Object.keys(childStyles).length) {\r\n            hasStyleChange = true;\r\n        }\r\n        if (hasStyleChange) {\r\n            this.itemStyles.set(tagName, newStyles);\r\n            this.el.forceUpdate();\r\n        }\r\n    };\r\n    Item.prototype.componentDidLoad = function () {\r\n        // The following elements have a clickable cover that is relative to the entire item\r\n        var covers = this.el.querySelectorAll('ion-checkbox, ion-datetime, ion-select, ion-radio');\r\n        // The following elements can accept focus alongside the previous elements\r\n        // therefore if these elements are also a child of item, we don't want the\r\n        // input cover on top of those interfering with their clicks\r\n        var inputs = this.el.querySelectorAll('ion-input, ion-range, ion-searchbar, ion-segment, ion-textarea, ion-toggle');\r\n        // The following elements should also stay clickable when an input with cover is present\r\n        var clickables = this.el.querySelectorAll('ion-anchor, ion-button, a, button');\r\n        // Check for multiple inputs to change the position of the input cover to relative\r\n        // for all of the covered inputs above\r\n        this.multipleInputs = covers.length + inputs.length > 1\r\n            || covers.length + clickables.length > 1\r\n            || covers.length > 0 && this.isClickable();\r\n    };\r\n    // If the item contains an input including a checkbox, datetime, select, or radio\r\n    // then the item will have a clickable input cover that covers the item\r\n    // that should get the hover, focused and activated states UNLESS it has multiple\r\n    // inputs, then those need to individually get each click\r\n    Item.prototype.hasCover = function () {\r\n        var inputs = this.el.querySelectorAll('ion-checkbox, ion-datetime, ion-select, ion-radio');\r\n        return inputs.length === 1 && !this.multipleInputs;\r\n    };\r\n    // If the item has an href or button property it will render a native\r\n    // anchor or button that is clickable\r\n    Item.prototype.isClickable = function () {\r\n        return (this.href !== undefined || this.button);\r\n    };\r\n    Item.prototype.canActivate = function () {\r\n        return (this.isClickable() || this.hasCover());\r\n    };\r\n    Item.prototype.render = function () {\r\n        var _b;\r\n        var _c = this, detail = _c.detail, detailIcon = _c.detailIcon, download = _c.download, lines = _c.lines, disabled = _c.disabled, href = _c.href, rel = _c.rel, target = _c.target, routerDirection = _c.routerDirection;\r\n        var childStyles = {};\r\n        var mode = getIonMode$1(this);\r\n        var clickable = this.isClickable();\r\n        var canActivate = this.canActivate();\r\n        var TagType = clickable ? (href === undefined ? 'button' : 'a') : 'div';\r\n        var attrs = (TagType === 'button')\r\n            ? { type: this.type }\r\n            : {\r\n                download: download,\r\n                href: href,\r\n                rel: rel,\r\n                target: target\r\n            };\r\n        var showDetail = detail !== undefined ? detail : mode === 'ios' && clickable;\r\n        this.itemStyles.forEach(function (value) {\r\n            Object.assign(childStyles, value);\r\n        });\r\n        return (h(Host, { \"aria-disabled\": disabled ? 'true' : null, class: Object.assign(Object.assign(Object.assign({}, childStyles), createColorClasses$1(this.color)), (_b = { 'item': true }, _b[mode] = true, _b[\"item-lines-\" + lines] = lines !== undefined, _b['item-disabled'] = disabled, _b['in-list'] = hostContext('ion-list', this.el), _b['item-multiple-inputs'] = this.multipleInputs, _b['ion-activatable'] = canActivate, _b['ion-focusable'] = true, _b)) }, h(TagType, Object.assign({}, attrs, { class: \"item-native\", disabled: disabled, onClick: function (ev) { return openURL(href, ev, routerDirection); } }), h(\"slot\", { name: \"start\" }), h(\"div\", { class: \"item-inner\" }, h(\"div\", { class: \"input-wrapper\" }, h(\"slot\", null)), h(\"slot\", { name: \"end\" }), showDetail && h(\"ion-icon\", { icon: detailIcon, lazy: false, class: \"item-detail-icon\" }), h(\"div\", { class: \"item-inner-highlight\" })), canActivate && mode === 'md' && h(\"ion-ripple-effect\", null)), h(\"div\", { class: \"item-highlight\" })));\r\n    };\r\n    Object.defineProperty(Item.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Item, \"style\", {\r\n        get: function () { return \":host{--border-radius:0px;--border-width:0px;--border-style:solid;--padding-top:0px;--padding-bottom:0px;--padding-end:0px;--padding-start:0px;--inner-border-width:0px;--inner-padding-top:0px;--inner-padding-bottom:0px;--inner-padding-start:0px;--inner-padding-end:0px;--inner-box-shadow:none;--show-full-highlight:0;--show-inset-highlight:0;--detail-icon-color:initial;--detail-icon-font-size:20px;--detail-icon-opacity:0.25;--color-activated:var(--color);--color-focused:var(--color);--color-hover:var(--color);--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:block;position:relative;outline:none;color:var(--color);font-family:var(--ion-font-family,inherit);text-align:initial;text-decoration:none;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}:host(.ion-color) .item-native{background:var(--ion-color-base);color:var(--ion-color-contrast)}:host(.ion-color) .item-inner,:host(.ion-color) .item-native{border-color:var(--ion-color-shade)}:host(.ion-activated) .item-native{color:var(--color-activated)}:host(.ion-activated) .item-native:after{background:var(--background-activated);opacity:var(--background-activated-opacity)}:host(.ion-color.ion-activated) .item-native{color:var(--ion-color-contrast)}:host(.ion-focused) .item-native{color:var(--color-focused)}:host(.ion-focused) .item-native:after{background:var(--background-focused);opacity:var(--background-focused-opacity)}:host(.ion-color.ion-focused) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-focused) .item-native:after{background:var(--ion-color-contrast)}\\@media (any-hover:hover){:host(.ion-activatable:hover) .item-native{color:var(--color-hover)}:host(.ion-activatable:hover) .item-native:after{background:var(--background-hover);opacity:var(--background-hover-opacity)}:host(.ion-color.ion-activatable:hover) .item-native{color:var(--ion-color-contrast)}:host(.ion-color.ion-activatable:hover) .item-native:after{background:var(--ion-color-contrast)}}:host(.item-disabled),:host(.item-interactive-disabled:not(.item-multiple-inputs)){cursor:default;pointer-events:none}:host(.item-disabled){opacity:.3}.item-native{border-radius:var(--border-radius);margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);font-family:inherit;font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:var(--min-height);-webkit-transition:var(--transition);transition:var(--transition);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);outline:none;background:var(--background);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.item-native{padding-left:unset;padding-right:unset;-webkit-padding-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));padding-inline-start:calc(var(--padding-start) + var(--ion-safe-area-left, 0px));-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.item-native::-moz-focus-inner{border:0}.item-native:after{left:0;right:0;top:0;bottom:0;position:absolute;content:\\\"\\\";opacity:0;-webkit-transition:var(--transition);transition:var(--transition);z-index:-1}a,button{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-user-drag:none}.item-inner{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:var(--inner-padding-start);padding-right:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-top:var(--inner-padding-top);padding-bottom:var(--inner-padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;min-height:inherit;border-width:var(--inner-border-width);border-style:var(--border-style);border-color:var(--border-color);-webkit-box-shadow:var(--inner-box-shadow);box-shadow:var(--inner-box-shadow);overflow:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.item-inner{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--inner-padding-start);padding-inline-start:var(--inner-padding-start);-webkit-padding-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end));padding-inline-end:calc(var(--ion-safe-area-right, 0px) + var(--inner-padding-end))}}.item-detail-icon{color:var(--detail-icon-color);font-size:var(--detail-icon-font-size);opacity:var(--detail-icon-opacity)}::slotted(ion-icon){font-size:1.6em}::slotted(ion-button){--margin-top:0;--margin-bottom:0;--margin-start:0;--margin-end:0;z-index:1}::slotted(ion-label){-ms-flex:1;flex:1}:host(.item-input),:host([vertical-align-top]){-ms-flex-align:start;align-items:flex-start}.input-wrapper{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:inherit;flex-direction:inherit;-ms-flex-align:inherit;align-items:inherit;-ms-flex-item-align:stretch;align-self:stretch;text-overflow:ellipsis;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}:host(.item-label-floating) .item-native,:host(.item-label-stacked) .item-native{-ms-flex-align:start;align-items:start}:host(.item-label-floating) .input-wrapper,:host(.item-label-stacked) .input-wrapper{-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column}.item-highlight,.item-inner-highlight{left:0;right:0;bottom:0;position:absolute;background:var(--highlight-background);z-index:1}.item-highlight{height:var(--full-highlight-height)}.item-inner-highlight{height:var(--inset-highlight-height)}:host(.item-interactive.ion-touched.ion-invalid),:host(.item-interactive.item-has-focus){--full-highlight-height:calc(var(--highlight-height) * var(--show-full-highlight));--inset-highlight-height:calc(var(--highlight-height) * var(--show-inset-highlight))}:host(.item-interactive.item-has-focus){--highlight-background:var(--highlight-color-focused)}:host(.item-interactive.ion-valid){--highlight-background:var(--highlight-color-valid)}:host(.item-interactive.ion-invalid){--highlight-background:var(--highlight-color-invalid)}:host(.item-label-floating) ::slotted(ion-select),:host(.item-label-stacked) ::slotted(ion-select){--padding-start:0;-ms-flex-item-align:stretch;align-self:stretch;width:100%;max-width:100%}:host(.item-label-floating) ::slotted(ion-datetime),:host(.item-label-stacked) ::slotted(ion-datetime){--padding-start:0;width:100%}:host(.item-multiple-inputs) ::slotted(ion-checkbox),:host(.item-multiple-inputs) ::slotted(ion-datetime),:host(.item-multiple-inputs) ::slotted(ion-radio),:host(.item-multiple-inputs) ::slotted(ion-select){position:relative}:host(.item-textarea){-ms-flex-align:stretch;align-items:stretch}::slotted(ion-reorder[slot]){margin-top:0;margin-bottom:0}ion-ripple-effect{color:var(--ripple-color)}:host{--min-height:44px;--transition:background-color 200ms linear,opacity 200ms linear;--padding-start:20px;--inner-padding-end:10px;--inner-border-width:0px 0px 0.55px 0px;--background:var(--ion-item-background,var(--ion-background-color,#fff));--background-activated:#000;--background-focused:#000;--background-hover:currentColor;--background-activated-opacity:.12;--background-focused-opacity:.15;--background-hover-opacity:.04;--border-color:var(--ion-item-border-color,var(--ion-border-color,var(--ion-color-step-250,#c8c7cc)));--color:var(--ion-item-color,var(--ion-text-color,#000));--highlight-height:0;--highlight-color-focused:var(--ion-color-primary,#3880ff);--highlight-color-valid:var(--ion-color-success,#2dd36f);--highlight-color-invalid:var(--ion-color-danger,#eb445a);font-size:17px}:host(.ion-activated){--transition:none}:host(.ion-color.ion-focused) .item-native:after{background:#000;opacity:.15}:host(.ion-color.ion-activated) .item-native:after{background:#000;opacity:.12}:host(.item-interactive){--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-full){--border-width:0px 0px 0.55px 0px;--show-full-highlight:1;--show-inset-highlight:0}:host(.item-lines-inset){--inner-border-width:0px 0px 0.55px 0px;--show-full-highlight:0;--show-inset-highlight:1}:host(.item-lines-inset),:host(.item-lines-none){--border-width:0px;--show-full-highlight:0}:host(.item-lines-full),:host(.item-lines-none){--inner-border-width:0px;--show-inset-highlight:0}::slotted([slot=start]){margin-left:0;margin-right:20px;margin-top:2px;margin-bottom:2px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){::slotted([slot=start]){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:20px;margin-inline-end:20px}}::slotted([slot=end]){margin-left:10px;margin-right:10px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){::slotted([slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}::slotted(ion-icon[slot=end]),::slotted(ion-icon[slot=start]){margin-top:7px;margin-bottom:7px}::slotted(ion-toggle[slot=end]),::slotted(ion-toggle[slot=start]){margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}:host(.item-label-floating) ::slotted([slot=end]),:host(.item-label-stacked) ::slotted([slot=end]){margin-top:7px;margin-bottom:7px}::slotted(.button-small){--padding-top:0px;--padding-bottom:0px;--padding-start:.5em;--padding-end:.5em;height:24px;font-size:13px}::slotted(ion-avatar){width:36px;height:36px}::slotted(ion-thumbnail){width:56px;height:56px}::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:10px;margin-right:10px;margin-top:10px;margin-bottom:10px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){::slotted(ion-avatar[slot=end]),::slotted(ion-thumbnail[slot=end]){margin-left:unset;margin-right:unset;-webkit-margin-start:10px;margin-inline-start:10px;-webkit-margin-end:10px;margin-inline-end:10px}}:host(.item-radio) ::slotted(ion-label),:host(.item-toggle) ::slotted(ion-label){margin-left:0}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){:host(.item-radio) ::slotted(ion-label),:host(.item-toggle) ::slotted(ion-label){margin-left:unset;-webkit-margin-start:0;margin-inline-start:0}}::slotted(ion-label){margin-left:0;margin-right:8px;margin-top:10px;margin-bottom:10px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){::slotted(ion-label){margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}:host(.item-label-floating),:host(.item-label-stacked){--min-height:68px}:host(.item-label-floating) ::slotted(ion-select),:host(.item-label-stacked) ::slotted(ion-select){--padding-top:8px;--padding-bottom:8px;--padding-start:0px}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Item;\r\n}());\r\nvar Label = /** @class */ (function () {\r\n    function Label(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.noAnimate = false;\r\n        this.ionStyle = createEvent(this, \"ionStyle\", 7);\r\n    }\r\n    Label.prototype.componentWillLoad = function () {\r\n        this.noAnimate = (this.position === 'floating');\r\n        this.emitStyle();\r\n    };\r\n    Label.prototype.componentDidLoad = function () {\r\n        var _this_1 = this;\r\n        if (this.noAnimate) {\r\n            setTimeout(function () {\r\n                _this_1.noAnimate = false;\r\n            }, 1000);\r\n        }\r\n    };\r\n    Label.prototype.positionChanged = function () {\r\n        this.emitStyle();\r\n    };\r\n    Label.prototype.emitStyle = function () {\r\n        var _b;\r\n        var position = this.position;\r\n        this.ionStyle.emit((_b = {\r\n                'label': true\r\n            },\r\n            _b[\"label-\" + position] = position !== undefined,\r\n            _b));\r\n    };\r\n    Label.prototype.render = function () {\r\n        var _b;\r\n        var position = this.position;\r\n        var mode = getIonMode$1(this);\r\n        return (h(Host, { class: Object.assign(Object.assign({}, createColorClasses$1(this.color)), (_b = {}, _b[mode] = true, _b[\"label-\" + position] = position !== undefined, _b[\"label-no-animate\"] = (this.noAnimate), _b)) }));\r\n    };\r\n    Object.defineProperty(Label.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Label, \"watchers\", {\r\n        get: function () {\r\n            return {\r\n                \"position\": [\"positionChanged\"]\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Label, \"style\", {\r\n        get: function () { return \".item.sc-ion-label-ios-h, .item .sc-ion-label-ios-h{--color:initial;display:block;color:var(--color);font-family:var(--ion-font-family,inherit);font-size:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-label-ios-h{color:var(--ion-color-base)}.ion-text-wrap.sc-ion-label-ios-h, [text-wrap].sc-ion-label-ios-h{white-space:normal}.item-interactive-disabled.sc-ion-label-ios-h:not(.item-multiple-inputs), .item-interactive-disabled:not(.item-multiple-inputs) .sc-ion-label-ios-h{cursor:default;opacity:.3;pointer-events:none}.item-input.sc-ion-label-ios-h, .item-input .sc-ion-label-ios-h{-ms-flex:initial;flex:initial;max-width:200px;pointer-events:none}.item-textarea.sc-ion-label-ios-h, .item-textarea .sc-ion-label-ios-h{-ms-flex-item-align:baseline;align-self:baseline}.label-fixed.sc-ion-label-ios-h{-ms-flex:0 0 100px;flex:0 0 100px;width:100px;min-width:100px;max-width:200px}.label-floating.sc-ion-label-ios-h, .label-stacked.sc-ion-label-ios-h{margin-bottom:0;-ms-flex-item-align:stretch;align-self:stretch;width:auto;max-width:100%}.label-no-animate.label-floating.sc-ion-label-ios-h{-webkit-transition:none;transition:none}.sc-ion-label-ios-s  h1 , .sc-ion-label-ios-s  h2 , .sc-ion-label-ios-s  h3 , .sc-ion-label-ios-s  h4 , .sc-ion-label-ios-s  h5 , .sc-ion-label-ios-s  h6 {text-overflow:inherit;overflow:inherit}.ion-text-wrap.sc-ion-label-ios-h, [text-wrap].sc-ion-label-ios-h{font-size:14px;line-height:1.5}.label-stacked.sc-ion-label-ios-h{margin-bottom:4px;font-size:14px}.label-floating.sc-ion-label-ios-h{margin-bottom:0;-webkit-transform:translate3d(0,27px,0);transform:translate3d(0,27px,0);-webkit-transform-origin:left top;transform-origin:left top;-webkit-transition:-webkit-transform .15s ease-in-out;transition:-webkit-transform .15s ease-in-out;transition:transform .15s ease-in-out;transition:transform .15s ease-in-out,-webkit-transform .15s ease-in-out}[dir=rtl].label-floating.sc-ion-label-ios-h, [dir=rtl] .label-floating.sc-ion-label-ios-h, [dir=rtl].sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h, [dir=rtl] .sc-ion-label-ios-h -no-combinator.label-floating.sc-ion-label-ios-h{-webkit-transform-origin:right top;transform-origin:right top}.item-has-focus.label-floating.sc-ion-label-ios-h, .item-has-focus .label-floating.sc-ion-label-ios-h, .item-has-placeholder.label-floating.sc-ion-label-ios-h, .item-has-placeholder .label-floating.sc-ion-label-ios-h, .item-has-value.label-floating.sc-ion-label-ios-h, .item-has-value .label-floating.sc-ion-label-ios-h{-webkit-transform:translateZ(0) scale(.82);transform:translateZ(0) scale(.82)}.sc-ion-label-ios-s  h1 {margin-top:3px;font-size:22px}.sc-ion-label-ios-s  h1 , .sc-ion-label-ios-s  h2 {margin-left:0;margin-right:0;margin-bottom:2px;font-weight:400}.sc-ion-label-ios-s  h2 {margin-top:0;font-size:17px}.sc-ion-label-ios-s  h3 , .sc-ion-label-ios-s  h4 , .sc-ion-label-ios-s  h5 , .sc-ion-label-ios-s  h6 {margin-left:0;margin-right:0;margin-top:0;margin-bottom:3px;font-size:14px;font-weight:400;line-height:normal}.sc-ion-label-ios-s  p {margin-left:0;margin-right:0;margin-top:0;margin-bottom:2px;font-size:14px;line-height:normal;text-overflow:inherit;overflow:inherit}.sc-ion-label-ios-s > p{color:rgba(var(--ion-text-color-rgb,0,0,0),.4)}.sc-ion-label-ios-h.ion-color.sc-ion-label-ios-s > p, .ion-color .sc-ion-label-ios-h.sc-ion-label-ios-s > p{color:inherit}.sc-ion-label-ios-s  h2:last-child , .sc-ion-label-ios-s  h3:last-child , .sc-ion-label-ios-s  h4:last-child , .sc-ion-label-ios-s  h5:last-child , .sc-ion-label-ios-s  h6:last-child , .sc-ion-label-ios-s  p:last-child {margin-bottom:0}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Label;\r\n}());\r\nvar List = /** @class */ (function () {\r\n    function class_6(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        /**\r\n         * If `true`, the list will have margin around it and rounded corners.\r\n         */\r\n        this.inset = false;\r\n    }\r\n    /**\r\n     * If `ion-item-sliding` are used inside the list, this method closes\r\n     * any open sliding item.\r\n     *\r\n     * Returns `true` if an actual `ion-item-sliding` is closed.\r\n     */\r\n    class_6.prototype.closeSlidingItems = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var item;\r\n            return __generator(this, function (_b) {\r\n                item = this.el.querySelector('ion-item-sliding');\r\n                if (item && item.closeOpened) {\r\n                    return [2 /*return*/, item.closeOpened()];\r\n                }\r\n                return [2 /*return*/, false];\r\n            });\r\n        });\r\n    };\r\n    class_6.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        var _c = this, lines = _c.lines, inset = _c.inset;\r\n        return (h(Host, { class: (_b = {},\r\n                _b[mode] = true,\r\n                // Used internally for styling\r\n                _b[\"list-\" + mode] = true,\r\n                _b['list-inset'] = inset,\r\n                _b[\"list-lines-\" + lines] = lines !== undefined,\r\n                _b[\"list-\" + mode + \"-lines-\" + lines] = lines !== undefined,\r\n                _b) }));\r\n    };\r\n    Object.defineProperty(class_6.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_6, \"style\", {\r\n        get: function () { return \"ion-list{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:block;contain:content;list-style-type:none}ion-list.list-inset{-webkit-transform:translateZ(0);transform:translateZ(0);overflow:hidden}.list-ios{margin-left:0;margin-right:0;margin-top:-1px;margin-bottom:0;background:var(--ion-item-background,var(--ion-background-color,#fff))}.list-ios.list-inset{margin-left:16px;margin-right:16px;margin-top:16px;margin-bottom:16px;border-radius:4px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.list-ios.list-inset{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:16px;margin-inline-end:16px}}.list-ios.list-inset ion-item{--border-width:0 0 1px 0;--inner-border-width:0}.list-ios.list-inset ion-item:last-child{--border-width:0;--inner-border-width:0}.list-ios.list-inset+ion-list.list-inset{margin-top:0}.list-ios-lines-none .item{--border-width:0;--inner-border-width:0}.list-ios-lines-full .item,.list-ios .item-lines-full{--border-width:0 0 0.55px 0}.list-ios-lines-full .item{--inner-border-width:0}.list-ios-lines-inset .item,.list-ios .item-lines-inset{--inner-border-width:0 0 0.55px 0}.list-ios .item-lines-inset{--border-width:0}.list-ios .item-lines-full{--inner-border-width:0}.list-ios .item-lines-none{--border-width:0;--inner-border-width:0}ion-card .list-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_6;\r\n}());\r\nvar RippleEffect = /** @class */ (function () {\r\n    function class_7(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        /**\r\n         * Sets the type of ripple-effect:\r\n         *\r\n         * - `bounded`: the ripple effect expands from the user's click position\r\n         * - `unbounded`: the ripple effect expands from the center of the button and overflows the container.\r\n         *\r\n         * NOTE: Surfaces for bounded ripples should have the overflow property set to hidden,\r\n         * while surfaces for unbounded ripples should have it set to visible.\r\n         */\r\n        this.type = 'bounded';\r\n    }\r\n    /**\r\n     * Adds the ripple effect to the parent element.\r\n     *\r\n     * @param x The horizontal coordinate of where the ripple should start.\r\n     * @param y The vertical coordinate of where the ripple should start.\r\n     */\r\n    class_7.prototype.addRipple = function (x, y) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this_1 = this;\r\n            return __generator(this, function (_b) {\r\n                return [2 /*return*/, new Promise(function (resolve) {\r\n                        readTask(function () {\r\n                            var rect = _this_1.el.getBoundingClientRect();\r\n                            var width = rect.width;\r\n                            var height = rect.height;\r\n                            var hypotenuse = Math.sqrt(width * width + height * height);\r\n                            var maxDim = Math.max(height, width);\r\n                            var maxRadius = _this_1.unbounded ? maxDim : hypotenuse + PADDING;\r\n                            var initialSize = Math.floor(maxDim * INITIAL_ORIGIN_SCALE);\r\n                            var finalScale = maxRadius / initialSize;\r\n                            var posX = x - rect.left;\r\n                            var posY = y - rect.top;\r\n                            if (_this_1.unbounded) {\r\n                                posX = width * 0.5;\r\n                                posY = height * 0.5;\r\n                            }\r\n                            var styleX = posX - initialSize * 0.5;\r\n                            var styleY = posY - initialSize * 0.5;\r\n                            var moveX = width * 0.5 - posX;\r\n                            var moveY = height * 0.5 - posY;\r\n                            writeTask(function () {\r\n                                var div = document.createElement('div');\r\n                                div.classList.add('ripple-effect');\r\n                                var style = div.style;\r\n                                style.top = styleY + 'px';\r\n                                style.left = styleX + 'px';\r\n                                style.width = style.height = initialSize + 'px';\r\n                                style.setProperty('--final-scale', \"\" + finalScale);\r\n                                style.setProperty('--translate-end', moveX + \"px, \" + moveY + \"px\");\r\n                                var container = _this_1.el.shadowRoot || _this_1.el;\r\n                                container.appendChild(div);\r\n                                setTimeout(function () {\r\n                                    resolve(function () {\r\n                                        removeRipple(div);\r\n                                    });\r\n                                }, 225 + 100);\r\n                            });\r\n                        });\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    Object.defineProperty(class_7.prototype, \"unbounded\", {\r\n        get: function () {\r\n            return this.type === 'unbounded';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    class_7.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        return (h(Host, { role: \"presentation\", class: (_b = {},\r\n                _b[mode] = true,\r\n                _b['unbounded'] = this.unbounded,\r\n                _b) }));\r\n    };\r\n    Object.defineProperty(class_7.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_7, \"style\", {\r\n        get: function () { return \":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:rippleAnimation 225ms forwards,fadeInAnimation 75ms forwards;animation:rippleAnimation 225ms forwards,fadeInAnimation 75ms forwards;will-change:transform,opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale,1));transform:translate(var(--translate-end)) scale(var(--final-scale,1));-webkit-animation:fadeOutAnimation .15s forwards;animation:fadeOutAnimation .15s forwards}\\@-webkit-keyframes rippleAnimation{0%{-webkit-animation-timing-function:cubic-bezier(.4,0,.2,1);animation-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale,1));transform:translate(var(--translate-end)) scale(var(--final-scale,1))}}\\@keyframes rippleAnimation{0%{-webkit-animation-timing-function:cubic-bezier(.4,0,.2,1);animation-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale,1));transform:translate(var(--translate-end)) scale(var(--final-scale,1))}}\\@-webkit-keyframes fadeInAnimation{0%{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:.16}}\\@keyframes fadeInAnimation{0%{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:.16}}\\@-webkit-keyframes fadeOutAnimation{0%{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:.16}to{opacity:0}}\\@keyframes fadeOutAnimation{0%{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:.16}to{opacity:0}}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_7;\r\n}());\r\nvar removeRipple = function (ripple) {\r\n    ripple.classList.add('fade-out');\r\n    setTimeout(function () {\r\n        ripple.remove();\r\n    }, 200);\r\n};\r\nvar PADDING = 10;\r\nvar INITIAL_ORIGIN_SCALE = 0.5;\r\nvar Searchbar = /** @class */ (function () {\r\n    function class_8(hostRef) {\r\n        var _this_1 = this;\r\n        registerInstance(this, hostRef);\r\n        this.isCancelVisible = false;\r\n        this.shouldAlignLeft = true;\r\n        this.focused = false;\r\n        this.noAnimate = true;\r\n        /**\r\n         * If `true`, enable searchbar animation.\r\n         */\r\n        this.animated = false;\r\n        /**\r\n         * Set the input's autocomplete property.\r\n         */\r\n        this.autocomplete = 'off';\r\n        /**\r\n         * Set the input's autocorrect property.\r\n         */\r\n        this.autocorrect = 'off';\r\n        /**\r\n         * Set the cancel button icon. Only applies to `md` mode.\r\n         * Defaults to `\"arrow-back-sharp\"`.\r\n         */\r\n        this.cancelButtonIcon = config.get('backButtonIcon', 'arrow-back-sharp');\r\n        /**\r\n         * Set the the cancel button text. Only applies to `ios` mode.\r\n         */\r\n        this.cancelButtonText = 'Cancel';\r\n        /**\r\n         * Set the amount of time, in milliseconds, to wait to trigger the `ionChange` event after each keystroke.\r\n         */\r\n        this.debounce = 250;\r\n        /**\r\n         * If `true`, the user cannot interact with the input.\r\n         */\r\n        this.disabled = false;\r\n        /**\r\n         * Set the input's placeholder.\r\n         * `placeholder` can accept either plaintext or HTML as a string.\r\n         * To display characters normally reserved for HTML, they\r\n         * must be escaped. For example `<Ionic>` would become\r\n         * `&lt;Ionic&gt;`\r\n         *\r\n         * For more information: [Security Documentation](https://ionicframework.com/docs/faq/security)\r\n         */\r\n        this.placeholder = 'Search';\r\n        /**\r\n         * Sets the behavior for the cancel button. Defaults to `\"never\"`.\r\n         * Setting to `\"focus\"` shows the cancel button on focus.\r\n         * Setting to `\"never\"` hides the cancel button.\r\n         * Setting to `\"always\"` shows the cancel button regardless\r\n         * of focus state.\r\n         */\r\n        this.showCancelButton = 'never';\r\n        /**\r\n         * If `true`, enable spellcheck on the input.\r\n         */\r\n        this.spellcheck = false;\r\n        /**\r\n         * Set the type of the input.\r\n         */\r\n        this.type = 'search';\r\n        /**\r\n         * the value of the searchbar.\r\n         */\r\n        this.value = '';\r\n        /**\r\n         * Clears the input field and triggers the control change.\r\n         */\r\n        this.onClearInput = function (ev) {\r\n            _this_1.ionClear.emit();\r\n            if (ev) {\r\n                ev.preventDefault();\r\n                ev.stopPropagation();\r\n            }\r\n            // setTimeout() fixes https://github.com/ionic-team/ionic/issues/7527\r\n            // wait for 4 frames\r\n            setTimeout(function () {\r\n                var value = _this_1.getValue();\r\n                if (value !== '') {\r\n                    _this_1.value = '';\r\n                    _this_1.ionInput.emit();\r\n                }\r\n            }, 16 * 4);\r\n        };\r\n        /**\r\n         * Clears the input field and tells the input to blur since\r\n         * the clearInput function doesn't want the input to blur\r\n         * then calls the custom cancel function if the user passed one in.\r\n         */\r\n        this.onCancelSearchbar = function (ev) {\r\n            if (ev) {\r\n                ev.preventDefault();\r\n                ev.stopPropagation();\r\n            }\r\n            _this_1.ionCancel.emit();\r\n            _this_1.onClearInput();\r\n            if (_this_1.nativeInput) {\r\n                _this_1.nativeInput.blur();\r\n            }\r\n        };\r\n        /**\r\n         * Update the Searchbar input value when the input changes\r\n         */\r\n        this.onInput = function (ev) {\r\n            var input = ev.target;\r\n            if (input) {\r\n                _this_1.value = input.value;\r\n            }\r\n            _this_1.ionInput.emit(ev);\r\n        };\r\n        /**\r\n         * Sets the Searchbar to not focused and checks if it should align left\r\n         * based on whether there is a value in the searchbar or not.\r\n         */\r\n        this.onBlur = function () {\r\n            _this_1.focused = false;\r\n            _this_1.ionBlur.emit();\r\n            _this_1.positionElements();\r\n        };\r\n        /**\r\n         * Sets the Searchbar to focused and active on input focus.\r\n         */\r\n        this.onFocus = function () {\r\n            _this_1.focused = true;\r\n            _this_1.ionFocus.emit();\r\n            _this_1.positionElements();\r\n        };\r\n        this.ionInput = createEvent(this, \"ionInput\", 7);\r\n        this.ionChange = createEvent(this, \"ionChange\", 7);\r\n        this.ionCancel = createEvent(this, \"ionCancel\", 7);\r\n        this.ionClear = createEvent(this, \"ionClear\", 7);\r\n        this.ionBlur = createEvent(this, \"ionBlur\", 7);\r\n        this.ionFocus = createEvent(this, \"ionFocus\", 7);\r\n        this.ionStyle = createEvent(this, \"ionStyle\", 7);\r\n    }\r\n    class_8.prototype.debounceChanged = function () {\r\n        this.ionChange = debounceEvent(this.ionChange, this.debounce);\r\n    };\r\n    class_8.prototype.valueChanged = function () {\r\n        var inputEl = this.nativeInput;\r\n        var value = this.getValue();\r\n        if (inputEl && inputEl.value !== value) {\r\n            inputEl.value = value;\r\n        }\r\n        this.ionChange.emit({ value: value });\r\n    };\r\n    class_8.prototype.showCancelButtonChanged = function () {\r\n        var _this_1 = this;\r\n        requestAnimationFrame(function () {\r\n            _this_1.positionElements();\r\n            _this_1.el.forceUpdate();\r\n        });\r\n    };\r\n    class_8.prototype.connectedCallback = function () {\r\n        this.emitStyle();\r\n    };\r\n    class_8.prototype.componentDidLoad = function () {\r\n        var _this_1 = this;\r\n        this.positionElements();\r\n        this.debounceChanged();\r\n        setTimeout(function () {\r\n            _this_1.noAnimate = false;\r\n        }, 300);\r\n    };\r\n    class_8.prototype.emitStyle = function () {\r\n        this.ionStyle.emit({\r\n            'searchbar': true\r\n        });\r\n    };\r\n    /**\r\n     * Sets focus on the specified `ion-searchbar`. Use this method instead of the global\r\n     * `input.focus()`.\r\n     */\r\n    class_8.prototype.setFocus = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_b) {\r\n                if (this.nativeInput) {\r\n                    this.nativeInput.focus();\r\n                }\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Returns the native `<input>` element used under the hood.\r\n     */\r\n    class_8.prototype.getInputElement = function () {\r\n        return Promise.resolve(this.nativeInput);\r\n    };\r\n    /**\r\n     * Positions the input search icon, placeholder, and the cancel button\r\n     * based on the input value and if it is focused. (ios only)\r\n     */\r\n    class_8.prototype.positionElements = function () {\r\n        var value = this.getValue();\r\n        var prevAlignLeft = this.shouldAlignLeft;\r\n        var mode = getIonMode$1(this);\r\n        var shouldAlignLeft = (!this.animated || value.trim() !== '' || !!this.focused);\r\n        this.shouldAlignLeft = shouldAlignLeft;\r\n        if (mode !== 'ios') {\r\n            return;\r\n        }\r\n        if (prevAlignLeft !== shouldAlignLeft) {\r\n            this.positionPlaceholder();\r\n        }\r\n        if (this.animated) {\r\n            this.positionCancelButton();\r\n        }\r\n    };\r\n    /**\r\n     * Positions the input placeholder\r\n     */\r\n    class_8.prototype.positionPlaceholder = function () {\r\n        var inputEl = this.nativeInput;\r\n        if (!inputEl) {\r\n            return;\r\n        }\r\n        var isRTL = document.dir === 'rtl';\r\n        var iconEl = (this.el.shadowRoot || this.el).querySelector('.searchbar-search-icon');\r\n        if (this.shouldAlignLeft) {\r\n            inputEl.removeAttribute('style');\r\n            iconEl.removeAttribute('style');\r\n        }\r\n        else {\r\n            // Create a dummy span to get the placeholder width\r\n            var doc = document;\r\n            var tempSpan_1 = doc.createElement('span');\r\n            tempSpan_1.innerText = this.placeholder || '';\r\n            doc.body.appendChild(tempSpan_1);\r\n            // Get the width of the span then remove it\r\n            raf(function () {\r\n                var textWidth = tempSpan_1.offsetWidth;\r\n                tempSpan_1.remove();\r\n                // Calculate the input padding\r\n                var inputLeft = 'calc(50% - ' + (textWidth / 2) + 'px)';\r\n                // Calculate the icon margin\r\n                var iconLeft = 'calc(50% - ' + ((textWidth / 2) + 30) + 'px)';\r\n                // Set the input padding start and icon margin start\r\n                if (isRTL) {\r\n                    inputEl.style.paddingRight = inputLeft;\r\n                    iconEl.style.marginRight = iconLeft;\r\n                }\r\n                else {\r\n                    inputEl.style.paddingLeft = inputLeft;\r\n                    iconEl.style.marginLeft = iconLeft;\r\n                }\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     * Show the iOS Cancel button on focus, hide it offscreen otherwise\r\n     */\r\n    class_8.prototype.positionCancelButton = function () {\r\n        var isRTL = document.dir === 'rtl';\r\n        var cancelButton = (this.el.shadowRoot || this.el).querySelector('.searchbar-cancel-button');\r\n        var shouldShowCancel = this.shouldShowCancelButton();\r\n        if (cancelButton && shouldShowCancel !== this.isCancelVisible) {\r\n            var cancelStyle = cancelButton.style;\r\n            this.isCancelVisible = shouldShowCancel;\r\n            if (shouldShowCancel) {\r\n                if (isRTL) {\r\n                    cancelStyle.marginLeft = '0';\r\n                }\r\n                else {\r\n                    cancelStyle.marginRight = '0';\r\n                }\r\n            }\r\n            else {\r\n                var offset = cancelButton.offsetWidth;\r\n                if (offset > 0) {\r\n                    if (isRTL) {\r\n                        cancelStyle.marginLeft = -offset + 'px';\r\n                    }\r\n                    else {\r\n                        cancelStyle.marginRight = -offset + 'px';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    class_8.prototype.getValue = function () {\r\n        return this.value || '';\r\n    };\r\n    class_8.prototype.hasValue = function () {\r\n        return this.getValue() !== '';\r\n    };\r\n    /**\r\n     * Determines whether or not the cancel button should be visible onscreen.\r\n     * Cancel button should be shown if one of two conditions applies:\r\n     * 1. `showCancelButton` is set to `always`.\r\n     * 2. `showCancelButton` is set to `focus`, and the searchbar has been focused.\r\n     */\r\n    class_8.prototype.shouldShowCancelButton = function () {\r\n        if ((this.showCancelButton === 'never') || (this.showCancelButton === 'focus' && !this.focused)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    class_8.prototype.render = function () {\r\n        var _b;\r\n        var _this_1 = this;\r\n        var animated = this.animated && config.getBoolean('animated', true);\r\n        var mode = getIonMode$1(this);\r\n        var clearIcon = this.clearIcon || (mode === 'ios' ? 'close-circle' : 'close-sharp');\r\n        var searchIcon = this.searchIcon || (mode === 'ios' ? 'search-outline' : 'search-sharp');\r\n        var cancelButton = (this.showCancelButton !== 'never') && (h(\"button\", { \"aria-label\": \"cancel\", type: \"button\", tabIndex: mode === 'ios' && !this.shouldShowCancelButton() ? -1 : undefined, onMouseDown: this.onCancelSearchbar, onTouchStart: this.onCancelSearchbar, class: \"searchbar-cancel-button\" }, h(\"div\", null, mode === 'md'\r\n            ? h(\"ion-icon\", { \"aria-hidden\": \"true\", mode: mode, icon: this.cancelButtonIcon, lazy: false })\r\n            : this.cancelButtonText)));\r\n        return (h(Host, { role: \"search\", \"aria-disabled\": this.disabled ? 'true' : null, class: Object.assign(Object.assign({}, createColorClasses$1(this.color)), (_b = {}, _b[mode] = true, _b['searchbar-animated'] = animated, _b['searchbar-disabled'] = this.disabled, _b['searchbar-no-animate'] = animated && this.noAnimate, _b['searchbar-has-value'] = this.hasValue(), _b['searchbar-left-aligned'] = this.shouldAlignLeft, _b['searchbar-has-focus'] = this.focused, _b['searchbar-should-show-cancel'] = this.shouldShowCancelButton(), _b)) }, h(\"div\", { class: \"searchbar-input-container\" }, h(\"input\", { \"aria-label\": \"search text\", disabled: this.disabled, ref: function (el) { return _this_1.nativeInput = el; }, class: \"searchbar-input\", inputMode: this.inputmode, onInput: this.onInput, onBlur: this.onBlur, onFocus: this.onFocus, placeholder: this.placeholder, type: this.type, value: this.getValue(), autoComplete: this.autocomplete, autoCorrect: this.autocorrect, spellCheck: this.spellcheck }), mode === 'md' && cancelButton, h(\"ion-icon\", { mode: mode, icon: searchIcon, lazy: false, class: \"searchbar-search-icon\" }), h(\"button\", { \"aria-label\": \"reset\", type: \"button\", \"no-blur\": true, class: \"searchbar-clear-button\", onMouseDown: this.onClearInput, onTouchStart: this.onClearInput }, h(\"ion-icon\", { \"aria-hidden\": \"true\", mode: mode, icon: clearIcon, lazy: false, class: \"searchbar-clear-icon\" }))), mode === 'ios' && cancelButton));\r\n    };\r\n    Object.defineProperty(class_8.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_8, \"watchers\", {\r\n        get: function () {\r\n            return {\r\n                \"debounce\": [\"debounceChanged\"],\r\n                \"value\": [\"valueChanged\"],\r\n                \"showCancelButton\": [\"showCancelButtonChanged\"]\r\n            };\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(class_8, \"style\", {\r\n        get: function () { return \".sc-ion-searchbar-ios-h{--placeholder-color:initial;--placeholder-font-style:initial;--placeholder-font-weight:initial;--placeholder-opacity:.5;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:-ms-flexbox;display:flex;position:relative;-ms-flex-align:center;align-items:center;width:100%;color:var(--color);font-family:var(--ion-font-family,inherit);-webkit-box-sizing:border-box;box-sizing:border-box}.ion-color.sc-ion-searchbar-ios-h{color:var(--ion-color-contrast)}.ion-color.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{background:var(--ion-color-base)}.ion-color.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios, .ion-color.sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios, .ion-color.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{color:inherit}.searchbar-search-icon.sc-ion-searchbar-ios{color:var(--icon-color);pointer-events:none}.searchbar-input-container.sc-ion-searchbar-ios{display:block;position:relative;-ms-flex-negative:1;flex-shrink:1;width:100%}.searchbar-input.sc-ion-searchbar-ios{font-size:inherit;font-style:inherit;font-weight:inherit;letter-spacing:inherit;text-decoration:inherit;text-indent:inherit;text-overflow:inherit;text-transform:inherit;text-align:inherit;white-space:inherit;color:inherit;display:block;width:100%;border:0;outline:none;background:var(--background);font-family:inherit;-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-input.sc-ion-searchbar-ios::-webkit-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::-moz-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios:-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::-ms-input-placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::placeholder{color:var(--placeholder-color);font-family:inherit;font-style:var(--placeholder-font-style);font-weight:var(--placeholder-font-weight);opacity:var(--placeholder-opacity)}.searchbar-input.sc-ion-searchbar-ios::-ms-clear, .searchbar-input.sc-ion-searchbar-ios::-webkit-search-cancel-button{display:none}.searchbar-cancel-button.sc-ion-searchbar-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:none;height:100%;border:0;outline:none;color:var(--cancel-button-color);cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-cancel-button.sc-ion-searchbar-ios > div.sc-ion-searchbar-ios{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.searchbar-clear-button.sc-ion-searchbar-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:none;min-height:0;outline:none;color:var(--clear-button-color);-webkit-appearance:none;-moz-appearance:none;appearance:none}.searchbar-has-value.searchbar-has-focus.sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios{display:block}.searchbar-disabled.sc-ion-searchbar-ios-h{cursor:default;opacity:.4;pointer-events:none}.sc-ion-searchbar-ios-h{--background:rgba(var(--ion-text-color-rgb,0,0,0),0.07);--box-shadow:none;--cancel-button-color:var(--ion-color-primary,#3880ff);--clear-button-color:var(--ion-color-step-600,#666);--color:var(--ion-text-color,#000);--icon-color:var(--ion-color-step-600,#666);padding-left:12px;padding-right:12px;padding-top:12px;padding-bottom:12px;height:60px;contain:strict}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.sc-ion-searchbar-ios-h{padding-left:unset;padding-right:unset;-webkit-padding-start:12px;padding-inline-start:12px;-webkit-padding-end:12px;padding-inline-end:12px}}.searchbar-input-container.sc-ion-searchbar-ios{height:36px}.searchbar-search-icon.sc-ion-searchbar-ios{margin-left:calc(50% - 60px);left:5px;top:0;position:absolute;width:22px;height:100%;contain:strict}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.searchbar-search-icon.sc-ion-searchbar-ios{margin-left:unset;-webkit-margin-start:calc(50% - 60px);margin-inline-start:calc(50% - 60px)}}[dir=rtl].sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios, [dir=rtl] .sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios, [dir=rtl].sc-ion-searchbar-ios .searchbar-search-icon.sc-ion-searchbar-ios{left:unset;right:unset;right:5px}.searchbar-input.sc-ion-searchbar-ios{padding-left:28px;padding-right:28px;padding-top:0;padding-bottom:0;border-radius:10px;height:100%;font-size:17px;font-weight:400;contain:strict}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.searchbar-input.sc-ion-searchbar-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:28px;padding-inline-start:28px;-webkit-padding-end:28px;padding-inline-end:28px}}.searchbar-clear-button.sc-ion-searchbar-ios{right:0;top:0;background-position:50%;position:absolute;width:30px;height:100%;border:0;background-color:transparent}[dir=rtl].sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios, [dir=rtl] .sc-ion-searchbar-ios-h .searchbar-clear-button.sc-ion-searchbar-ios, [dir=rtl].sc-ion-searchbar-ios .searchbar-clear-button.sc-ion-searchbar-ios{left:unset;right:unset;left:0}.searchbar-clear-icon.sc-ion-searchbar-ios{width:18px;height:100%}.searchbar-cancel-button.sc-ion-searchbar-ios{padding-left:8px;padding-right:0;padding-top:0;padding-bottom:0;-ms-flex-negative:0;flex-shrink:0;background-color:transparent;font-size:16px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.searchbar-cancel-button.sc-ion-searchbar-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:0;padding-inline-end:0}}.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{margin-left:0}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{margin-left:unset;-webkit-margin-start:0;margin-inline-start:0}}.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{padding-left:30px}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.searchbar-left-aligned.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios{padding-left:unset;-webkit-padding-start:30px;padding-inline-start:30px}}.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios, .searchbar-has-focus.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios, .searchbar-should-show-cancel.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{display:block}.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios, .searchbar-animated.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{-webkit-transition:all .3s ease;transition:all .3s ease}.searchbar-animated.searchbar-has-focus.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios, .searchbar-animated.searchbar-should-show-cancel.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{opacity:1;pointer-events:auto}.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{margin-right:-100%;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-transition:all .3s ease;transition:all .3s ease;opacity:0;pointer-events:none}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.searchbar-animated.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{margin-right:unset;-webkit-margin-end:-100%;margin-inline-end:-100%}}.searchbar-no-animate.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios, .searchbar-no-animate.sc-ion-searchbar-ios-h .searchbar-input.sc-ion-searchbar-ios, .searchbar-no-animate.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{-webkit-transition-duration:0ms;transition-duration:0ms}.ion-color.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios{color:var(--ion-color-base)}\\@media (any-hover:hover){.ion-color.sc-ion-searchbar-ios-h .searchbar-cancel-button.sc-ion-searchbar-ios:hover{color:var(--ion-color-tint)}}ion-toolbar.sc-ion-searchbar-ios-h, ion-toolbar .sc-ion-searchbar-ios-h{padding-top:1px;padding-bottom:15px;height:52px}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color), ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color){color:inherit}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-cancel-button.sc-ion-searchbar-ios, ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-cancel-button.sc-ion-searchbar-ios{color:currentColor}ion-toolbar.ion-color.sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios, ion-toolbar.ion-color .sc-ion-searchbar-ios-h .searchbar-search-icon.sc-ion-searchbar-ios{color:currentColor;opacity:.5}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-input.sc-ion-searchbar-ios, ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-input.sc-ion-searchbar-ios{background:rgba(var(--ion-color-contrast-rgb),.07);color:currentColor}ion-toolbar.ion-color.sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-clear-button.sc-ion-searchbar-ios, ion-toolbar.ion-color .sc-ion-searchbar-ios-h:not(.ion-color) .searchbar-clear-button.sc-ion-searchbar-ios{color:currentColor;opacity:.5}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return class_8;\r\n}());\r\nvar Spinner = /** @class */ (function () {\r\n    function Spinner(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        /**\r\n         * If `true`, the spinner's animation will be paused.\r\n         */\r\n        this.paused = false;\r\n    }\r\n    Spinner.prototype.getName = function () {\r\n        var spinnerName = this.name || config.get('spinner');\r\n        var mode = getIonMode$1(this);\r\n        if (spinnerName) {\r\n            return spinnerName;\r\n        }\r\n        return (mode === 'ios') ? 'lines' : 'circular';\r\n    };\r\n    Spinner.prototype.render = function () {\r\n        var _b;\r\n        var self = this;\r\n        var mode = getIonMode$1(self);\r\n        var spinnerName = self.getName();\r\n        var spinner = SPINNERS[spinnerName] || SPINNERS['lines'];\r\n        var duration = (typeof self.duration === 'number' && self.duration > 10 ? self.duration : spinner.dur);\r\n        var svgs = [];\r\n        if (spinner.circles !== undefined) {\r\n            for (var i = 0; i < spinner.circles; i++) {\r\n                svgs.push(buildCircle(spinner, duration, i, spinner.circles));\r\n            }\r\n        }\r\n        else if (spinner.lines !== undefined) {\r\n            for (var i = 0; i < spinner.lines; i++) {\r\n                svgs.push(buildLine(spinner, duration, i, spinner.lines));\r\n            }\r\n        }\r\n        return (h(Host, { class: Object.assign(Object.assign({}, createColorClasses$1(self.color)), (_b = {}, _b[mode] = true, _b[\"spinner-\" + spinnerName] = true, _b['spinner-paused'] = !!self.paused || config.getBoolean('_testing'), _b)), role: \"progressbar\", style: spinner.elmDuration ? { animationDuration: duration + 'ms' } : {} }, svgs));\r\n    };\r\n    Object.defineProperty(Spinner, \"style\", {\r\n        get: function () { return \":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{left:0;top:0;-webkit-transform-origin:center;transform-origin:center;position:absolute;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}:host-context([dir=rtl]) svg,[dir=rtl] svg{left:unset;right:unset;right:0;-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:4px;stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular){-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px,200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) circle,:host(.spinner-paused) svg{-webkit-animation-play-state:paused;animation-play-state:paused}\\@-webkit-keyframes spinner-fade-out{0%{opacity:1}to{opacity:0}}\\@keyframes spinner-fade-out{0%{opacity:1}to{opacity:0}}\\@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:scale(0);transform:scale(0)}}\\@keyframes spinner-scale-out{0%{-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:scale(0);transform:scale(0)}}\\@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}\\@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}\\@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1);transform:scale(1);opacity:.9}50%{-webkit-transform:scale(.4);transform:scale(.4);opacity:.3}to{-webkit-transform:scale(1);transform:scale(1);opacity:.9}}\\@keyframes spinner-dots{0%{-webkit-transform:scale(1);transform:scale(1);opacity:.9}50%{-webkit-transform:scale(.4);transform:scale(.4);opacity:.3}to{-webkit-transform:scale(1);transform:scale(1);opacity:.9}}\\@-webkit-keyframes spinner-circular{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}\\@keyframes spinner-circular{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}\\@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px,200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px,200px;stroke-dashoffset:-15px}to{stroke-dasharray:100px,200px;stroke-dashoffset:-125px}}\\@keyframes spinner-circular-inner{0%{stroke-dasharray:1px,200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px,200px;stroke-dashoffset:-15px}to{stroke-dasharray:100px,200px;stroke-dashoffset:-125px}}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Spinner;\r\n}());\r\nvar buildCircle = function (spinner, duration, index, total) {\r\n    var data = spinner.fn(duration, index, total);\r\n    data.style['animation-duration'] = duration + 'ms';\r\n    return (h(\"svg\", { viewBox: data.viewBox || '0 0 64 64', style: data.style }, h(\"circle\", { transform: data.transform || 'translate(32,32)', cx: data.cx, cy: data.cy, r: data.r, style: spinner.elmDuration ? { animationDuration: duration + 'ms' } : {} })));\r\n};\r\nvar buildLine = function (spinner, duration, index, total) {\r\n    var data = spinner.fn(duration, index, total);\r\n    data.style['animation-duration'] = duration + 'ms';\r\n    return (h(\"svg\", { viewBox: data.viewBox || '0 0 64 64', style: data.style }, h(\"line\", { transform: \"translate(32,32)\", y1: data.y1, y2: data.y2 })));\r\n};\r\nvar Toolbar = /** @class */ (function () {\r\n    function Toolbar(hostRef) {\r\n        registerInstance(this, hostRef);\r\n        this.childrenStyles = new Map();\r\n    }\r\n    Toolbar.prototype.componentWillLoad = function () {\r\n        var buttons = Array.from(this.el.querySelectorAll('ion-buttons'));\r\n        var firstButtons = buttons.find(function (button) {\r\n            return button.slot === 'start';\r\n        });\r\n        if (firstButtons) {\r\n            firstButtons.classList.add('buttons-first-slot');\r\n        }\r\n        var buttonsReversed = buttons.reverse();\r\n        var lastButtons = buttonsReversed.find(function (button) { return button.slot === 'end'; }) ||\r\n            buttonsReversed.find(function (button) { return button.slot === 'primary'; }) ||\r\n            buttonsReversed.find(function (button) { return button.slot === 'secondary'; });\r\n        if (lastButtons) {\r\n            lastButtons.classList.add('buttons-last-slot');\r\n        }\r\n    };\r\n    Toolbar.prototype.childrenStyle = function (ev) {\r\n        ev.stopPropagation();\r\n        var tagName = ev.target.tagName;\r\n        var updatedStyles = ev.detail;\r\n        var newStyles = {};\r\n        var childStyles = this.childrenStyles.get(tagName) || {};\r\n        var hasStyleChange = false;\r\n        Object.keys(updatedStyles).forEach(function (key) {\r\n            var childKey = \"toolbar-\" + key;\r\n            var newValue = updatedStyles[key];\r\n            if (newValue !== childStyles[childKey]) {\r\n                hasStyleChange = true;\r\n            }\r\n            if (newValue) {\r\n                newStyles[childKey] = true;\r\n            }\r\n        });\r\n        if (hasStyleChange) {\r\n            this.childrenStyles.set(tagName, newStyles);\r\n            this.el.forceUpdate();\r\n        }\r\n    };\r\n    Toolbar.prototype.render = function () {\r\n        var _b;\r\n        var mode = getIonMode$1(this);\r\n        var childStyles = {};\r\n        this.childrenStyles.forEach(function (value) {\r\n            Object.assign(childStyles, value);\r\n        });\r\n        return (h(Host, { class: Object.assign(Object.assign((_b = { 'in-toolbar': hostContext('ion-toolbar', this.el) }, _b[mode] = true, _b), childStyles), createColorClasses$1(this.color)) }, h(\"div\", { class: \"toolbar-background\" }), h(\"div\", { class: \"toolbar-container\" }, h(\"slot\", { name: \"start\" }), h(\"slot\", { name: \"secondary\" }), h(\"div\", { class: \"toolbar-content\" }, h(\"slot\", null)), h(\"slot\", { name: \"primary\" }), h(\"slot\", { name: \"end\" }))));\r\n    };\r\n    Object.defineProperty(Toolbar.prototype, \"el\", {\r\n        get: function () { return getElement(this); },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Toolbar, \"style\", {\r\n        get: function () { return \":host{--border-width:0;--border-style:solid;--opacity:1;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;padding-left:var(--ion-safe-area-left);padding-right:var(--ion-safe-area-right);display:block;position:relative;width:100%;color:var(--color);font-family:var(--ion-font-family,inherit);contain:content;z-index:10;-webkit-box-sizing:border-box;box-sizing:border-box}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){:host{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-safe-area-left);padding-inline-start:var(--ion-safe-area-left);-webkit-padding-end:var(--ion-safe-area-right);padding-inline-end:var(--ion-safe-area-right)}}:host(.ion-color){color:var(--ion-color-contrast)}:host(.ion-color) .toolbar-background{background:var(--ion-color-base)}.toolbar-container{padding-left:var(--padding-start);padding-right:var(--padding-end);padding-top:var(--padding-top);padding-bottom:var(--padding-bottom);display:-ms-flexbox;display:flex;position:relative;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;width:100%;min-height:var(--min-height);contain:content;overflow:hidden;z-index:10;-webkit-box-sizing:border-box;box-sizing:border-box}\\@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.toolbar-container{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--padding-start);padding-inline-start:var(--padding-start);-webkit-padding-end:var(--padding-end);padding-inline-end:var(--padding-end)}}.toolbar-background{top:0;-webkit-transform:translateZ(0);transform:translateZ(0);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;opacity:var(--opacity);z-index:-1;pointer-events:none}.toolbar-background,::slotted(ion-progress-bar){left:0;right:0;bottom:0;position:absolute}:host{--background:var(--ion-toolbar-background,var(--ion-color-step-50,#fff));--color:var(--ion-toolbar-color,var(--ion-text-color,#000));--border-color:var(--ion-toolbar-border-color,var(--ion-border-color,var(--ion-color-step-150,rgba(0,0,0,0.2))));--padding-top:3px;--padding-bottom:3px;--padding-start:4px;--padding-end:4px;--min-height:44px}.toolbar-content{-ms-flex:1;flex:1;-ms-flex-order:4;order:4;min-width:0}:host(.toolbar-segment) .toolbar-content{display:-ms-inline-flexbox;display:inline-flex}:host(.toolbar-searchbar) .toolbar-container{padding-top:0;padding-bottom:0}:host(.toolbar-searchbar) ::slotted(*){-ms-flex-item-align:start;align-self:start}:host(.toolbar-searchbar) ::slotted(ion-chip){margin-top:3px}:host(.toolbar-searchbar) ::slotted(ion-back-button){height:38px}::slotted(ion-buttons){min-height:38px}::slotted([slot=start]){-ms-flex-order:2;order:2}::slotted([slot=secondary]){-ms-flex-order:3;order:3}::slotted([slot=primary]){-ms-flex-order:5;order:5;text-align:end}::slotted([slot=end]){-ms-flex-order:6;order:6;text-align:end}:host(.toolbar-title-large) .toolbar-container{-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-align:start;align-items:flex-start}:host(.toolbar-title-large) .toolbar-content ion-title{-ms-flex:1;flex:1;-ms-flex-order:8;order:8;min-width:100%}\"; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return Toolbar;\r\n}());\r\nexport { IIIFExplorer as iiif_explorer, IIIFExplorerBreadcrumb as iiif_explorer_breadcrumb, IIIFExplorerItem as iiif_explorer_item, Button as ion_button, Content as ion_content, Footer as ion_footer, Header as ion_header, Icon as ion_icon, InfiniteScroll as ion_infinite_scroll, InfiniteScrollContent as ion_infinite_scroll_content, Item as ion_item, Label as ion_label, List as ion_list, RippleEffect as ion_ripple_effect, Searchbar as ion_searchbar, Spinner as ion_spinner, Toolbar as ion_toolbar };\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar hostContext = function (selector, el) {\r\n    return el.closest(selector) !== null;\r\n};\r\n/**\r\n * Create the mode and color classes for the component based on the classes passed in\r\n */\r\nvar createColorClasses = function (color) {\r\n    var _a;\r\n    return (typeof color === 'string' && color.length > 0) ? (_a = {\r\n            'ion-color': true\r\n        },\r\n        _a[\"ion-color-\" + color] = true,\r\n        _a) : undefined;\r\n};\r\nvar getClassList = function (classes) {\r\n    if (classes !== undefined) {\r\n        var array = Array.isArray(classes) ? classes : classes.split(' ');\r\n        return array\r\n            .filter(function (c) { return c != null; })\r\n            .map(function (c) { return c.trim(); })\r\n            .filter(function (c) { return c !== ''; });\r\n    }\r\n    return [];\r\n};\r\nvar getClassMap = function (classes) {\r\n    var map = {};\r\n    getClassList(classes).forEach(function (c) { return map[c] = true; });\r\n    return map;\r\n};\r\nvar SCHEME = /^[a-z][a-z0-9+\\-.]*:/;\r\nvar openURL = function (url, ev, direction) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var router;\r\n    return __generator(this, function (_a) {\r\n        if (url != null && url[0] !== '#' && !SCHEME.test(url)) {\r\n            router = document.querySelector('ion-router');\r\n            if (router) {\r\n                if (ev != null) {\r\n                    ev.preventDefault();\r\n                }\r\n                return [2 /*return*/, router.push(url, direction)];\r\n            }\r\n        }\r\n        return [2 /*return*/, false];\r\n    });\r\n}); };\r\nexport { createColorClasses as c, getClassMap as g, hostContext as h, openURL as o };\r\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n/**\r\n * Patched version of requestAnimationFrame that avoids ngzone\r\n * Use only when you know ngzone should not run\r\n */\r\nvar raf = function (h) {\r\n    if (typeof __zone_symbol__requestAnimationFrame === 'function') {\r\n        return __zone_symbol__requestAnimationFrame(h);\r\n    }\r\n    if (typeof requestAnimationFrame === 'function') {\r\n        return requestAnimationFrame(h);\r\n    }\r\n    return setTimeout(h);\r\n};\r\nvar hasShadowDom = function (el) {\r\n    return !!el.shadowRoot && !!el.attachShadow;\r\n};\r\nvar findItemLabel = function (componentEl) {\r\n    var itemEl = componentEl.closest('ion-item');\r\n    if (itemEl) {\r\n        return itemEl.querySelector('ion-label');\r\n    }\r\n    return null;\r\n};\r\nvar renderHiddenInput = function (always, container, name, value, disabled) {\r\n    if (always || hasShadowDom(container)) {\r\n        var input = container.querySelector('input.aux-input');\r\n        if (!input) {\r\n            input = container.ownerDocument.createElement('input');\r\n            input.type = 'hidden';\r\n            input.classList.add('aux-input');\r\n            container.appendChild(input);\r\n        }\r\n        input.disabled = disabled;\r\n        input.name = name;\r\n        input.value = value || '';\r\n    }\r\n};\r\nvar clamp = function (min, n, max) {\r\n    return Math.max(min, Math.min(n, max));\r\n};\r\nvar assert = function (actual, reason) {\r\n    if (!actual) {\r\n        var message = 'ASSERT: ' + reason;\r\n        console.error(message);\r\n        debugger; // tslint:disable-line\r\n        throw new Error(message);\r\n    }\r\n};\r\nvar now = function (ev) {\r\n    return ev.timeStamp || Date.now();\r\n};\r\nvar pointerCoord = function (ev) {\r\n    // get X coordinates for either a mouse click\r\n    // or a touch depending on the given event\r\n    if (ev) {\r\n        var changedTouches = ev.changedTouches;\r\n        if (changedTouches && changedTouches.length > 0) {\r\n            var touch = changedTouches[0];\r\n            return { x: touch.clientX, y: touch.clientY };\r\n        }\r\n        if (ev.pageX !== undefined) {\r\n            return { x: ev.pageX, y: ev.pageY };\r\n        }\r\n    }\r\n    return { x: 0, y: 0 };\r\n};\r\n/**\r\n * @hidden\r\n * Given a side, return if it should be on the end\r\n * based on the value of dir\r\n * @param side the side\r\n * @param isRTL whether the application dir is rtl\r\n */\r\nvar isEndSide = function (side) {\r\n    var isRTL = document.dir === 'rtl';\r\n    switch (side) {\r\n        case 'start': return isRTL;\r\n        case 'end': return !isRTL;\r\n        default:\r\n            throw new Error(\"\\\"\" + side + \"\\\" is not a valid value for [side]. Use \\\"start\\\" or \\\"end\\\" instead.\");\r\n    }\r\n};\r\nvar debounceEvent = function (event, wait) {\r\n    var original = event._original || event;\r\n    return {\r\n        _original: event,\r\n        emit: debounce(original.emit.bind(original), wait)\r\n    };\r\n};\r\nvar debounce = function (func, wait) {\r\n    if (wait === void 0) { wait = 0; }\r\n    var timer;\r\n    return function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        clearTimeout(timer);\r\n        timer = setTimeout.apply(void 0, __spreadArrays([func, wait], args));\r\n    };\r\n};\r\nexport { renderHiddenInput as a, assert as b, clamp as c, debounceEvent as d, debounce as e, findItemLabel as f, hasShadowDom as h, isEndSide as i, now as n, pointerCoord as p, raf as r };\r\n","/**\r\n * Does a simple sanitization of all elements\r\n * in an untrusted string\r\n */\r\nvar sanitizeDOMString = function (untrustedString) {\r\n    try {\r\n        if (typeof untrustedString !== 'string' || untrustedString === '') {\r\n            return untrustedString;\r\n        }\r\n        /**\r\n         * Create a document fragment\r\n         * separate from the main DOM,\r\n         * create a div to do our work in\r\n         */\r\n        var documentFragment_1 = document.createDocumentFragment();\r\n        var workingDiv = document.createElement('div');\r\n        documentFragment_1.appendChild(workingDiv);\r\n        workingDiv.innerHTML = untrustedString;\r\n        /**\r\n         * Remove any elements\r\n         * that are blocked\r\n         */\r\n        blockedTags.forEach(function (blockedTag) {\r\n            var getElementsToRemove = documentFragment_1.querySelectorAll(blockedTag);\r\n            for (var elementIndex = getElementsToRemove.length - 1; elementIndex >= 0; elementIndex--) {\r\n                var element = getElementsToRemove[elementIndex];\r\n                if (element.parentNode) {\r\n                    element.parentNode.removeChild(element);\r\n                }\r\n                else {\r\n                    documentFragment_1.removeChild(element);\r\n                }\r\n                /**\r\n                 * We still need to sanitize\r\n                 * the children of this element\r\n                 * as they are left behind\r\n                 */\r\n                var childElements = getElementChildren(element);\r\n                /* tslint:disable-next-line */\r\n                for (var childIndex = 0; childIndex < childElements.length; childIndex++) {\r\n                    sanitizeElement(childElements[childIndex]);\r\n                }\r\n            }\r\n        });\r\n        /**\r\n         * Go through remaining elements and remove\r\n         * non-allowed attribs\r\n         */\r\n        // IE does not support .children on document fragments, only .childNodes\r\n        var dfChildren = getElementChildren(documentFragment_1);\r\n        /* tslint:disable-next-line */\r\n        for (var childIndex = 0; childIndex < dfChildren.length; childIndex++) {\r\n            sanitizeElement(dfChildren[childIndex]);\r\n        }\r\n        // Append document fragment to div\r\n        var fragmentDiv = document.createElement('div');\r\n        fragmentDiv.appendChild(documentFragment_1);\r\n        // First child is always the div we did our work in\r\n        var getInnerDiv = fragmentDiv.querySelector('div');\r\n        return (getInnerDiv !== null) ? getInnerDiv.innerHTML : fragmentDiv.innerHTML;\r\n    }\r\n    catch (err) {\r\n        console.error(err);\r\n        return '';\r\n    }\r\n};\r\n/**\r\n * Clean up current element based on allowed attributes\r\n * and then recursively dig down into any child elements to\r\n * clean those up as well\r\n */\r\nvar sanitizeElement = function (element) {\r\n    // IE uses childNodes, so ignore nodes that are not elements\r\n    if (element.nodeType && element.nodeType !== 1) {\r\n        return;\r\n    }\r\n    for (var i = element.attributes.length - 1; i >= 0; i--) {\r\n        var attribute = element.attributes.item(i);\r\n        var attributeName = attribute.name;\r\n        // remove non-allowed attribs\r\n        if (!allowedAttributes.includes(attributeName.toLowerCase())) {\r\n            element.removeAttribute(attributeName);\r\n            continue;\r\n        }\r\n        // clean up any allowed attribs\r\n        // that attempt to do any JS funny-business\r\n        var attributeValue = attribute.value;\r\n        /* tslint:disable-next-line */\r\n        if (attributeValue != null && attributeValue.toLowerCase().includes('javascript:')) {\r\n            element.removeAttribute(attributeName);\r\n        }\r\n    }\r\n    /**\r\n     * Sanitize any nested children\r\n     */\r\n    var childElements = getElementChildren(element);\r\n    /* tslint:disable-next-line */\r\n    for (var i = 0; i < childElements.length; i++) {\r\n        sanitizeElement(childElements[i]);\r\n    }\r\n};\r\n/**\r\n * IE doesn't always support .children\r\n * so we revert to .childNodes instead\r\n */\r\nvar getElementChildren = function (el) {\r\n    return (el.children != null) ? el.children : el.childNodes;\r\n};\r\nvar allowedAttributes = ['class', 'id', 'href', 'src', 'name', 'slot'];\r\nvar blockedTags = ['script', 'style', 'iframe', 'meta', 'link', 'object', 'embed'];\r\nexport { sanitizeDOMString as s };\r\n","var spinners = {\r\n    'bubbles': {\r\n        dur: 1000,\r\n        circles: 9,\r\n        fn: function (dur, index, total) {\r\n            var animationDelay = (dur * index / total) - dur + \"ms\";\r\n            var angle = 2 * Math.PI * index / total;\r\n            return {\r\n                r: 5,\r\n                style: {\r\n                    'top': 9 * Math.sin(angle) + \"px\",\r\n                    'left': 9 * Math.cos(angle) + \"px\",\r\n                    'animation-delay': animationDelay,\r\n                }\r\n            };\r\n        }\r\n    },\r\n    'circles': {\r\n        dur: 1000,\r\n        circles: 8,\r\n        fn: function (dur, index, total) {\r\n            var step = index / total;\r\n            var animationDelay = (dur * step) - dur + \"ms\";\r\n            var angle = 2 * Math.PI * step;\r\n            return {\r\n                r: 5,\r\n                style: {\r\n                    'top': 9 * Math.sin(angle) + \"px\",\r\n                    'left': 9 * Math.cos(angle) + \"px\",\r\n                    'animation-delay': animationDelay,\r\n                }\r\n            };\r\n        }\r\n    },\r\n    'circular': {\r\n        dur: 1400,\r\n        elmDuration: true,\r\n        circles: 1,\r\n        fn: function () {\r\n            return {\r\n                r: 20,\r\n                cx: 48,\r\n                cy: 48,\r\n                fill: 'none',\r\n                viewBox: '24 24 48 48',\r\n                transform: 'translate(0,0)',\r\n                style: {}\r\n            };\r\n        }\r\n    },\r\n    'crescent': {\r\n        dur: 750,\r\n        circles: 1,\r\n        fn: function () {\r\n            return {\r\n                r: 26,\r\n                style: {}\r\n            };\r\n        }\r\n    },\r\n    'dots': {\r\n        dur: 750,\r\n        circles: 3,\r\n        fn: function (_, index) {\r\n            var animationDelay = -(110 * index) + 'ms';\r\n            return {\r\n                r: 6,\r\n                style: {\r\n                    'left': 9 - (9 * index) + \"px\",\r\n                    'animation-delay': animationDelay,\r\n                }\r\n            };\r\n        }\r\n    },\r\n    'lines': {\r\n        dur: 1000,\r\n        lines: 12,\r\n        fn: function (dur, index, total) {\r\n            var transform = \"rotate(\" + (30 * index + (index < 6 ? 180 : -180)) + \"deg)\";\r\n            var animationDelay = (dur * index / total) - dur + \"ms\";\r\n            return {\r\n                y1: 17,\r\n                y2: 29,\r\n                style: {\r\n                    'transform': transform,\r\n                    'animation-delay': animationDelay,\r\n                }\r\n            };\r\n        }\r\n    },\r\n    'lines-small': {\r\n        dur: 1000,\r\n        lines: 12,\r\n        fn: function (dur, index, total) {\r\n            var transform = \"rotate(\" + (30 * index + (index < 6 ? 180 : -180)) + \"deg)\";\r\n            var animationDelay = (dur * index / total) - dur + \"ms\";\r\n            return {\r\n                y1: 12,\r\n                y2: 20,\r\n                style: {\r\n                    'transform': transform,\r\n                    'animation-delay': animationDelay,\r\n                }\r\n            };\r\n        }\r\n    }\r\n};\r\nvar SPINNERS = spinners;\r\nexport { SPINNERS as S };\r\n"],"sourceRoot":""}